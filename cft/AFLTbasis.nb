(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    364190,      10677]
NotebookOptionsPosition[    350493,      10240]
NotebookOutlinePosition[    351113,      10264]
CellTagsIndexPosition[    351006,      10259]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Stuff from AFLT paper: 1012.1312", "Title",
 CellChangeTimes->{{3.527953729323724*^9, 3.5279537534219933`*^9}}],

Cell[CellGroupData[{

Cell["redundant if libraries are loaded", "Subsection",
 CellChangeTimes->{{3.5279550436558027`*^9, 3.5279550539738703`*^9}, {
  3.528037521470821*^9, 3.528037531591172*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"transposePartition", "[", "part_", "]"}], ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", "\t", 
       RowBox[{"xp", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"Tally", "[", 
          RowBox[{"Append", "[", 
           RowBox[{"part", ",", "0"}], "]"}], "]"}], "]"}]}], "\n", "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Join", "@@", 
        RowBox[{"(", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"ConstantArray", "@@", "#"}], "&"}], "/@", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{
             RowBox[{"Accumulate", "[", 
              RowBox[{"Most", "[", 
               RowBox[{"xp", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"-", 
              RowBox[{"Differences", "[", 
               RowBox[{"xp", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], "\n", "\t\t", 
            "}"}], "]"}]}], "\n", ")"}]}], "]"}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"IntegerCompositions", "[", "r_Integer", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Flatten", "[", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Permutations", "[", "#", "]"}], "]"}], "&"}], "/@", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"IntegerPartitions", "[", "r", "]"}]}], ",", 
     "\[IndentingNewLine]", "1"}], "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.520851204278124*^9, 3.5208512358965197`*^9}, {
  3.6589411465652437`*^9, 3.658941177360208*^9}, {3.659221753650855*^9, 
  3.659221758790902*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"vc", "[", "a0_", "]"}], ":=", " ", 
   RowBox[{"1", "-", 
    RowBox[{"24", 
     RowBox[{"a0", "^", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vh", "[", 
    RowBox[{"a_", ",", "a0_"}], "]"}], ":=", " ", 
   RowBox[{"a", 
    RowBox[{"(", 
     RowBox[{"a", "-", 
      RowBox[{"2", "a0"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"aplus", "[", "a0_", "]"}], ":=", " ", 
   RowBox[{"a0", "+", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"a0", "^", "2"}], "+", "1"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"aminus", "[", "a0_", "]"}], ":=", " ", 
   RowBox[{"a0", "-", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"a0", "^", "2"}], "+", "1"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ars", "[", 
    RowBox[{"r_", ",", "s_", ",", "a0_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "r"}], ")"}], 
     RowBox[{
      RowBox[{"aplus", "[", "a0", "]"}], "/", "2"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "s"}], ")"}], 
     RowBox[{
      RowBox[{"aminus", "[", "a0", "]"}], "/", "2"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hrs", "[", 
    RowBox[{"r_", ",", "s_", ",", "a0_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"r", "*", 
         RowBox[{"aplus", "[", "a0", "]"}]}], "+", 
        RowBox[{"s", "*", 
         RowBox[{"aminus", "[", "a0", "]"}]}]}], ")"}], "^", "2"}], "/", 
     "4"}], "-", 
    RowBox[{"a0", "^", "2"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.515457414341902*^9, 3.515457444598402*^9}, {
   3.515457479612062*^9, 3.515457650963278*^9}, 3.515458237503537*^9, {
   3.658941183991819*^9, 3.65894120217626*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"\[CapitalDelta]", "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"Q", "^", "2"}], "/", "4"}], "-", 
     RowBox[{"P", "^", "2"}]}]}], ",", "P"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"\[CapitalDelta]", "\[Equal]", 
    RowBox[{"\[Alpha]", 
     RowBox[{"(", 
      RowBox[{"Q", "-", "\[Alpha]"}], ")"}]}]}], ",", "\[Alpha]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.659040830911024*^9, 3.659040867498496*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"P", "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["Q", "2"], "-", 
        RowBox[{"4", " ", "\[CapitalDelta]"}]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"P", "\[Rule]", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["Q", "2"], "-", 
        RowBox[{"4", " ", "\[CapitalDelta]"}]}]]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.659040844120613*^9, 3.659040868095847*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Alpha]", "\[Rule]", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"Q", "-", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["Q", "2"], "-", 
          RowBox[{"4", " ", "\[CapitalDelta]"}]}]]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", "\[Rule]", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"Q", "+", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["Q", "2"], "-", 
          RowBox[{"4", " ", "\[CapitalDelta]"}]}]]}], ")"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.659040844120613*^9, 3.659040868102192*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"bIsing", "=", " ", 
   RowBox[{"2", 
    RowBox[{"I", "/", 
     RowBox[{"Sqrt", "[", "3", "]"}]}]}]}], ";"}]], "Code",
 CellChangeTimes->{{3.659283546596611*^9, 3.659283551793338*^9}}],

Cell["From AFLT:", "Text",
 CellChangeTimes->{{3.659223655025198*^9, 3.659223657870772*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalDelta]toP", "[", 
    RowBox[{"\[CapitalDelta]_", ",", "b_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", "2"}], ")"}], 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "+", 
         RowBox[{"1", "/", "b"}]}], ")"}], "^", "2"}], "-", 
      RowBox[{"4", "\[CapitalDelta]"}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalDelta]to\[Alpha]", "[", 
     RowBox[{"\[CapitalDelta]_", ",", "b_"}], "]"}], ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Q", "=", 
        RowBox[{"b", "+", 
         RowBox[{"1", "/", "b"}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"Q", "+", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"Q", "^", "2"}], "-", 
           RowBox[{"4", "\[CapitalDelta]"}]}], "]"}]}], ")"}]}]}], "]"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]toP", "[", 
    RowBox[{"\[Alpha]_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"\[Alpha]", "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"b", "+", 
       RowBox[{"1", "/", "b"}]}], ")"}], "/", "2"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]rs", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r_", ",", "s_"}], "}"}], ",", "b_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "r"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"b", "/", "2"}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "s"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"2", "b"}], ")"}]}]}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.65904425025259*^9, 3.659044286716008*^9}, {
  3.659044375066984*^9, 3.659044411224535*^9}, {3.659278209162916*^9, 
  3.65927822814077*^9}, {3.659281042300844*^9, 3.659281045459832*^9}, {
  3.659281199743731*^9, 3.6592812400853786`*^9}, {3.659281466458469*^9, 
  3.6592814666832457`*^9}}],

Cell["From S&T paper:", "Text",
 CellChangeTimes->{{3.659223648253788*^9, 3.659223651807646*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalDelta]sto\[Delta]s", "[", 
    RowBox[{"\[CapitalDelta]s_", ",", "\[CapitalDelta]ints_"}], "]"}], ":=", 
   "\n", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t", 
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"Length", "[", "\[CapitalDelta]s", "]"}]}], "\n", "}"}], ",", 
     "\n", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t", 
        RowBox[{
         RowBox[{"\[CapitalDelta]ints", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", 
         RowBox[{"\[CapitalDelta]s", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", 
         RowBox[{"\[CapitalDelta]s", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "\n", "}"}], ",", "\n", 
       RowBox[{"MapThread", "[", "\n", "\t", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#1", "-", "#2", "-", "#3"}], "&"}], ")"}], ",", "\n", 
         "\t", 
         RowBox[{"{", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Drop", "[", 
            RowBox[{"\[CapitalDelta]ints", ",", " ", "2"}], "]"}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"Drop", "[", 
            RowBox[{
             RowBox[{"Drop", "[", 
              RowBox[{"\[CapitalDelta]ints", ",", 
               RowBox[{"-", "1"}]}], "]"}], ",", "1"}], "]"}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"Drop", "[", 
            RowBox[{
             RowBox[{"Drop", "[", 
              RowBox[{"\[CapitalDelta]s", ",", "3"}], "]"}], ",", 
             RowBox[{"-", "2"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
        "]"}], ",", "\t", "\n", 
       RowBox[{"{", "\n", "\t", 
        RowBox[{
         RowBox[{"\[CapitalDelta]s", "[", 
          RowBox[{"[", "n", "]"}], "]"}], "-", 
         RowBox[{"\[CapitalDelta]s", "[", 
          RowBox[{"[", 
           RowBox[{"n", "-", "1"}], "]"}], "]"}], "-", 
         RowBox[{"\[CapitalDelta]ints", "[", 
          RowBox[{"[", 
           RowBox[{"n", "-", "3"}], "]"}], "]"}]}], "\n", "}"}]}], "]"}]}], 
    "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.65922366092041*^9, 3.6592237322230053`*^9}, {
  3.659223790610653*^9, 3.6592239084661007`*^9}, {3.659224351303711*^9, 
  3.659224396818554*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Zamolodchikov 4-pt. recursions", "Section",
 CellChangeTimes->{{3.558111273352209*^9, 3.55811128870317*^9}, 
   3.558113465253995*^9, {3.558116241064755*^9, 3.558116243515973*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"vir\[Alpha]", "[", "c_", "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "}"}], ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "c"}], ")"}], "/", "24"}], "]"}], ",", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"25", "-", "c"}], ")"}], "/", "24"}], "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalDelta]Kac", "[", 
    RowBox[{"c_", ",", "mn_List"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"c", "-", "1"}], ")"}], "/", "24"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vir\[Alpha]", "[", "c", "]"}], ".", "mn"}], ")"}], "/", 
       "2"}], ")"}], "^", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]Kac", "[", 
    RowBox[{"c_", ",", "mn_List"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"vir\[Alpha]", "[", "c", "]"}], ".", "mn"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cKac", "[", 
    RowBox[{"\[CapitalDelta]_", ",", 
     RowBox[{"{", 
      RowBox[{"m_", ",", "n_"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{"t", ",", 
      RowBox[{"13", "-", 
       RowBox[{"6", 
        RowBox[{"(", 
         RowBox[{"t", "+", 
          RowBox[{"1", "/", "t"}]}], ")"}]}]}]}], "]"}], "[", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "\[CapitalDelta]"}], "+", 
         RowBox[{"m", "*", "n"}], "-", "1"}], ")"}], "+", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "\[CapitalDelta]"}], "+", 
            RowBox[{"m", "*", "n"}], "-", "1"}], ")"}], "^", "2"}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"m", "^", "2"}], "-", "1"}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"n", "^", "2"}], "-", "1"}], ")"}]}]}], "]"}]}], ")"}], 
     "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", "^", "2"}], "-", "1"}], ")"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5581132756655912`*^9, 3.5581133841225967`*^9}, {
  3.558113493708844*^9, 3.5581134957742558`*^9}, {3.558115501142384*^9, 
  3.558115514121285*^9}, {3.5581159179336357`*^9, 3.5581159181622267`*^9}, {
  3.558116061343861*^9, 3.558116076369573*^9}, {3.55812951787073*^9, 
  3.5581296470840597`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"zamR", "[", 
    RowBox[{"c_", ",", "d_", ",", 
     RowBox[{"{", 
      RowBox[{"m_", ",", "n_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Lambda]", "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"d", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"c", "-", "1"}], ")"}], "/", "24"}]}], "]"}]}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}], ")"}], 
      RowBox[{"Product", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "\[Lambda]", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "+", 
           RowBox[{
           "\[Lambda]", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "-", 
           RowBox[{
            RowBox[{"\[Lambda]Kac", "[", 
             RowBox[{"c", ",", 
              RowBox[{"{", 
               RowBox[{"p", ",", "q"}], "}"}]}], "]"}], "/", "2"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "\[Lambda]", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "-", 
           RowBox[{
           "\[Lambda]", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "-", 
           RowBox[{
            RowBox[{"\[Lambda]Kac", "[", 
             RowBox[{"c", ",", 
              RowBox[{"{", 
               RowBox[{"p", ",", "q"}], "}"}]}], "]"}], "/", "2"}]}], ")"}], 
         "*", "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "\[Lambda]", "\[LeftDoubleBracket]", "3", 
            "\[RightDoubleBracket]"}], "+", 
           RowBox[{
           "\[Lambda]", "\[LeftDoubleBracket]", "4", 
            "\[RightDoubleBracket]"}], "-", 
           RowBox[{
            RowBox[{"\[Lambda]Kac", "[", 
             RowBox[{"c", ",", 
              RowBox[{"{", 
               RowBox[{"p", ",", "q"}], "}"}]}], "]"}], "/", "2"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "\[Lambda]", "\[LeftDoubleBracket]", "3", 
            "\[RightDoubleBracket]"}], "-", 
           RowBox[{
           "\[Lambda]", "\[LeftDoubleBracket]", "4", 
            "\[RightDoubleBracket]"}], "-", 
           RowBox[{
            RowBox[{"\[Lambda]Kac", "[", 
             RowBox[{"c", ",", 
              RowBox[{"{", 
               RowBox[{"p", ",", "q"}], "}"}]}], "]"}], "/", "2"}]}], ")"}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"p", ",", 
          RowBox[{"1", "-", "m"}], ",", 
          RowBox[{"m", "-", "1"}], ",", "2"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"q", ",", 
          RowBox[{"1", "-", "n"}], ",", 
          RowBox[{"n", "-", "1"}], ",", "2"}], "}"}]}], "\[IndentingNewLine]",
        "]"}], "*", "\[IndentingNewLine]", 
      RowBox[{"Times", "@@", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"\[Lambda]Kac", "[", 
            RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
         "\[IndentingNewLine]", 
         RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"k", ",", "l"}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"k", ",", 
                 RowBox[{
                  RowBox[{"-", "m"}], "+", "1"}], ",", "m"}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"l", ",", 
                 RowBox[{
                  RowBox[{"-", "n"}], "+", "1"}], ",", "n"}], "}"}]}], "]"}], 
             ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], "|", 
             RowBox[{"{", 
              RowBox[{"m", ",", "n"}], "}"}]}], ")"}]}], "]"}]}], 
        "\[IndentingNewLine]", ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.558115402362598*^9, 3.558115433997295*^9}, {
  3.558115535792836*^9, 3.558115618259059*^9}, {3.558115686757984*^9, 
  3.558115770364499*^9}, {3.558116093548574*^9, 3.558116136886813*^9}}],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.558132031933401*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"zamFnonsingular", "[", 
    RowBox[{"d_", ",", "\[CapitalDelta]_"}], "]"}], ":=", 
   RowBox[{"Hypergeometric2F1", "[", 
    RowBox[{
     RowBox[{"\[CapitalDelta]", "+", 
      RowBox[{"d", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      "-", 
      RowBox[{"d", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
     ",", 
     RowBox[{"\[CapitalDelta]", "+", 
      RowBox[{"d", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
      "-", 
      RowBox[{"d", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
     ",", 
     RowBox[{"2", "\[CapitalDelta]"}], ",", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zamF", "[", 
    RowBox[{
    "x_", ",", "d_", ",", "\[CapitalDelta]_", ",", "c_", ",", "max_"}], "]"}],
    ":=", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"max", "\[LessEqual]", "0"}], ",", "0", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"zamFnonsingular", "[", 
       RowBox[{"d", ",", "\[CapitalDelta]"}], "]"}], "+", 
      RowBox[{"Plus", "@@", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"m", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"x", "^", 
             RowBox[{"(", 
              RowBox[{"m", "*", "n"}], ")"}]}], 
            RowBox[{
             RowBox[{"zamR", "[", 
              RowBox[{"c", ",", "d", ",", 
               RowBox[{"{", 
                RowBox[{"m", ",", "n"}], "}"}]}], "]"}], "/", 
             RowBox[{"(", 
              RowBox[{"c", "-", 
               RowBox[{"cKac", "[", 
                RowBox[{"\[CapitalDelta]", ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}], ")"}]}], "*", 
            "\[IndentingNewLine]", 
            RowBox[{"zamF", "[", 
             RowBox[{"x", ",", "d", ",", 
              RowBox[{"\[CapitalDelta]", "+", 
               RowBox[{"m", "*", "n"}]}], ",", 
              RowBox[{"cKac", "[", 
               RowBox[{"\[CapitalDelta]", ",", 
                RowBox[{"{", 
                 RowBox[{"m", ",", "n"}], "}"}]}], "]"}], ",", 
              RowBox[{"max", "-", 
               RowBox[{"m", "*", "n"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
          "]"}], "@@@", "\[IndentingNewLine]", 
         RowBox[{"Select", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Outer", "[", 
              RowBox[{"List", ",", 
               RowBox[{"Range", "[", "max", "]"}], ",", 
               RowBox[{"Range", "[", 
                RowBox[{"2", ",", "max"}], "]"}]}], "]"}], ",", "1"}], "]"}], 
           ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Times", "@@", "#"}], ")"}], "\[LessEqual]", "max"}], 
            "&"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
        ")"}]}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zam\[ScriptCapitalF]84", "[", 
    RowBox[{
    "x_", ",", "d_", ",", "\[CapitalDelta]_", ",", "c_", ",", "max_"}], "]"}],
    ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x", "^", 
     RowBox[{"(", 
      RowBox[{"\[CapitalDelta]", "-", 
       RowBox[{"d", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "-", 
       RowBox[{"d", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      ")"}]}], 
    RowBox[{"zamF", "[", 
     RowBox[{"x", ",", "d", ",", "\[CapitalDelta]", ",", "c", ",", "max"}], 
     "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.558113532140633*^9, 3.558113563693636*^9}, {
   3.5581141342065477`*^9, 3.55811422890246*^9}, {3.558114263200634*^9, 
   3.558114270340866*^9}, {3.558114356974575*^9, 3.5581144441697817`*^9}, {
   3.55811447766362*^9, 3.558114499790977*^9}, {3.5581145449051657`*^9, 
   3.558114563962079*^9}, {3.558114617014619*^9, 3.55811462349186*^9}, {
   3.5581147236754913`*^9, 3.55811472438741*^9}, {3.558114846141775*^9, 
   3.5581148464940577`*^9}, {3.558115822778261*^9, 3.558115825573378*^9}, {
   3.5581158813494673`*^9, 3.558115896346945*^9}, {3.5581159283178883`*^9, 
   3.558115929223186*^9}, {3.5581170549852247`*^9, 3.558117057954495*^9}, {
   3.558117104610746*^9, 3.558117142931611*^9}, {3.558117343263636*^9, 
   3.558117343534113*^9}, {3.558117565486867*^9, 3.558117568936688*^9}, {
   3.558117962689789*^9, 3.558117971311137*^9}, {3.558131922687742*^9, 
   3.558131928842949*^9}, 3.558132036159029*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"zamH", "[", 
    RowBox[{
    "q_", ",", "d_", ",", "\[CapitalDelta]_", ",", "c_", ",", "max_"}], "]"}],
    ":=", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"max", "\[LessEqual]", "0"}], ",", "0", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"1", "+", "\[IndentingNewLine]", 
      RowBox[{"Plus", "@@", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"m", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"16", "q"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"m", "*", "n"}], ")"}]}], 
            RowBox[{
             RowBox[{"zamR", "[", 
              RowBox[{"c", ",", "d", ",", 
               RowBox[{"{", 
                RowBox[{"m", ",", "n"}], "}"}]}], "]"}], "/", 
             RowBox[{"(", 
              RowBox[{"\[CapitalDelta]", "-", 
               RowBox[{"\[CapitalDelta]Kac", "[", 
                RowBox[{"\[CapitalDelta]", ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}], ")"}]}], "*", 
            "\[IndentingNewLine]", 
            RowBox[{"zamH", "[", 
             RowBox[{"d", ",", 
              RowBox[{
               RowBox[{"\[CapitalDelta]Kac", "[", 
                RowBox[{"c", ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "n"}], "}"}]}], "]"}], "+", 
               RowBox[{"m", "*", "n"}]}], ",", "c", ",", 
              RowBox[{"max", "-", 
               RowBox[{"m", "*", "n"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
          "]"}], "@@@", "\[IndentingNewLine]", 
         RowBox[{"Select", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Outer", "[", 
              RowBox[{"List", ",", 
               RowBox[{"Range", "[", "max", "]"}], ",", 
               RowBox[{"Range", "[", "max", "]"}]}], "]"}], ",", "1"}], "]"}],
            ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Times", "@@", "#"}], ")"}], "\[LessEqual]", "max"}], 
            "&"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
        ")"}]}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zam\[ScriptCapitalF]87", "[", 
    RowBox[{
    "x_", ",", "d_", ",", "\[CapitalDelta]_", ",", "c_", ",", "max_"}], "]"}],
    ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"q", "=", 
       RowBox[{"EllipticNomeQ", "[", "x", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"16", "q"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"\[CapitalDelta]", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"c", "-", "1"}], ")"}], "/", "24"}]}], ")"}]}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"x", "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"c", "-", "1"}], ")"}], "/", "24"}], "-", 
         RowBox[{"d", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "-", 
         RowBox[{
         "d", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        ")"}]}], "*", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "x"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"c", "-", "1"}], ")"}], "/", "24"}], "-", 
         RowBox[{"d", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         "-", 
         RowBox[{
         "d", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
        ")"}]}], "*", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"EllipticTheta", "[", 
        RowBox[{"3", ",", "0", ",", "q"}], "]"}], "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"c", "-", "1"}], ")"}], "/", "24"}], "-", 
         RowBox[{"Total", "[", "d", "]"}]}], ")"}]}], "*", 
      "\[IndentingNewLine]", 
      RowBox[{"zamH", "[", 
       RowBox[{"q", ",", "d", ",", "\[CapitalDelta]", ",", "c", ",", "max"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.558116000032003*^9, 3.558116023457752*^9}, {
  3.558116158590404*^9, 3.5581162024977007`*^9}, {3.558116937226248*^9, 
  3.55811704729173*^9}, {3.5581175757538633`*^9, 3.558117583015601*^9}, {
  3.558117679380261*^9, 3.558117683700322*^9}, {3.55811771786619*^9, 
  3.558117736042486*^9}, {3.558117895540769*^9, 3.5581179042774754`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Nekrasov expansion for Liouville block ", "Section",
 CellChangeTimes->{{3.527876249140852*^9, 3.527876277038116*^9}, 
   3.658941611167906*^9}],

Cell["\<\
NB in AGT paper H(s) called A(s), V(s) called L(s)
From appendix A of 1102.0343 \[OpenCurlyDoubleQuote]BBblocks\
\[CloseCurlyDoubleQuote]: \[OpenCurlyDoubleQuote]if s is outside the tableau \
then A and L are negative.\[CloseCurlyDoubleQuote]\
\>", "Text",
 CellChangeTimes->{{3.52795768759225*^9, 3.5279577593133287`*^9}}],

Cell["\<\
if viewing partition as occupying 1st quadrant w/ entries giving column \
heights in desc order, partH is # blocks to R of this block; partV is # \
blocks above this block. Block identified by (x,y) coords in 1st quad, \
starting at (1,1). Almost certainly a more efficient way to get this.\
\>", "Text",
 CellChangeTimes->{{3.527954915595847*^9, 3.527955006277163*^9}, {
  3.527955259969797*^9, 3.5279552695933647`*^9}, {3.527957898217822*^9, 
  3.527957928513895*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"partToXYlist", "[", "part_", "]"}], ":=", 
    RowBox[{"Flatten", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"part", "[", 
             RowBox[{"[", "x", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"Length", "[", "part", "]"}]}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "\t", "1"}], "\n", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"partArmAY", "[", 
     RowBox[{"part_", ",", "xy_"}], "]"}], ":=", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "part", "]"}], "\[Equal]", "0"}], ",", " ", 
      RowBox[{"-", 
       RowBox[{"xy", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"xy", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ">", 
       RowBox[{"First", "[", "part", "]"}]}], ",", " ", 
      RowBox[{"-", 
       RowBox[{"xy", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
      "True", ",", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"transposePartition", "[", "part", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"xy", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", "]"}], "]"}], "-", 
       RowBox[{"xy", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"partLegLY", "[", 
    RowBox[{"part_", ",", "xy_"}], "]"}], ":=", "\n", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xy", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ">", 
      RowBox[{"Length", "[", "part", "]"}]}], ",", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"-", 
      RowBox[{"xy", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"part", "[", 
       RowBox[{"[", 
        RowBox[{"xy", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], "]"}], "-", 
      RowBox[{"xy", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.5279539339142323`*^9, 3.527953973106724*^9}, {
  3.5279542073944807`*^9, 3.5279542109635983`*^9}, {3.5279542588146973`*^9, 
  3.527954270349135*^9}, {3.527954502219157*^9, 3.527954629286313*^9}, {
  3.5279548440403748`*^9, 3.527954846991502*^9}, {3.527955105288527*^9, 
  3.52795515412928*^9}, {3.527955203725534*^9, 3.527955275898548*^9}, {
  3.527957995989544*^9, 3.527958208795642*^9}, {3.527958386359314*^9, 
  3.5279584205298557`*^9}, {3.52795848476289*^9, 3.527958499881104*^9}, {
  3.527958834471292*^9, 3.527958834975175*^9}, {3.527959315877583*^9, 
  3.5279593895164537`*^9}, {3.658941457473325*^9, 3.658941484279806*^9}, {
  3.6589417510791073`*^9, 3.658941762718642*^9}, {3.6589417937665987`*^9, 
  3.658941796422639*^9}, {3.6589418603738117`*^9, 3.6589418675315733`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"partitionPairs", "[", "n_Integer", "]"}], ":=", "\n", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"Outer", "[", "\n", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"n", "-", "j"}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
         
         RowBox[{"IntegerPartitions", "[", "j", "]"}], ",", 
         "\[IndentingNewLine]", "\t\t", "1", ",", "1"}], "\n", "\t", "]"}], 
       ",", "\n", "\t", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "n"}], "}"}]}], "]"}], ",", "\n", "2"}], 
    "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.527960286780073*^9, 3.5279603046053333`*^9}, {
  3.527960335980789*^9, 3.527960395204624*^9}, {3.527960432136989*^9, 
  3.527960432216592*^9}, {3.658943515036111*^9, 3.6589435469630327`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"show\[Lambda]11", "[", 
   StyleBox[
    RowBox[{"\[Lambda]", 
     StyleBox["_",
      FontSize->12]}]], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", "\t", 
     RowBox[{"max", "=", 
      RowBox[{"\[Lambda]", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Grid", "[", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"Transpose", "[", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"ConstantArray", "[", 
             RowBox[{",", 
              RowBox[{"max", "-", "#"}]}], "]"}], ",", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"\[EmptySquare]", ",", "#"}], "]"}]}], "]"}], ")"}], 
         "&"}], "/@", " ", "\[Lambda]"}], "\[IndentingNewLine]", "\t", "]"}], 
      ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"Spacings", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0.25", ",", "0"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}],
    "]"}]}]], "Code",
 CellChangeTimes->{{3.658942268738921*^9, 3.658942323248451*^9}, {
  3.658942366202736*^9, 3.6589424624508944`*^9}, {3.658942493043202*^9, 
  3.658942503194769*^9}, {3.6589426020185957`*^9, 3.658942641649132*^9}}],

Cell[CellGroupData[{

Cell["test", "Subsubsection",
 CellChangeTimes->{{3.659038824273148*^9, 3.659038825007782*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Lambda]", "=", 
   RowBox[{"{", 
    RowBox[{"4", ",", "3", ",", "2", ",", "1", ",", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"partToXYlist", "[", "\[Lambda]", "]"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"partArmAY", "[", 
    RowBox[{"\[Lambda]", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}]}], "]"}], ",", 
   RowBox[{"partLegLY", "[", 
    RowBox[{"\[Lambda]", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}]}], "]"}]}], "}"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "\[Lambda]", "]"}]}], "Input",
 CellChangeTimes->{{3.658941704713007*^9, 3.6589417133333282`*^9}, {
  3.658941781528064*^9, 3.658941829183682*^9}, {3.6589421839391537`*^9, 
  3.658942197034031*^9}, {3.65903881392362*^9, 3.659038814688409*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.65894171606698*^9, 3.658941829724633*^9, 
  3.658942197718164*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.65894171606698*^9, 3.658941829724633*^9, 
  3.658942197726843*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"show\[Lambda]11", "[", 
  RowBox[{"{", 
   RowBox[{"4", ",", "3", ",", "2", ",", "1", ",", "1"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.658942625855974*^9, 3.658942627727933*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[EmptySquare]", "", "", "", ""},
    {"\[EmptySquare]", "\[EmptySquare]", "", "", ""},
    {"\[EmptySquare]", "\[EmptySquare]", "\[EmptySquare]", "", ""},
    {"\[EmptySquare]", "\[EmptySquare]", "\[EmptySquare]", "\[EmptySquare]", 
     "\[EmptySquare]"}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
   GridBoxSpacings->{"Columns" -> {{0.25}}, "Rows" -> {{0}}}],
  "Grid"]], "Output",
 CellChangeTimes->{{3.658942602770733*^9, 3.658942612589101*^9}, 
   3.658942645593122*^9}]
}, Open  ]]
}, Closed]],

Cell["end test", "Subsubsection",
 CellChangeTimes->{{3.659038828191802*^9, 3.659038829223937*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Belavin-Belavin appendix A (arxiv version) conventions", "Section",
 CellChangeTimes->{{3.659038880271044*^9, 3.659038897477543*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bb\[Phi]", "[", 
     RowBox[{"a_", ",", "b_", ",", 
      RowBox[{"{", 
       RowBox[{"i_", ",", "j_"}], "}"}]}], "]"}], ":=", "\n", "\t", 
    RowBox[{"a", "+", 
     RowBox[{"b", 
      RowBox[{"(", 
       RowBox[{"i", "-", "1"}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "b"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"j", "-", "1"}], ")"}]}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bbE", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i_", ",", "j_"}], "}"}], ",", "as_", ",", "Ys_", ",", "b_", 
      ",", "xy_"}], "]"}], ":=", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"as", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "-", 
       RowBox[{"as", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "+", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{
      RowBox[{"-", "b"}], "*", 
      RowBox[{"partArmAY", "[", 
       RowBox[{
        RowBox[{"Ys", "[", 
         RowBox[{"[", "j", "]"}], "]"}], ",", "xy"}], "]"}]}], "+", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "b"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"partLegLY", "[", 
         RowBox[{
          RowBox[{"Ys", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "xy"}], "]"}], "+", "1"}], 
       ")"}]}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"bbD", "[", 
    RowBox[{"as_", ",", "Ys_", ",", "b_"}], "]"}], ":=", "\n", 
   RowBox[{"Product", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"Times", "@@", " ", 
      RowBox[{"(", "\n", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"bbE", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "j"}], "}"}], ",", "as", ",", "Ys", ",", "b", 
           ",", "#"}], "]"}], "&"}], "/@", " ", 
        RowBox[{"partToXYlist", "[", 
         RowBox[{"Ys", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "\n", "\t", ")"}]}], ",", 
     "\n", "\t", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "2"}], "}"}]}], "\n", "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"bbDBar", "[", 
   RowBox[{"as_", ",", "Ys_", ",", "b_"}], "]"}], ":=", "\n", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\n", "\t", 
     RowBox[{"Q", "=", 
      RowBox[{"b", "+", 
       RowBox[{"1", "/", "b"}]}]}], "\n", "}"}], ",", "\n", 
    RowBox[{"Product", "[", "\n", "\t", 
     RowBox[{
      RowBox[{"Times", "@@", " ", 
       RowBox[{"(", "\n", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Q", "-", 
            RowBox[{"bbE", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", "j"}], "}"}], ",", "as", ",", "Ys", ",", "b",
               ",", "#"}], "]"}]}], ")"}], "&"}], "/@", " ", 
         RowBox[{"partToXYlist", "[", 
          RowBox[{"Ys", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "\n", "\t", ")"}]}], ",", 
      "\n", "\t", 
      RowBox[{"{", 
       RowBox[{"i", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "2"}], "}"}]}], "\n", "]"}]}], "]"}]}]}], "Code",
 CellChangeTimes->{{3.658941871508004*^9, 3.658941883930366*^9}, {
  3.658942125692935*^9, 3.658942126795355*^9}, {3.6589429061051188`*^9, 
  3.658943038650638*^9}, {3.65894307309092*^9, 3.658943164312413*^9}, {
  3.658943201096253*^9, 3.658943252680401*^9}, {3.65894333885916*^9, 
  3.658943341283388*^9}, {3.658943966810116*^9, 3.6589439927433567`*^9}, {
  3.6590389007585707`*^9, 3.659038918909284*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"bbZf", "[", 
    RowBox[{"as_", ",", "Ys_", ",", "b_", ",", "\[Mu]_"}], "]"}], ":=", "\n", 
   
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t", 
      RowBox[{"Q", "=", 
       RowBox[{"b", "+", 
        RowBox[{"1", "/", "b"}]}]}], "\n", "}"}], ",", "\n", 
     RowBox[{"Product", "[", "\n", "\t", 
      RowBox[{
       RowBox[{"Times", "@@", " ", 
        RowBox[{"(", "\n", "\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"bb\[Phi]", "[", 
              RowBox[{
               RowBox[{"as", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", "b", ",", "#"}], "]"}], 
             "-", "\[Mu]", "+", "Q"}], ")"}], "&"}], "/@", " ", 
          RowBox[{"partToXYlist", "[", 
           RowBox[{"Ys", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "\n", "\t", ")"}]}], ",",
        "\n", "\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "2"}], "}"}]}], "\n", "]"}]}], "]"}]}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"bbZaf", "[", 
    RowBox[{"as_", ",", "Ys_", ",", "b_", ",", "\[Mu]_"}], "]"}], ":=", "\n", 
   
   RowBox[{"Product", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"Times", "@@", " ", 
      RowBox[{"(", "\n", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"bb\[Phi]", "[", 
            RowBox[{
             RowBox[{"as", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "b", ",", "#"}], "]"}], 
           "+", "\[Mu]"}], ")"}], "&"}], "/@", " ", 
        RowBox[{"partToXYlist", "[", 
         RowBox[{"Ys", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "\n", "\t", ")"}]}], ",", 
     "\n", "\t", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "2"}], "}"}]}], "\n", "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"bbZvec", "[", 
    RowBox[{"as_", ",", "Ys_", ",", "b_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"bbD", "[", 
     RowBox[{"as", ",", "Ys", ",", "b"}], "]"}], 
    RowBox[{"bbDBar", "[", 
     RowBox[{"as", ",", "Ys", ",", "b"}], "]"}]}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.658943263631028*^9, 3.65894341884769*^9}, {
  3.6589439486744967`*^9, 3.6589439499620247`*^9}, {3.659038922159181*^9, 
  3.6590389478522778`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]sTo\[Mu]s", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Lambda]1_", ",", "\[Lambda]2_"}], "}"}], ",", "b_"}], "]"}],
     ":=", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", "\t", 
       RowBox[{"Q", "=", 
        RowBox[{"b", "+", 
         RowBox[{"1", "/", "b"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
      RowBox[{"{", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"Q", "/", "2"}], "-", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}], ")"}]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"Q", "/", "2"}], "-", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "-", "\[Lambda]2"}], ")"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]sTo\[Mu]s", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Lambda]1_", ",", "\[Lambda]2_", ",", "\[Lambda]3_", ",", 
        "\[Lambda]4_"}], "}"}], ",", "b_"}], "]"}], ":=", "\n", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"\[Lambda]sTo\[Mu]s", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Lambda]1", ",", "\[Lambda]2"}], "}"}], ",", "b"}], "]"}], 
      ",", 
      RowBox[{"\[Lambda]sTo\[Mu]s", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Lambda]3", ",", "\[Lambda]4"}], "}"}], ",", "b"}], 
       "]"}]}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bbInnerProd", "[", 
     RowBox[{"n_", ",", "\[Lambda]s_", ",", "b_", ",", "P_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"\[Mu]s", "=", 
         RowBox[{"\[Lambda]sTo\[Mu]s", "[", 
          RowBox[{"\[Lambda]s", ",", "b"}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"as", "=", 
         RowBox[{"{", 
          RowBox[{"P", ",", 
           RowBox[{"-", "P"}]}], "}"}]}]}], "\[IndentingNewLine]", "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", "\n", "\t", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"bbZf", "[", 
              RowBox[{"as", ",", "#", ",", "b", ",", 
               RowBox[{"\[Mu]s", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], 
             RowBox[{"bbZf", "[", 
              RowBox[{"as", ",", "#", ",", "b", ",", 
               RowBox[{"\[Mu]s", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"bbZaf", "[", 
              RowBox[{"as", ",", "#", ",", "b", ",", 
               RowBox[{"\[Mu]s", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "]"}], 
             RowBox[{"bbZaf", "[", 
              RowBox[{"as", ",", "#", ",", "b", ",", 
               RowBox[{"\[Mu]s", "[", 
                RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], "\n", "\t", ")"}], 
           "/", 
           RowBox[{"(", "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"bbD", "[", 
              RowBox[{"as", ",", "#", ",", "b"}], "]"}], 
             RowBox[{"bbDBar", "[", 
              RowBox[{"as", ",", "#", ",", "b"}], "]"}]}], 
            "\[IndentingNewLine]", "\t", ")"}]}], ")"}], "&"}], "/@", 
        RowBox[{"partitionPairs", "[", "n", "]"}]}], "\[IndentingNewLine]", 
       "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"bbVirCoeff", "[", 
    RowBox[{"n_", ",", "\[Lambda]s_", ",", "b_", ",", "P_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"\[Mu]s", "=", 
        RowBox[{"\[Lambda]sTo\[Mu]s", "[", 
         RowBox[{"\[Lambda]s", ",", "b"}], "]"}]}], ",", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"as", "=", 
        RowBox[{"{", 
         RowBox[{"P", ",", 
          RowBox[{"-", "P"}]}], "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", "\n", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"bbZf", "[", 
              RowBox[{"as", ",", "#", ",", "b", ",", 
               RowBox[{"\[Mu]s", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], 
             RowBox[{"bbZf", "[", 
              RowBox[{"as", ",", "#", ",", "b", ",", 
               RowBox[{"\[Mu]s", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "\n", "\t", ")"}], 
           "/", 
           RowBox[{"(", "\[IndentingNewLine]", "\t", 
            RowBox[{"bbD", "[", 
             RowBox[{"as", ",", "#", ",", "b"}], "]"}], "\[IndentingNewLine]",
             "\t", ")"}]}], 
          RowBox[{"(", 
           RowBox[{"virVec", " ", "@", " ", "#"}], ")"}]}], ")"}], "&"}], "/@", 
       RowBox[{"partitionPairs", "[", "n", "]"}]}], "\[IndentingNewLine]", 
      "]"}]}], "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.6589437987205667`*^9, 3.6589438503329763`*^9}, {
  3.658943887876444*^9, 3.65894389430075*^9}, {3.658943938887109*^9, 
  3.658943940982602*^9}, {3.658944015493793*^9, 3.6589441898376017`*^9}, {
  3.6589442232814302`*^9, 3.6589443149094133`*^9}, {3.659038974781446*^9, 
  3.6590390091882553`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["try again, AFLT conventions", "Section",
 CellChangeTimes->{{3.6590388586558323`*^9, 3.65903886026283*^9}, {
  3.659039014906466*^9, 3.659039020728924*^9}}],

Cell["\<\
Still using first quadrant convention for partitions, cf. arxiv version, as \
opposed to published version\
\>", "Text",
 CellChangeTimes->{{3.6590394703125143`*^9, 3.659039488821631*^9}, {
  3.6592826713340673`*^9, 3.6592826769140873`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"afltE", "[", 
     RowBox[{"xy_", ",", "P_", ",", "\[Lambda]_", ",", "\[Mu]_", ",", "b_"}], 
     "]"}], ":=", "\[IndentingNewLine]", "\t", 
    RowBox[{"P", " ", "-", " ", 
     RowBox[{"b", "*", 
      RowBox[{"partArmAY", "[", 
       RowBox[{"\[Mu]", ",", "xy"}], "]"}]}], "+", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "b"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"partLegLY", "[", 
         RowBox[{"\[Lambda]", ",", "xy"}], "]"}], "+", "1"}], ")"}]}]}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"afltZbif", "[", 
     RowBox[{
     "\[Alpha]_", ",", "PP_", ",", "\[Mu]s_", ",", "P_", ",", "\[Lambda]s_", 
      ",", "b_"}], "]"}], ":=", "\n", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", "\n", "\t", 
       RowBox[{
        RowBox[{"Q", "=", 
         RowBox[{"b", "+", 
          RowBox[{"1", "/", "b"}]}]}], ",", "\n", "\t", 
        RowBox[{"Pvec", "=", 
         RowBox[{"{", 
          RowBox[{"P", ",", 
           RowBox[{"-", "P"}]}], "}"}]}], ",", "\n", "\t", 
        RowBox[{"PPvec", "=", 
         RowBox[{"{", 
          RowBox[{"PP", ",", 
           RowBox[{"-", "PP"}]}], "}"}]}]}], "\n", "}"}], ",", "\n", 
      RowBox[{"Product", "[", "\n", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Times", "@@", " ", 
           RowBox[{"(", "\n", "\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Q", "-", 
                RowBox[{"afltE", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{
                   RowBox[{"Pvec", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", 
                   RowBox[{"PPvec", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ",", 
                  RowBox[{"\[Lambda]s", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"\[Mu]s", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", "b"}], "]"}], "-", 
                "\[Alpha]"}], ")"}], "&"}], "\n", "\t\t\t", "/@", " ", 
             RowBox[{"partToXYlist", "[", 
              RowBox[{"\[Lambda]s", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "\n", "\t", ")"}]}], 
          ")"}], 
         RowBox[{"(", "\n", "\t", 
          RowBox[{"Times", "@@", " ", 
           RowBox[{"(", "\n", "\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"afltE", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{
                   RowBox[{"PPvec", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "-", 
                   RowBox[{"Pvec", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                  RowBox[{"\[Mu]s", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", 
                  RowBox[{"\[Lambda]s", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "b"}], "]"}], "-", 
                "\[Alpha]"}], ")"}], "&"}], "\n", "\t\t\t", "/@", " ", 
             RowBox[{"partToXYlist", "[", 
              RowBox[{"\[Mu]s", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "\n", "\t", ")"}]}], 
          ")"}]}], ",", "\n", "\t", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2"}], "}"}]}], "\n", "]"}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"afltZvec", "[", 
    RowBox[{"P_", ",", "\[Lambda]s_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"1", "/", 
    RowBox[{"afltZbif", "[", 
     RowBox[{
     "0", ",", "P", ",", "\[Lambda]s", ",", "P", ",", "\[Lambda]s", ",", 
      "b"}], "]"}]}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.65903938114601*^9, 3.6590393816965847`*^9}, {
  3.6590395087633257`*^9, 3.659039680988947*^9}, {3.6590397240674887`*^9, 
  3.659040013312367*^9}, {3.659041918713663*^9, 3.659041948836132*^9}}],

Cell[CellGroupData[{

Cell["Alternate formulation", "Subsection",
 CellChangeTimes->{{3.6592825737741423`*^9, 3.659282576801763*^9}}],

Cell["\<\
See appendix B of AFLT- more transparent way to probe singular vectors?? \
Closer relationship to instanton moduli space?\
\>", "Text",
 CellChangeTimes->{{3.659046363724684*^9, 3.659046386938746*^9}, {
  3.6590473415902*^9, 3.659047349973032*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"afltZbifF", "[", 
     RowBox[{"x_", ",", "\[Nu]_", ",", "\[Mu]_", ",", "b_"}], "]"}], ":=", 
    "\n", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", "\n", "\t", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "\[Nu]", "]"}]}], ",", "\n", "\t", 
        RowBox[{"m", "=", 
         RowBox[{"Length", "[", "\[Mu]", "]"}]}], ",", "\n", "\t", 
        RowBox[{"g", "=", 
         RowBox[{"-", 
          RowBox[{"b", "^", "2"}]}]}]}], "\n", "}"}], ",", "\n", 
      RowBox[{
       RowBox[{"Product", "[", "\n", "\t", 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"x", "+", 
           RowBox[{"\[Mu]", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "-", 
           RowBox[{"\[Nu]", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "j"}], ")"}], "g"}]}], "]"}], ",", "\n", "\t", 
         
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "m"}], "}"}]}], "\n", "]"}], 
       RowBox[{"Product", "[", "\n", "\t", 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"x", "+", 
           RowBox[{"\[Mu]", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "-", "0", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "+", "1", "-", "j"}], ")"}], "g"}]}], "]"}], ",", 
         "\n", "\t", 
         RowBox[{"{", 
          RowBox[{"j", ",", "m"}], "}"}]}], "\n", "]"}], 
       RowBox[{
        RowBox[{"Product", "[", "\n", "\t", 
         RowBox[{
          RowBox[{"Gamma", "[", 
           RowBox[{"x", "+", 
            RowBox[{"i", "*", "g"}]}], "]"}], ",", "\n", "\t", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n"}], "}"}]}], "\n", "]"}], "/", 
        RowBox[{"(", "\n", 
         RowBox[{
          RowBox[{"Product", "[", "\n", "\t", 
           RowBox[{
            RowBox[{"Gamma", "[", 
             RowBox[{"x", "+", 
              RowBox[{"\[Mu]", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "-", 
              RowBox[{"\[Nu]", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "-", "j", "+", "1"}], ")"}], "g"}]}], "]"}], ",",
             "\n", "\t", 
            RowBox[{"{", 
             RowBox[{"i", ",", "n"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "m"}], "}"}]}], "\n", "]"}], 
          RowBox[{"Product", "[", "\n", "\t", 
           RowBox[{
            RowBox[{"Gamma", "[", 
             RowBox[{"x", "+", "0", "-", 
              RowBox[{"\[Nu]", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "-", 
                 RowBox[{"(", 
                  RowBox[{"m", "+", "1"}], ")"}], "+", "1"}], ")"}], "g"}]}], 
             "]"}], ",", "\n", "\t", 
            RowBox[{"{", 
             RowBox[{"i", ",", "n"}], "}"}]}], "\n", "]"}], 
          RowBox[{"Product", "[", "\n", "\t", 
           RowBox[{
            RowBox[{"Gamma", "[", 
             RowBox[{"x", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"n", "+", "1", "-", "j"}], ")"}], "g"}]}], "]"}], ",",
             "\n", "\t", 
            RowBox[{"{", 
             RowBox[{"j", ",", "m"}], "}"}]}], "\n", "]"}]}], ")"}]}]}]}], 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"afltZbifAlt", "[", 
    RowBox[{
    "\[Alpha]_", ",", "PP_", ",", "\[Mu]s_", ",", "P_", ",", "\[Lambda]s_", 
     ",", "b_"}], "]"}], ":=", "\n", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t", 
      RowBox[{
       RowBox[{"Q", "=", 
        RowBox[{"b", "+", 
         RowBox[{"1", "/", "b"}]}]}], ",", "\n", "\t", 
       RowBox[{"Pvec", "=", 
        RowBox[{"{", 
         RowBox[{"P", ",", 
          RowBox[{"-", "P"}]}], "}"}]}], ",", "\n", "\t", 
       RowBox[{"PPvec", "=", 
        RowBox[{"{", 
         RowBox[{"PP", ",", 
          RowBox[{"-", "PP"}]}], "}"}]}]}], "\n", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"b", "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], 
         RowBox[{"Total", "@", " ", 
          RowBox[{"Flatten", "@", " ", 
           RowBox[{"Join", "[", 
            RowBox[{"\[Mu]s", ",", "\[Lambda]s"}], "]"}]}]}]}], ")"}]}], "*", 
      "\n", 
      RowBox[{"Product", "[", "\n", "\t", 
       RowBox[{
        RowBox[{"afltZbifF", "[", "\n", "\t\t", 
         RowBox[{
          RowBox[{"b", 
           RowBox[{"(", 
            RowBox[{"Q", "-", 
             RowBox[{"Pvec", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "+", 
             RowBox[{"PPvec", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "-", "\[Alpha]"}], ")"}]}], ",",
           "\n", "\t\t", 
          RowBox[{"\[Lambda]s", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "\n", "\t\t", 
          RowBox[{"\[Mu]s", "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", "\n", "\t\t", "b"}], "\n", 
         "\t", "]"}], ",", "\n", "\t", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "2"}], "}"}]}], "\n", "]"}]}]}], "]"}]}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.6590463591658287`*^9, 3.6590464969114313`*^9}, {
   3.659046606157083*^9, 3.659046711124104*^9}, {3.659046744473936*^9, 
   3.659046762961649*^9}, {3.6590472133389177`*^9, 3.659047291340816*^9}, {
   3.659047324647903*^9, 3.659047325624105*^9}, {3.659047359240349*^9, 
   3.6590474188321047`*^9}, {3.65904749168579*^9, 3.659047519314925*^9}, {
   3.659047597566647*^9, 3.6590475999085712`*^9}, {3.659047648765129*^9, 
   3.6590476505970907`*^9}, {3.6590476876818333`*^9, 3.659047744543337*^9}, {
   3.659047802006948*^9, 3.659047803628942*^9}, 3.6590478419829893`*^9, 
   3.659047961286941*^9}],

Cell[CellGroupData[{

Cell["test", "Subsubsection",
 CellChangeTimes->{{3.6590479228992567`*^9, 3.659047923499818*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"foo1", "=", 
  RowBox[{"Factor", "@", 
   RowBox[{"afltZbif", "[", 
    RowBox[{"\[Alpha]", ",", "PP", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "P", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", "4", "}"}]}], "}"}], ",", "b"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.659047549231586*^9, 3.659047552198591*^9}, {
  3.659047765389865*^9, 3.659047765934713*^9}, {3.659047850933167*^9, 
  3.6590479021838503`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   SuperscriptBox["b", "16"]], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"b", "-", "P", "-", "PP", "-", "\[Alpha]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "b"}], "-", "P", "-", "PP", "-", "\[Alpha]"}], ")"}], 
   " ", 
   RowBox[{"(", 
    RowBox[{"P", "-", "PP", "-", "\[Alpha]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"b", "-", "P", "+", "PP", "-", "\[Alpha]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "b"}], "-", "P", "+", "PP", "-", "\[Alpha]"}], ")"}], 
   " ", 
   RowBox[{"(", 
    RowBox[{"P", "+", "PP", "-", "\[Alpha]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", 
     RowBox[{"b", " ", "P"}], "-", 
     RowBox[{"b", " ", "PP"}], "-", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"b", " ", "P"}], "-", 
     RowBox[{"b", " ", "PP"}], "-", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"b", " ", "P"}], "-", 
     RowBox[{"b", " ", "PP"}], "-", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["b", "2"], "+", 
     RowBox[{"b", " ", "P"}], "-", 
     RowBox[{"b", " ", "PP"}], "-", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "3"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["b", "2"]}], "+", 
     RowBox[{"b", " ", "P"}], "-", 
     RowBox[{"b", " ", "PP"}], "-", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["b", "2"], "-", 
     RowBox[{"b", " ", "P"}], "+", 
     RowBox[{"b", " ", "PP"}], "-", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"b", " ", "P"}], "+", 
     RowBox[{"b", " ", "PP"}], "-", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"b", " ", "P"}], "+", 
     RowBox[{"b", " ", "PP"}], "-", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"2", "+", 
     RowBox[{"b", " ", "P"}], "+", 
     RowBox[{"b", " ", "PP"}], "-", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", 
     SuperscriptBox["b", "2"], "+", 
     RowBox[{"b", " ", "P"}], "+", 
     RowBox[{"b", " ", "PP"}], "-", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["b", "2"], "+", 
     RowBox[{"b", " ", "P"}], "+", 
     RowBox[{"b", " ", "PP"}], "-", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "3"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["b", "2"]}], "+", 
     RowBox[{"b", " ", "P"}], "+", 
     RowBox[{"b", " ", "PP"}], "-", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"b", " ", "P"}], "-", 
     RowBox[{"b", " ", "PP"}], "+", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", 
     SuperscriptBox["b", "2"], "+", 
     RowBox[{"b", " ", "P"}], "-", 
     RowBox[{"b", " ", "PP"}], "+", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"b", " ", "P"}], "+", 
     RowBox[{"b", " ", "PP"}], "+", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["b", "2"], "+", 
     RowBox[{"b", " ", "P"}], "+", 
     RowBox[{"b", " ", "PP"}], "+", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.659047552849464*^9, 3.659047766797958*^9, 
  3.659047852250897*^9, 3.659047903058909*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"foo2", "=", 
  RowBox[{"FunctionExpand", "@", 
   RowBox[{"afltZbifAlt", "[", 
    RowBox[{"\[Alpha]", ",", "PP", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", "P", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", "4", "}"}]}], "}"}], ",", "b"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.659047436351956*^9, 3.6590474782365837`*^9}, {
  3.659047531809183*^9, 3.659047542878986*^9}, {3.659047769550384*^9, 
  3.659047771500983*^9}, {3.659047848854759*^9, 3.65904790023981*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   SuperscriptBox["b", "16"]], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"b", "-", "P", "-", "PP", "-", "\[Alpha]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "b"}], "-", "P", "-", "PP", "-", "\[Alpha]"}], ")"}], 
   " ", 
   RowBox[{"(", 
    RowBox[{"P", "-", "PP", "-", "\[Alpha]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"b", "-", "P", "+", "PP", "-", "\[Alpha]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "b"}], "-", "P", "+", "PP", "-", "\[Alpha]"}], ")"}], 
   " ", 
   RowBox[{"(", 
    RowBox[{"P", "+", "PP", "-", "\[Alpha]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"b", " ", "P"}], "-", 
     RowBox[{"b", " ", "PP"}], "-", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SuperscriptBox["b", "2"], "-", 
     RowBox[{"b", " ", "P"}], "-", 
     RowBox[{"b", " ", "PP"}], "-", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", 
     RowBox[{"b", " ", "P"}], "-", 
     RowBox[{"b", " ", "PP"}], "-", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"b", " ", "P"}], "-", 
     RowBox[{"b", " ", "PP"}], "-", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"b", " ", "P"}], "-", 
     RowBox[{"b", " ", "PP"}], "-", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["b", "2"], "+", 
     RowBox[{"b", " ", "P"}], "-", 
     RowBox[{"b", " ", "PP"}], "-", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "3"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["b", "2"]}], "+", 
     RowBox[{"b", " ", "P"}], "-", 
     RowBox[{"b", " ", "PP"}], "-", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"b", " ", "P"}], "+", 
     RowBox[{"b", " ", "PP"}], "-", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"2", "-", 
     SuperscriptBox["b", "2"], "-", 
     RowBox[{"b", " ", "P"}], "+", 
     RowBox[{"b", " ", "PP"}], "-", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["b", "2"], "-", 
     RowBox[{"b", " ", "P"}], "+", 
     RowBox[{"b", " ", "PP"}], "-", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"b", " ", "P"}], "+", 
     RowBox[{"b", " ", "PP"}], "-", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"b", " ", "P"}], "+", 
     RowBox[{"b", " ", "PP"}], "-", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"2", "+", 
     RowBox[{"b", " ", "P"}], "+", 
     RowBox[{"b", " ", "PP"}], "-", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", 
     SuperscriptBox["b", "2"], "+", 
     RowBox[{"b", " ", "P"}], "+", 
     RowBox[{"b", " ", "PP"}], "-", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["b", "2"], "+", 
     RowBox[{"b", " ", "P"}], "+", 
     RowBox[{"b", " ", "PP"}], "-", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "3"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["b", "2"]}], "+", 
     RowBox[{"b", " ", "P"}], "+", 
     RowBox[{"b", " ", "PP"}], "-", 
     RowBox[{"b", " ", "\[Alpha]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.659047465911847*^9, 3.6590475434328623`*^9}, 
   3.659047654751988*^9, {3.659047749755103*^9, 3.659047771907033*^9}, {
   3.65904784543883*^9, 3.659047854228384*^9}, 3.659047904701099*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"foo1", "/", "foo2"}], "//", "Factor"}]], "Input",
 CellChangeTimes->{{3.6590477738319387`*^9, 3.659047780964385*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.65904777556949*^9, 3.659047781419673*^9}, 
   3.6590478603628273`*^9}]
}, Open  ]]
}, Closed]],

Cell["end test", "Subsubsection",
 CellChangeTimes->{{3.659047927138464*^9, 3.659047928395424*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["end alt", "Subsection",
 CellChangeTimes->{{3.6592827620204287`*^9, 3.659282762841659*^9}}],

Cell["\<\
afltZk handles block of arbitrary length - for simplicity, notation identical \
to AFLT\
\>", "Text",
 CellChangeTimes->{{3.659142674044137*^9, 3.6591426803033657`*^9}, {
  3.6592820585799723`*^9, 3.6592820790890837`*^9}}],

Cell[CellGroupData[{

Cell["prev version (Incorrect)", "Subsubsection",
 CellChangeTimes->{{3.6592774402466173`*^9, 3.659277441787046*^9}, {
  3.65928116087362*^9, 3.6592811631461163`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"afltZk4pt", "[", 
     RowBox[{"k_", ",", 
      RowBox[{"{", 
       RowBox[{
       "\[CapitalDelta]1_", ",", "\[CapitalDelta]2_", ",", 
        "\[CapitalDelta]3_", ",", "\[CapitalDelta]4_"}], "}"}], ",", 
      "\[CapitalDelta]t1_", ",", "b_"}], "]"}], ":=", "\n", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"k", "\[Equal]", "0"}], ",", 
      RowBox[{"Return", "[", "1", "]"}], ",", "\n", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "\n", "\t", 
         RowBox[{
          RowBox[{"null", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "}"}], ",", 
             RowBox[{"{", "}"}]}], "}"}]}], ",", "\n", "\t", 
          RowBox[{"Q", "=", 
           RowBox[{"b", "+", 
            RowBox[{"1", "/", "b"}]}]}], ",", "\n", "\t", "P", ",", "P1", ",",
           "Phat", ",", "\[Alpha]2", ",", "\[Alpha]3"}], "\n", "}"}], ",", 
        "\n", 
        RowBox[{
         RowBox[{"P", "=", 
          RowBox[{"\[CapitalDelta]toP", "[", 
           RowBox[{"\[CapitalDelta]1", ",", "b"}], "]"}]}], ";", "\n", 
         RowBox[{"Phat", "=", 
          RowBox[{"\[CapitalDelta]toP", "[", 
           RowBox[{"\[CapitalDelta]4", ",", "b"}], "]"}]}], ";", "\n", 
         RowBox[{"P1", "=", 
          RowBox[{"\[CapitalDelta]toP", "[", 
           RowBox[{"\[CapitalDelta]t1", ",", "b"}], "]"}]}], ";", "\n", 
         RowBox[{"\[Alpha]2", "=", 
          RowBox[{"\[CapitalDelta]to\[Alpha]", "[", 
           RowBox[{"\[CapitalDelta]2", ",", "b"}], "]"}]}], ";", "\n", 
         RowBox[{"\[Alpha]3", "=", 
          RowBox[{"\[CapitalDelta]to\[Alpha]", "[", 
           RowBox[{"\[CapitalDelta]3", ",", "b"}], "]"}]}], ";", "\n", 
         RowBox[{"Return", "@", 
          RowBox[{"Total", "[", "\n", "\t", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"afltZvec", "[", 
                RowBox[{"P1", ",", "#", ",", "b"}], "]"}], "*", "\n", "\t", 
               RowBox[{"afltZbif", "[", 
                RowBox[{
                "\[Alpha]2", ",", "P", ",", "null", ",", "P1", ",", "#", ",", 
                 "b"}], "]"}], "*", "\n", "\t", 
               RowBox[{"afltZbif", "[", 
                RowBox[{
                "\[Alpha]3", ",", "P1", ",", "#", ",", "Phat", ",", "null", 
                 ",", "b"}], "]"}]}], ")"}], "&"}], "/@", " ", 
            RowBox[{"partitionPairs", "[", "k", "]"}]}], "\n", "]"}]}]}]}], 
       "]"}]}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"afltZk", "[", 
    RowBox[{
    "ks_", ",", "\[CapitalDelta]s_", ",", "\[CapitalDelta]ts_", ",", "b_"}], 
    "]"}], ":=", "\n", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Total", "[", "ks", "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{"Return", "[", "1", "]"}], ",", "\n", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t", 
        RowBox[{
         RowBox[{"nExt", " ", "=", " ", 
          RowBox[{"Length", "[", "\[CapitalDelta]s", "]"}]}], ",", "\n", "\t", 
         RowBox[{"null", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}]}], "}"}]}], ",", "\n", "\t", 
         RowBox[{"Q", "=", 
          RowBox[{"b", "+", 
           RowBox[{"1", "/", "b"}]}]}], ",", "\n", "\t", "P", ",", "Ps", ",", 
         "Phat", ",", "\[Alpha]s"}], "\n", "}"}], ",", "\n", 
       RowBox[{
        RowBox[{"P", "=", 
         RowBox[{"\[CapitalDelta]toP", "[", 
          RowBox[{
           RowBox[{"First", "@", "\[CapitalDelta]s"}], ",", "b"}], "]"}]}], 
        ";", "\n", 
        RowBox[{"Phat", "=", 
         RowBox[{"\[CapitalDelta]toP", "[", 
          RowBox[{
           RowBox[{"Last", "@", "\[CapitalDelta]s"}], ",", "b"}], "]"}]}], 
        ";", "\n", 
        RowBox[{"Ps", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\[CapitalDelta]toP", "[", 
            RowBox[{"#", ",", "b"}], "]"}], "&"}], "/@", " ", 
          "\[CapitalDelta]ts"}]}], ";", "\n", 
        RowBox[{"\[Alpha]s", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\[CapitalDelta]to\[Alpha]", "[", 
            RowBox[{"#", ",", "b"}], "]"}], "&"}], "/@", " ", 
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"Drop", "[", 
             RowBox[{"\[CapitalDelta]s", ",", "2"}], "]"}], ",", 
            RowBox[{"-", "2"}]}], "]"}]}]}], ";", "\n", 
        RowBox[{"Return", "@", 
         RowBox[{"Total", "[", "\n", "\t", 
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{"\[Lambda]s", ",", "\n", "\t\t", 
             RowBox[{
              RowBox[{"Times", "@@", 
               RowBox[{"(", "\n", "\t\t\t", 
                RowBox[{"MapThread", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"afltZvec", "[", 
                    RowBox[{"#1", ",", "#2", ",", "b"}], "]"}], "&"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"Ps", ",", "\[Lambda]s"}], "}"}]}], "]"}], "\n", 
                "\t\t", ")"}]}], "\n", "\t\t", 
              RowBox[{"afltZbif", "[", 
               RowBox[{
                RowBox[{"\[CapitalDelta]to\[Alpha]", "[", 
                 RowBox[{
                  RowBox[{"\[CapitalDelta]s", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", "b"}], "]"}], ",", 
                "P", ",", "null", ",", 
                RowBox[{"First", "[", "Ps", "]"}], ",", 
                RowBox[{"First", "[", "\[Lambda]s", "]"}], ",", "b"}], "]"}], 
              "*", "\n", "\t\t", 
              RowBox[{"Times", "@@", 
               RowBox[{"(", "\n", "\t\t\t", 
                RowBox[{"MapThread", "[", "\n", "\t\t\t\t", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"afltZbif", "[", 
                    RowBox[{"#1", ",", 
                    RowBox[{"First", "[", "#2", "]"}], ",", 
                    RowBox[{"First", "[", "#3", "]"}], ",", 
                    RowBox[{"Last", "[", "#2", "]"}], ",", 
                    RowBox[{"Last", "[", "#3", "]"}], ",", "b"}], "]"}], 
                   "&"}], ",", "\n", "\t\t\t\t", 
                  RowBox[{"{", "\n", "\t\t\t\t\t", 
                   RowBox[{"\[Alpha]s", ",", "\n", "\t\t\t\t\t", 
                    RowBox[{"Partition", "[", 
                    RowBox[{"Ps", ",", "2", ",", "1"}], "]"}], ",", "\n", 
                    "\t\t\t\t\t", 
                    RowBox[{"Partition", "[", 
                    RowBox[{"\[Lambda]s", ",", "2", ",", "1"}], "]"}]}], "\n",
                    "\t\t\t\t", "}"}]}], "\n", "\t\t\t", "]"}], ")"}]}], "*", 
              "\n", "\t\t", 
              RowBox[{"afltZbif", "[", 
               RowBox[{
                RowBox[{"\[CapitalDelta]to\[Alpha]", "[", 
                 RowBox[{
                  RowBox[{"\[CapitalDelta]s", "[", 
                   RowBox[{"[", 
                    RowBox[{"nExt", "-", "1"}], "]"}], "]"}], ",", "b"}], 
                 "]"}], ",", 
                RowBox[{"Last", "[", "Ps", "]"}], ",", 
                RowBox[{"Last", "[", "\[Lambda]s", "]"}], ",", "Phat", ",", 
                "null", ",", "b"}], "]"}]}]}], "\n", "\t", "]"}], "/@", " ", 
           "\n", "\t\t", 
           RowBox[{"Flatten", "[", "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{
             RowBox[{"Outer", "[", "\n", "\t\t\t\t", 
              RowBox[{"List", ",", "\n", "\t\t\t\t", 
               RowBox[{"Sequence", "@@", " ", 
                RowBox[{"(", 
                 RowBox[{"partitionPairs", "/@", " ", "ks"}], ")"}]}], ",", 
               "\n", "\t\t\t\t", "1"}], "\[IndentingNewLine]", "\t\t\t", 
              "]"}], ",", "\n", "\t\t\t", 
             RowBox[{"nExt", "-", "4"}]}], "\n", "\t\t", "]"}]}], "\n", 
          "]"}]}]}]}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.659040423227282*^9, 3.659040615662979*^9}, {
   3.659040659183972*^9, 3.659040700591963*^9}, {3.6590407932671423`*^9, 
   3.6590408231382113`*^9}, {3.659040896143359*^9, 3.659040896406109*^9}, {
   3.659040994011829*^9, 3.659041110787793*^9}, {3.65904114442208*^9, 
   3.659041150310616*^9}, {3.659042256228175*^9, 3.659042259282604*^9}, {
   3.659042330150413*^9, 3.6590423487091293`*^9}, {3.659042545546447*^9, 
   3.65904259141416*^9}, {3.659042648869485*^9, 3.6590426517639933`*^9}, {
   3.65904330566851*^9, 3.6590433171241283`*^9}, {3.6590440715819597`*^9, 
   3.659044222296493*^9}, {3.6590444219966917`*^9, 3.6590445673308*^9}, {
   3.6590448103131657`*^9, 3.659045012485787*^9}, {3.659045277319817*^9, 
   3.659045358214986*^9}, {3.659045401412168*^9, 3.659045567313139*^9}, {
   3.659045613451571*^9, 3.659045711341198*^9}, 3.659221378719966*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["end version", "Subsubsection",
 CellChangeTimes->{{3.659277449673381*^9, 3.6592774528570433`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"afltZk4pt", "[", 
     RowBox[{"k_", ",", 
      RowBox[{"{", 
       RowBox[{"P_", ",", "Phat_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Alpha]2_", ",", "\[Alpha]3_"}], "}"}], ",", 
      RowBox[{"{", "P1_", "}"}], ",", "b_"}], "]"}], ":=", "\n", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", "\n", "\t", 
       RowBox[{
        RowBox[{"null", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", "}"}]}], "}"}]}], ",", "\n", "\t", 
        RowBox[{"Q", "=", 
         RowBox[{"b", "+", 
          RowBox[{"1", "/", "b"}]}]}]}], "\n", "}"}], ",", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"k", "\[Equal]", "0"}], ",", "\n", "\t", "1", ",", "\n", "\t", 
        RowBox[{"Total", "[", "\n", "\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"afltZvec", "[", 
              RowBox[{"P1", ",", "#", ",", "b"}], "]"}], "*", "\n", "\t\t", 
             RowBox[{"afltZbif", "[", 
              RowBox[{
              "\[Alpha]2", ",", "P", ",", "null", ",", "P1", ",", "#", ",", 
               "b"}], "]"}], "*", "\n", "\t\t", 
             RowBox[{"afltZbif", "[", 
              RowBox[{
              "\[Alpha]3", ",", "P1", ",", "#", ",", "Phat", ",", "null", ",",
                "b"}], "]"}]}], ")"}], "&"}], "/@", " ", 
          RowBox[{"partitionPairs", "[", "k", "]"}]}], "\n", "\t", "]"}]}], 
       "\n", "]"}]}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"afltZk", "[", 
    RowBox[{"ks_", ",", 
     RowBox[{"{", 
      RowBox[{"P_", ",", "Phat_"}], "}"}], ",", "\[Alpha]Exts_", ",", 
     "Pints_", ",", "b_"}], "]"}], ":=", "\n", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t", 
      RowBox[{
       RowBox[{"nExt", " ", "=", " ", 
        RowBox[{"2", "+", " ", 
         RowBox[{"Length", "[", "\[Alpha]Exts", "]"}]}]}], ",", "\n", "\t", 
       RowBox[{"null", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "}"}]}], "}"}]}], ",", "\n", "\t", 
       RowBox[{"Q", "=", 
        RowBox[{"b", "+", 
         RowBox[{"1", "/", "b"}]}]}]}], "\n", "}"}], ",", "\n", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Total", "[", "ks", "]"}], "\[Equal]", "0"}], ",", "\n", "\t",
        "1", ",", "\n", "\t", 
       RowBox[{"Total", "[", "\n", "\t", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"\[Lambda]s", ",", "\n", "\t\t", 
           RowBox[{
            RowBox[{"Times", "@@", 
             RowBox[{"(", "\n", "\t\t\t", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"afltZvec", "[", 
                  RowBox[{"#1", ",", "#2", ",", "b"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Pints", ",", "\[Lambda]s"}], "}"}]}], "]"}], "\n", 
              "\t\t", ")"}]}], "*", "\n", "\t\t", 
            RowBox[{"afltZbif", "[", 
             RowBox[{
              RowBox[{"First", "@", "\[Alpha]Exts"}], ",", "P", ",", "null", 
              ",", 
              RowBox[{"First", "@", "Pints"}], ",", 
              RowBox[{"First", "@", "\[Lambda]s"}], ",", "b"}], "]"}], "*", 
            "\n", "\t\t", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", "\n", "\t\t\t", 
              RowBox[{"MapThread", "[", "\n", "\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"afltZbif", "[", 
                  RowBox[{"#1", ",", 
                   RowBox[{"First", "[", "#2", "]"}], ",", 
                   RowBox[{"First", "[", "#3", "]"}], ",", 
                   RowBox[{"Last", "[", "#2", "]"}], ",", 
                   RowBox[{"Last", "[", "#3", "]"}], ",", "b"}], "]"}], "&"}],
                 ",", "\n", "\t\t\t\t", 
                RowBox[{"{", "\n", "\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"Drop", "[", 
                   RowBox[{
                    RowBox[{"Drop", "[", 
                    RowBox[{"\[Alpha]Exts", ",", "1"}], "]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}], ",", "\n", "\t\t\t\t\t", 
                  RowBox[{"Partition", "[", 
                   RowBox[{"Pints", ",", "2", ",", "1"}], "]"}], ",", "\n", 
                  "\t\t\t\t\t", 
                  RowBox[{"Partition", "[", 
                   RowBox[{"\[Lambda]s", ",", "2", ",", "1"}], "]"}]}], "\n", 
                 "\t\t\t\t", "}"}]}], "\n", "\t\t\t", "]"}], ")"}]}], "*", 
            "\n", "\t\t", 
            RowBox[{"afltZbif", "[", 
             RowBox[{
              RowBox[{"Last", "@", "\[Alpha]Exts"}], ",", 
              RowBox[{"Last", "[", "Pints", "]"}], ",", 
              RowBox[{"Last", "[", "\[Lambda]s", "]"}], ",", "Phat", ",", 
              "null", ",", "b"}], "]"}]}]}], "\n", "\t", "]"}], "/@", " ", 
         "\n", "\t\t", 
         RowBox[{"Flatten", "[", "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{
           RowBox[{"Outer", "[", "\n", "\t\t\t\t", 
            RowBox[{"List", ",", "\n", "\t\t\t\t", 
             RowBox[{"Sequence", "@@", " ", 
              RowBox[{"(", 
               RowBox[{"partitionPairs", "/@", " ", "ks"}], ")"}]}], ",", 
             "\n", "\t\t\t\t", "1"}], "\[IndentingNewLine]", "\t\t\t", "]"}], 
           ",", "\n", "\t\t\t", 
           RowBox[{"nExt", "-", "4"}]}], "\n", "\t\t", "]"}]}], "\n", "]"}]}],
       "]"}]}], "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.659040423227282*^9, 3.659040615662979*^9}, {
   3.659040659183972*^9, 3.659040700591963*^9}, {3.6590407932671423`*^9, 
   3.6590408231382113`*^9}, {3.659040896143359*^9, 3.659040896406109*^9}, {
   3.659040994011829*^9, 3.659041110787793*^9}, {3.65904114442208*^9, 
   3.659041150310616*^9}, {3.659042256228175*^9, 3.659042259282604*^9}, {
   3.659042330150413*^9, 3.6590423487091293`*^9}, {3.659042545546447*^9, 
   3.65904259141416*^9}, {3.659042648869485*^9, 3.6590426517639933`*^9}, {
   3.65904330566851*^9, 3.6590433171241283`*^9}, {3.6590440715819597`*^9, 
   3.659044222296493*^9}, {3.6590444219966917`*^9, 3.6590445673308*^9}, {
   3.6590448103131657`*^9, 3.659045012485787*^9}, {3.659045277319817*^9, 
   3.659045358214986*^9}, {3.659045401412168*^9, 3.659045567313139*^9}, {
   3.659045613451571*^9, 3.659045711341198*^9}, 3.659221378719966*^9, {
   3.659277477619567*^9, 3.659277751883081*^9}, 3.659282110353663*^9, {
   3.659282170383542*^9, 3.659282186020587*^9}, {3.659282258226289*^9, 
   3.659282259348666*^9}, {3.659282536943713*^9, 3.659282537426158*^9}, {
   3.659282814998361*^9, 3.65928281515513*^9}, {3.659283097834111*^9, 
   3.659283105022773*^9}, {3.659283183425153*^9, 3.659283198483436*^9}, {
   3.659283280298962*^9, 3.6592833210130453`*^9}, 3.659283481560938*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["test", "Subsubsection",
 CellChangeTimes->{{3.6592811036677027`*^9, 3.6592811042202253`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Partition", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Flatten", "[", "\[IndentingNewLine]", "\t\t\t", 
     RowBox[{
      RowBox[{"Outer", "[", "\n", "\t\t\t\t", 
       RowBox[{"List", ",", "\n", "\t\t\t\t", 
        RowBox[{"Sequence", "@@", " ", 
         RowBox[{"(", 
          RowBox[{"partitionPairs", "/@", " ", 
           RowBox[{"{", "1", "}"}]}], ")"}]}], ",", "\n", "\t\t\t\t", "1"}], 
       "\[IndentingNewLine]", "\t\t\t", "]"}], ",", "\n", "\t\t\t", "1"}], 
     "\n", "\t\t", "]"}], ",", "\[IndentingNewLine]", "2", ",", "1"}], "]"}], 
  "//", "First"}]], "Input",
 CellChangeTimes->{{3.659282463412735*^9, 3.659282522870532*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "1", "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.659282467631287*^9, 3.659282523594379*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"afltZk4pt", "[", "\[IndentingNewLine]", 
  RowBox[{"1", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"P", ",", "Phat"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]rs", "[", 
      RowBox[{"#", ",", "b"}], "]"}], "&"}], "/@", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", "2"}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "Q"}], "/", "2"}], "}"}], ",", "\[IndentingNewLine]", "b"}],
   "]"}]], "Input",
 CellChangeTimes->{{3.6592823681700697`*^9, 3.659282376516695*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["3", 
       RowBox[{"2", " ", "b"}]], "+", "b", "-", "Phat", "-", 
      FractionBox["Q", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["3", 
       RowBox[{"2", " ", "b"}]], "+", "b", "+", "Phat", "-", 
      FractionBox["Q", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"2", " ", "b"}]], "-", "P", "+", 
      FractionBox["Q", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"2", " ", "b"}]], "+", "P", "+", 
      FractionBox["Q", "2"]}], ")"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "b"], "+", "b", "-", "Q"}], ")"}], " ", "Q"}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"2", " ", "b"}]], "-", "P", "-", 
      FractionBox["Q", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"2", " ", "b"}]], "+", "P", "-", 
      FractionBox["Q", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["3", 
       RowBox[{"2", " ", "b"}]], "+", "b", "-", "Phat", "+", 
      FractionBox["Q", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["3", 
       RowBox[{"2", " ", "b"}]], "+", "b", "+", "Phat", "+", 
      FractionBox["Q", "2"]}], ")"}]}], 
   RowBox[{"Q", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "b"], "+", "b", "+", "Q"}], ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.6592823690785837`*^9, 3.659282377326894*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"afltZk", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"P", ",", "Phat"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Alpha]rs", "[", 
      RowBox[{"#", ",", "b"}], "]"}], "&"}], "/@", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", "2"}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "0", "}"}], "-", 
    RowBox[{"Q", "/", "2"}]}], ",", "\[IndentingNewLine]", "b"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.659281819046019*^9, 3.6592818787266617`*^9}, {
  3.659282005574239*^9, 3.659282020049388*^9}, {3.659282274817833*^9, 
  3.659282297205348*^9}, {3.659282843178273*^9, 3.6592828432907248`*^9}, {
  3.6592829902386703`*^9, 3.659283061597509*^9}, {3.6592831149348392`*^9, 
  3.659283115766285*^9}, {3.659283149955269*^9, 3.659283150124877*^9}, {
  3.659283346357437*^9, 3.65928335760728*^9}}],

Cell[BoxData["4"], "Print",
 CellChangeTimes->{
  3.659282197979904*^9, 3.6592822977525797`*^9, 3.659282391011998*^9, 
   3.6592825454497433`*^9, {3.659282839410204*^9, 3.6592828439654703`*^9}, 
   3.6592830060161877`*^9, {3.659283052477105*^9, 3.659283062009158*^9}, 
   3.6592831166067257`*^9, 3.659283150814189*^9, {3.659283190279141*^9, 
   3.659283203218955*^9}, {3.65928334010879*^9, 3.659283358210609*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["3", 
       RowBox[{"2", " ", "b"}]], "+", "b", "-", "Phat", "-", 
      FractionBox["Q", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["3", 
       RowBox[{"2", " ", "b"}]], "+", "b", "+", "Phat", "-", 
      FractionBox["Q", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"2", " ", "b"}]], "-", "P", "+", 
      FractionBox["Q", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"2", " ", "b"}]], "+", "P", "+", 
      FractionBox["Q", "2"]}], ")"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "b"], "+", "b", "-", "Q"}], ")"}], " ", "Q"}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"2", " ", "b"}]], "-", "P", "-", 
      FractionBox["Q", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"2", " ", "b"}]], "+", "P", "-", 
      FractionBox["Q", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["3", 
       RowBox[{"2", " ", "b"}]], "+", "b", "-", "Phat", "+", 
      FractionBox["Q", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["3", 
       RowBox[{"2", " ", "b"}]], "+", "b", "+", "Phat", "+", 
      FractionBox["Q", "2"]}], ")"}]}], 
   RowBox[{"Q", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "b"], "+", "b", "+", "Q"}], ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.65928182329543*^9, {3.6592818636864223`*^9, 3.6592818796657553`*^9}, {
   3.6592820123945723`*^9, 3.659282021253468*^9}, 3.6592821980461397`*^9, 
   3.65928229781336*^9, 3.659282391033374*^9, 3.659282545676086*^9, {
   3.659282839470039*^9, 3.659282844040738*^9}, 3.6592830068693657`*^9, {
   3.659283053344535*^9, 3.6592830628682547`*^9}, 3.659283116782227*^9, 
   3.659283150959889*^9, {3.659283190619254*^9, 3.6592832033581667`*^9}, {
   3.659283340116549*^9, 3.659283358220196*^9}}]
}, Open  ]],

Cell["\<\
Verify afltZk agrees with afltZk4pt on single-channel 4-pt energy block\
\>", "Text",
 CellChangeTimes->{{3.659045804471595*^9, 3.659045810854546*^9}, {
  3.659281112915745*^9, 3.65928112387322*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Simplify", "@", "  ", 
     RowBox[{"afltZk4pt", "[", 
      RowBox[{"k", ",", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"1", "/", "16"}], ",", "4"}], "]"}], ",", 
       RowBox[{"1", "/", "2"}], ",", "b"}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"k", ",", "0", ",", "5"}], "}"}]}], "\[IndentingNewLine]", "]"}],
   "-", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Simplify", "@", "  ", 
     RowBox[{"afltZk", "[", 
      RowBox[{
       RowBox[{"{", "k", "}"}], ",", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"1", "/", "16"}], ",", "4"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", "/", "2"}], "}"}], ",", "b"}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"k", ",", "0", ",", "5"}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.659045822297772*^9, 3.659045848781698*^9}, {
  3.659045895717658*^9, 3.659045899763401*^9}, {3.65904610236311*^9, 
  3.659046118193903*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.659045865014544*^9, 3.6590459091330233`*^9, {3.6590461137290497`*^9, 
   3.6590461371160583`*^9}, 3.659281093995213*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["end test", "Subsubsection",
 CellChangeTimes->{{3.659281106850955*^9, 3.659281107964925*^9}}],

Cell["wrappers for above", "Text",
 CellChangeTimes->{{3.6592812596488037`*^9, 3.659281264148909*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"afltZk\[Alpha]", "[", 
     RowBox[{"ks_", ",", "\[Alpha]Exts_", ",", "\[Alpha]ints_", ",", "b_"}], 
     "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"afltZk", "[", "\n", "\t", 
     RowBox[{"ks", ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Alpha]toP", "[", 
         RowBox[{
          RowBox[{"First", "@", "\[Alpha]Exts"}], ",", "b"}], "]"}], ",", " ", 
        RowBox[{"\[Alpha]toP", "[", 
         RowBox[{
          RowBox[{"Last", "@", "\[Alpha]Exts"}], ",", "b"}], "]"}]}], "}"}], 
      ",", "\n", "\t", 
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{"Drop", "[", 
         RowBox[{"\[Alpha]Exts", ",", "1"}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Alpha]toP", "[", 
         RowBox[{"#", ",", "b"}], "]"}], "&"}], "/@", " ", "\[Alpha]ints"}], 
      ",", "\n", "\t", "b"}], "\n", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"afltZkDegen", "[", 
    RowBox[{"ks_", ",", "rsExts_", ",", "rsInts_", ",", "b_"}], "]"}], ":=", 
   "\n", 
   RowBox[{"afltZk\[Alpha]", "[", "\n", "\t", 
    RowBox[{"ks", ",", "\n", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Alpha]rs", "[", 
        RowBox[{"#", ",", "b"}], "]"}], "&"}], "/@", " ", "rsExts"}], ",", 
     "\n", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Alpha]rs", "[", 
        RowBox[{"#", ",", "b"}], "]"}], "&"}], "/@", " ", "rsInts"}], ",", 
     "\n", "\t", "b"}], "\n", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.659281277773698*^9, 3.659281514845295*^9}, {
  3.6592828215560923`*^9, 3.6592828231307573`*^9}, {3.659283328357541*^9, 
  3.659283329741034*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"q\[Delta]Product", "[", 
    RowBox[{"\[CapitalDelta]s_", ",", "\[CapitalDelta]ints_"}], "]"}], ":=", 
   "\n", 
   RowBox[{"MapThread", "[", "\n", "\t", 
    RowBox[{"Power", ",", "\n", "\t", 
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"Array", "[", 
        RowBox[{"q", ",", 
         RowBox[{"Length", "[", "\[CapitalDelta]ints", "]"}]}], "]"}], ",", 
       "\n", "\t\t", 
       RowBox[{"\[CapitalDelta]sto\[Delta]s", "[", 
        RowBox[{"\[CapitalDelta]s", ",", "\[CapitalDelta]ints"}], "]"}]}], 
      "\n", "}"}]}], "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.659224522176738*^9, 3.659224611952073*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test: Ising 4-pt", "Section",
 CellChangeTimes->{{3.659043493294964*^9, 3.6590434973097067`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"energy4block", "[", "z_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "z", "+", 
      RowBox[{"z", "^", "2"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"z", 
      RowBox[{"(", 
       RowBox[{"1", "-", "z"}], ")"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"spin4block1", "[", "z_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", "z"}], "]"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sqrt", "[", "2", "]"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"z", 
         RowBox[{"(", 
          RowBox[{"1", "-", "z"}], ")"}]}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"1", "/", "8"}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"spin4block2", "[", "z_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", "z"}], "]"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sqrt", "[", "2", "]"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"z", 
         RowBox[{"(", 
          RowBox[{"1", "-", "z"}], ")"}]}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"1", "/", "8"}], ")"}]}]}], ")"}]}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.659042409682672*^9, 3.659042478302619*^9}, {
  3.659148977730173*^9, 3.659148990064089*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "/", "2"}], "==", 
    RowBox[{"1", "+", 
     RowBox[{"6", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "+", 
         RowBox[{"1", "/", "b"}]}], ")"}], "^", "2"}]}]}]}], ",", "b"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.659042783035233*^9, 3.659042808268643*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"b", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]"}], 
       SqrtBox["3"]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"b", "\[Rule]", 
     FractionBox[
      RowBox[{"2", " ", "\[ImaginaryI]"}], 
      SqrtBox["3"]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"b", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SqrtBox["3"]}], "2"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"b", "\[Rule]", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", 
       SqrtBox["3"]}], "2"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6590428000841303`*^9, 3.659042816472322*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"energy\[Alpha]", "=", " ", 
   RowBox[{"Simplify", "[", "\n", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"Q", "+", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"Q", "^", "2"}], "-", 
          RowBox[{"4", 
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}]}]}], "]"}]}], ")"}]}], "/.", 
     RowBox[{"Q", "\[Rule]", 
      RowBox[{"b", "+", 
       RowBox[{"1", "/", "b"}]}]}]}], "\n", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spin\[Alpha]", "=", " ", 
   RowBox[{"Simplify", "[", "\n", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"Q", "+", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"Q", "^", "2"}], "-", 
          RowBox[{"4", 
           RowBox[{"(", 
            RowBox[{"1", "/", "16"}], ")"}]}]}], "]"}]}], ")"}]}], "/.", 
     RowBox[{"Q", "\[Rule]", 
      RowBox[{"b", "+", 
       RowBox[{"1", "/", "b"}]}]}]}], "\n", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.659043455455166*^9, 3.659043469590735*^9}, {
  3.6591433657545967`*^9, 3.659143411840807*^9}}],

Cell[CellGroupData[{

Cell["4-energy block", "Subsection",
 CellChangeTimes->{{3.65904380028502*^9, 3.659043822856022*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"energy4", "=", 
  RowBox[{"Factor", "[", "\[IndentingNewLine]", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Simplify", "@", " ", 
      RowBox[{"afltZk4pt", "[", 
       RowBox[{"k", ",", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"1", "/", "2"}], ",", "4"}], "]"}], ",", "0", ",", "b"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "5"}], "}"}]}], "\[IndentingNewLine]", 
    "]"}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6590418623243856`*^9, 3.659041875683198*^9}, {
   3.659042301694963*^9, 3.6590423036454773`*^9}, {3.659042367350667*^9, 
   3.6590423972416363`*^9}, {3.659042831349432*^9, 3.659042869681468*^9}, {
   3.659043324818755*^9, 3.659043338694062*^9}, {3.659043886477635*^9, 
   3.659043894110242*^9}, 3.659044084718845*^9, {3.6590457331197968`*^9, 
   3.659045744091853*^9}, {3.6590457744644623`*^9, 3.659045782906363*^9}, {
   3.6590504916203527`*^9, 3.659050499772154*^9}, {3.6590508259670267`*^9, 
   3.659050841022197*^9}, {3.659143334877612*^9, 3.659143335963904*^9}, {
   3.659143439207346*^9, 3.6591434458389187`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{"-", "1"}], ",", 
   FractionBox[
    SuperscriptBox["b", "2"], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"3", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["b", "2"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["b", "2"]}]}], ")"}]}]], ",", "0", ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["b", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"4", "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["b", "2"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"3", "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["b", "2"]}]}], ")"}]}], 
     RowBox[{"24", " ", 
      RowBox[{"(", 
       RowBox[{"3", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["b", "2"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"5", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["b", "2"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["b", "2"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", 
        RowBox[{"5", " ", 
         SuperscriptBox["b", "2"]}]}], ")"}]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["b", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"4", "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["b", "2"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"3", "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["b", "2"]}]}], ")"}]}], 
     RowBox[{"24", " ", 
      RowBox[{"(", 
       RowBox[{"3", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["b", "2"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"5", "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["b", "2"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["b", "2"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", 
        RowBox[{"5", " ", 
         SuperscriptBox["b", "2"]}]}], ")"}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.659041876870343*^9, {3.659041927278965*^9, 3.6590419553459997`*^9}, 
   3.659042026444001*^9, {3.659042281080999*^9, 3.65904230413614*^9}, {
   3.659042338327586*^9, 3.659042397667942*^9}, 3.659042596873116*^9, {
   3.659042862578022*^9, 3.6590428805851927`*^9}, {3.659043334161962*^9, 
   3.659043348501278*^9}, 3.659043903526889*^9, 3.659045754718326*^9, 
   3.6590457919713373`*^9, {3.65905048439153*^9, 3.659050496816407*^9}, 
   3.659050769373201*^9, 3.659050896640731*^9, 3.659143398793995*^9, {
   3.65914344357626*^9, 3.659143454751392*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"energy4block", "[", "q", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"q", ",", "0", ",", "10"}], "}"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{3.6590429336072702`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"q", "-", 
   RowBox[{"2", " ", 
    SuperscriptBox["q", "2"]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox["q", "3"]}], "-", 
   SuperscriptBox["q", "4"], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "q", "]"}], "11"],
    SeriesData[$CellContext`q, 0, {}, 1, 11, 1],
    Editable->False]}],
  SeriesData[$CellContext`q, 0, {1, -2, 2, -1}, 1, 11, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.659042934393539*^9, 3.6590507696793337`*^9, 
  3.659051035589336*^9, 3.659143398859776*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "2"}], "energy\[Alpha]", 
    RowBox[{"(", 
     RowBox[{"b", "+", 
      RowBox[{"1", "/", "b"}], "-", "energy\[Alpha]"}], ")"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{"b", "\[Rule]", 
     FractionBox[
      RowBox[{"2", " ", "\[ImaginaryI]"}], 
      SqrtBox["3"]]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "@", 
  RowBox[{"Series", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "q"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "energy\[Alpha]", 
        RowBox[{"(", 
         RowBox[{"b", "+", 
          RowBox[{"1", "/", "b"}], "-", "energy\[Alpha]"}], ")"}]}], ")"}]}], 
     
     RowBox[{"energy4block", "[", "q", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"q", ",", "0", ",", "10"}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Factor", "@", 
  RowBox[{"(", 
   RowBox[{"energy4", "/.", 
    RowBox[{"{", 
     RowBox[{"b", "\[Rule]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]"}], 
       SqrtBox["3"]]}], "}"}]}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"Factor", "@", 
  RowBox[{"(", 
   RowBox[{"energy4", "/.", 
    RowBox[{"{", 
     RowBox[{"b", "\[Rule]", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SqrtBox["3"]}], "2"]}], "}"}]}], ")"}]}]}], "Input",
 CellChangeTimes->{
  3.659042976452055*^9, {3.65904326677702*^9, 3.659043286411971*^9}, 
   3.659043846446518*^9, {3.659050486245599*^9, 3.659050486413938*^9}, 
   3.659051029350666*^9, {3.659143421832343*^9, 3.659143450526135*^9}, {
   3.659144280759046*^9, 3.659144301918579*^9}}],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellChangeTimes->{
  3.659042977122263*^9, {3.659043269111005*^9, 3.659043287722674*^9}, 
   3.6590504874579477`*^9, 3.65905076982889*^9, 3.6590510375039454`*^9, {
   3.659143422769362*^9, 3.659143430017357*^9}, 3.659143461894622*^9, {
   3.659144287005393*^9, 3.6591443025095863`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"q", "-", 
   SuperscriptBox["q", "2"], "+", 
   SuperscriptBox["q", "3"], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "q", "]"}], "11"],
    SeriesData[$CellContext`q, 0, {}, 1, 11, 1],
    Editable->False]}],
  SeriesData[$CellContext`q, 0, {1, -1, 1}, 1, 11, 1],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.659042977122263*^9, {3.659043269111005*^9, 3.659043287722674*^9}, 
   3.6590504874579477`*^9, 3.65905076982889*^9, 3.6590510375039454`*^9, {
   3.659143422769362*^9, 3.659143430017357*^9}, 3.659143461894622*^9, {
   3.659144287005393*^9, 3.659144302518001*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{"-", "1"}], ",", "1", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.659042977122263*^9, {3.659043269111005*^9, 3.659043287722674*^9}, 
   3.6590504874579477`*^9, 3.65905076982889*^9, 3.6590510375039454`*^9, {
   3.659143422769362*^9, 3.659143430017357*^9}, 3.659143461894622*^9, {
   3.659144287005393*^9, 3.659144302524353*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{"-", "1"}], ",", "1", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.659042977122263*^9, {3.659043269111005*^9, 3.659043287722674*^9}, 
   3.6590504874579477`*^9, 3.65905076982889*^9, 3.6590510375039454`*^9, {
   3.659143422769362*^9, 3.659143430017357*^9}, 3.659143461894622*^9, {
   3.659144287005393*^9, 3.659144302530703*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "@", 
   RowBox[{"Series", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "q"}], ")"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "q"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "energy\[Alpha]", 
         RowBox[{"(", 
          RowBox[{"b", "+", 
           RowBox[{"1", "/", "b"}], "-", "energy\[Alpha]"}], ")"}]}], ")"}]}],
       "*", 
      RowBox[{"energy4block", "[", "q", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"q", ",", "0", ",", "10"}], "}"}]}], "\[IndentingNewLine]", 
    "]"}]}], "/.", 
  RowBox[{"{", 
   RowBox[{"b", "\[Rule]", 
    FractionBox[
     RowBox[{"2", " ", "\[ImaginaryI]"}], 
     SqrtBox["3"]]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6590424806848383`*^9, 3.659042490789439*^9}, {
   3.659042660090846*^9, 3.6590426623229427`*^9}, {3.659042694441905*^9, 
   3.6590427082481947`*^9}, {3.6590427727278347`*^9, 3.659042774608089*^9}, {
   3.659043851743772*^9, 3.6590438528541*^9}, 3.659043963091423*^9, {
   3.659050455086493*^9, 3.6590504831898527`*^9}, 3.6590510661862993`*^9, {
   3.659144277879727*^9, 3.659144278638253*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "-", "q", "+", 
   SuperscriptBox["q", "2"], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "q", "]"}], "11"],
    SeriesData[$CellContext`q, 0, {}, 0, 11, 1],
    Editable->False]}],
  SeriesData[$CellContext`q, 0, {1, -1, 1}, 0, 11, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.659050456039666*^9, 3.65905046717239*^9}, {
   3.6590510630199757`*^9, 3.659051067027145*^9}, 3.6591434769302692`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
cross-ratios vs. explicit polys? ratios = U(1) charge so weight = 0?\
\>", "Subsection",
 CellChangeTimes->{{3.659143062604879*^9, 3.659143098714983*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"varphi4", "[", "p_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"z", "[", "1", "]"}], "-", 
         RowBox[{"z", "[", "2", "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"z", "[", "3", "]"}], "-", 
         RowBox[{"z", "[", "4", "]"}]}], ")"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"p", "-", "2"}], ")"}]}], "*", "\n", "\t", 
    RowBox[{"Hypergeometric2F1", "[", 
     RowBox[{
      RowBox[{"1", "-", 
       RowBox[{"p", "/", "3"}]}], ",", 
      RowBox[{"2", "-", "p"}], ",", 
      RowBox[{"2", "-", 
       RowBox[{"2", 
        RowBox[{"p", "/", "3"}]}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"z", "[", "3", "]"}], "-", 
           RowBox[{"z", "[", "2", "]"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"z", "[", "1", "]"}], "-", 
           RowBox[{"z", "[", "4", "]"}]}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"z", "[", "1", "]"}], "-", 
           RowBox[{"z", "[", "2", "]"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"z", "[", "3", "]"}], "-", 
           RowBox[{"z", "[", "4", "]"}]}], ")"}]}], ")"}]}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"varphiX", "[", "p_", "]"}], ":=", 
   RowBox[{"Hypergeometric2F1", "[", 
    RowBox[{
     RowBox[{"1", "-", 
      RowBox[{"p", "/", "3"}]}], ",", 
     RowBox[{"2", "-", "p"}], ",", 
     RowBox[{"2", "-", 
      RowBox[{"2", 
       RowBox[{"p", "/", "3"}]}]}], ",", "x"}], "]"}]}], ";"}]}], "Code",
 InitializationCell->True,
 CellChangeTimes->{
  3.487773652584818*^9, {3.5175734632363777`*^9, 3.51757347312037*^9}, {
   3.65914310910863*^9, 3.659143117026259*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"varphiX", "[", "4", "]"}]], "Input",
 CellChangeTimes->{{3.659143139576832*^9, 3.6591431402408457`*^9}}],

Cell[BoxData[
 RowBox[{"1", "-", "x", "+", 
  SuperscriptBox["x", "2"]}]], "Output",
 CellChangeTimes->{3.659143140826432*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Coefficient", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"varphi4", "[", "4", "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"z", "[", "2", "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"z", "[", "1", "]"}], "\[Rule]", "1"}]}], "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z", "[", "4", "]"}], "^", "2"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.659143178276907*^9, 3.659143215913787*^9}}],

Cell[BoxData[
 RowBox[{"1", "-", 
  RowBox[{"z", "[", "3", "]"}], "+", 
  SuperscriptBox[
   RowBox[{"z", "[", "3", "]"}], "2"]}]], "Output",
 CellChangeTimes->{{3.659143187895247*^9, 3.659143216535799*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"energy4\[Chi]", "=", 
  RowBox[{"Factor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"1", "-", 
     RowBox[{"q", "[", "1", "]"}], "+", 
     RowBox[{
      RowBox[{"q", "[", "1", "]"}], "^", "2"}]}], "/.", 
    RowBox[{
     RowBox[{"q", "[", "i_", "]"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"\[Chi]", "[", 
       RowBox[{"i", "+", "1"}], "]"}], "/", 
      RowBox[{"\[Chi]", "[", 
       RowBox[{"i", "+", "2"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"energy4z", "=", 
  RowBox[{
   RowBox[{"Factor", "@", "energy4\[Chi]"}], "/.", 
   RowBox[{
    RowBox[{"\[Chi]", "[", "i_", "]"}], "\[RuleDelayed]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"z", "[", "i", "]"}], "-", 
       RowBox[{"z", "[", "1", "]"}]}], ")"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"z", "[", "3", "]"}], "-", 
        RowBox[{"z", "[", "4", "]"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"z", "[", "3", "]"}], "-", 
          RowBox[{"z", "[", "1", "]"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"z", "[", "i", "]"}], "-", 
          RowBox[{"z", "[", "4", "]"}]}], ")"}]}], ")"}]}]}]}]}]}]}], "Input",\

 CellChangeTimes->{{3.659143313190984*^9, 3.659143324762672*^9}, 
   3.659143501118115*^9, {3.659143590977881*^9, 3.659143630509947*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"\[Chi]", "[", "2", "]"}], "2"], "-", 
   RowBox[{
    RowBox[{"\[Chi]", "[", "2", "]"}], " ", 
    RowBox[{"\[Chi]", "[", "3", "]"}]}], "+", 
   SuperscriptBox[
    RowBox[{"\[Chi]", "[", "3", "]"}], "2"]}], 
  SuperscriptBox[
   RowBox[{"\[Chi]", "[", "3", "]"}], "2"]]], "Output",
 CellChangeTimes->{
  3.6591433268658667`*^9, 3.65914350181073*^9, {3.6591436114529057`*^9, 
   3.659143631359837*^9}}],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"z", "[", "1", "]"}]}], "+", 
      RowBox[{"z", "[", "2", "]"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"z", "[", "3", "]"}], "-", 
      RowBox[{"z", "[", "4", "]"}]}], ")"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"z", "[", "1", "]"}]}], "+", 
      RowBox[{"z", "[", "3", "]"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"z", "[", "2", "]"}], "-", 
      RowBox[{"z", "[", "4", "]"}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"z", "[", "1", "]"}]}], "+", 
       RowBox[{"z", "[", "2", "]"}]}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"z", "[", "3", "]"}], "-", 
       RowBox[{"z", "[", "4", "]"}]}], ")"}], "2"]}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"z", "[", "1", "]"}]}], "+", 
       RowBox[{"z", "[", "3", "]"}]}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"z", "[", "2", "]"}], "-", 
       RowBox[{"z", "[", "4", "]"}]}], ")"}], "2"]}]]}]], "Output",
 CellChangeTimes->{
  3.6591433268658667`*^9, 3.65914350181073*^9, {3.6591436114529057`*^9, 
   3.659143631369335*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Together", "[", "energy4z", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Numerator", "[", "%", "]"}], "-", 
  RowBox[{"varphi4", "[", "4", "]"}]}]}], "Input",
 CellChangeTimes->{{3.659143639871564*^9, 3.659143678420689*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"z", "[", "1", "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"z", "[", "2", "]"}], "2"]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"z", "[", "1", "]"}], "2"], " ", 
     RowBox[{"z", "[", "2", "]"}], " ", 
     RowBox[{"z", "[", "3", "]"}]}], "-", 
    RowBox[{
     RowBox[{"z", "[", "1", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"z", "[", "2", "]"}], "2"], " ", 
     RowBox[{"z", "[", "3", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"z", "[", "1", "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"z", "[", "3", "]"}], "2"]}], "-", 
    RowBox[{
     RowBox[{"z", "[", "1", "]"}], " ", 
     RowBox[{"z", "[", "2", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"z", "[", "3", "]"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"z", "[", "2", "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"z", "[", "3", "]"}], "2"]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"z", "[", "1", "]"}], "2"], " ", 
     RowBox[{"z", "[", "2", "]"}], " ", 
     RowBox[{"z", "[", "4", "]"}]}], "-", 
    RowBox[{
     RowBox[{"z", "[", "1", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"z", "[", "2", "]"}], "2"], " ", 
     RowBox[{"z", "[", "4", "]"}]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"z", "[", "1", "]"}], "2"], " ", 
     RowBox[{"z", "[", "3", "]"}], " ", 
     RowBox[{"z", "[", "4", "]"}]}], "+", 
    RowBox[{"6", " ", 
     RowBox[{"z", "[", "1", "]"}], " ", 
     RowBox[{"z", "[", "2", "]"}], " ", 
     RowBox[{"z", "[", "3", "]"}], " ", 
     RowBox[{"z", "[", "4", "]"}]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"z", "[", "2", "]"}], "2"], " ", 
     RowBox[{"z", "[", "3", "]"}], " ", 
     RowBox[{"z", "[", "4", "]"}]}], "-", 
    RowBox[{
     RowBox[{"z", "[", "1", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"z", "[", "3", "]"}], "2"], " ", 
     RowBox[{"z", "[", "4", "]"}]}], "-", 
    RowBox[{
     RowBox[{"z", "[", "2", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"z", "[", "3", "]"}], "2"], " ", 
     RowBox[{"z", "[", "4", "]"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"z", "[", "1", "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"z", "[", "4", "]"}], "2"]}], "-", 
    RowBox[{
     RowBox[{"z", "[", "1", "]"}], " ", 
     RowBox[{"z", "[", "2", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"z", "[", "4", "]"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"z", "[", "2", "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"z", "[", "4", "]"}], "2"]}], "-", 
    RowBox[{
     RowBox[{"z", "[", "1", "]"}], " ", 
     RowBox[{"z", "[", "3", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"z", "[", "4", "]"}], "2"]}], "-", 
    RowBox[{
     RowBox[{"z", "[", "2", "]"}], " ", 
     RowBox[{"z", "[", "3", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"z", "[", "4", "]"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"z", "[", "3", "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"z", "[", "4", "]"}], "2"]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"z", "[", "1", "]"}], "-", 
       RowBox[{"z", "[", "3", "]"}]}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"z", "[", "2", "]"}], "-", 
       RowBox[{"z", "[", "4", "]"}]}], ")"}], "2"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.6591436427404127`*^9, 3.659143678970312*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.6591436427404127`*^9, 3.659143678979157*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vandermonde", "[", "4", "]"}], "//", 
  "Expand"}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"z", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"z", "[", "3", "]"}], "\[Rule]", "1"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.659144034809214*^9, 3.659144049873258*^9}, {
  3.659144082857242*^9, 3.659144091279169*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "1", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "2", "]"}], "2"], " ", 
   RowBox[{"z", "[", "3", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "1", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "2", "]"}], "3"], " ", 
   RowBox[{"z", "[", "3", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "1", "]"}], "3"], " ", 
   RowBox[{"z", "[", "2", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "3", "]"}], "2"]}], "+", 
  RowBox[{
   RowBox[{"z", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "2", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "3", "]"}], "2"]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "1", "]"}], "2"], " ", 
   RowBox[{"z", "[", "2", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "3", "]"}], "3"]}], "-", 
  RowBox[{
   RowBox[{"z", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "3", "]"}], "3"]}], "-", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "1", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "2", "]"}], "2"], " ", 
   RowBox[{"z", "[", "4", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "1", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "2", "]"}], "3"], " ", 
   RowBox[{"z", "[", "4", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "1", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "3", "]"}], "2"], " ", 
   RowBox[{"z", "[", "4", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "2", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "3", "]"}], "2"], " ", 
   RowBox[{"z", "[", "4", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "1", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "3", "]"}], "3"], " ", 
   RowBox[{"z", "[", "4", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "3", "]"}], "3"], " ", 
   RowBox[{"z", "[", "4", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "1", "]"}], "3"], " ", 
   RowBox[{"z", "[", "2", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "4", "]"}], "2"]}], "-", 
  RowBox[{
   RowBox[{"z", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "2", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "4", "]"}], "2"]}], "-", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "1", "]"}], "3"], " ", 
   RowBox[{"z", "[", "3", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "4", "]"}], "2"]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "2", "]"}], "3"], " ", 
   RowBox[{"z", "[", "3", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "4", "]"}], "2"]}], "+", 
  RowBox[{
   RowBox[{"z", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "3", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "4", "]"}], "2"]}], "-", 
  RowBox[{
   RowBox[{"z", "[", "2", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "3", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "4", "]"}], "2"]}], "-", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "1", "]"}], "2"], " ", 
   RowBox[{"z", "[", "2", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "4", "]"}], "3"]}], "+", 
  RowBox[{
   RowBox[{"z", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "4", "]"}], "3"]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "1", "]"}], "2"], " ", 
   RowBox[{"z", "[", "3", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "4", "]"}], "3"]}], "-", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "2", "]"}], "2"], " ", 
   RowBox[{"z", "[", "3", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "4", "]"}], "3"]}], "-", 
  RowBox[{
   RowBox[{"z", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "3", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "4", "]"}], "3"]}], "+", 
  RowBox[{
   RowBox[{"z", "[", "2", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "3", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "4", "]"}], "3"]}]}]], "Output",
 CellChangeTimes->{{3.659144039822115*^9, 3.659144050274516*^9}, 
   3.659144091714621*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "2", "]"}], "2"], " ", 
   RowBox[{"z", "[", "4", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "2", "]"}], "3"], " ", 
   RowBox[{"z", "[", "4", "]"}]}], "-", 
  RowBox[{
   RowBox[{"z", "[", "2", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "4", "]"}], "2"]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "2", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "4", "]"}], "2"]}], "+", 
  RowBox[{
   RowBox[{"z", "[", "2", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "4", "]"}], "3"]}], "-", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "4", "]"}], "3"]}]}]], "Output",
 CellChangeTimes->{{3.659144039822115*^9, 3.659144050274516*^9}, 
   3.6591440917218103`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"varphi4", "[", "4", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "1", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "2", "]"}], "2"]}], "-", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "1", "]"}], "2"], " ", 
   RowBox[{"z", "[", "2", "]"}], " ", 
   RowBox[{"z", "[", "3", "]"}]}], "-", 
  RowBox[{
   RowBox[{"z", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "2", "]"}], "2"], " ", 
   RowBox[{"z", "[", "3", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "1", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "3", "]"}], "2"]}], "-", 
  RowBox[{
   RowBox[{"z", "[", "1", "]"}], " ", 
   RowBox[{"z", "[", "2", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "3", "]"}], "2"]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "3", "]"}], "2"]}], "-", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "1", "]"}], "2"], " ", 
   RowBox[{"z", "[", "2", "]"}], " ", 
   RowBox[{"z", "[", "4", "]"}]}], "-", 
  RowBox[{
   RowBox[{"z", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "2", "]"}], "2"], " ", 
   RowBox[{"z", "[", "4", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "1", "]"}], "2"], " ", 
   RowBox[{"z", "[", "3", "]"}], " ", 
   RowBox[{"z", "[", "4", "]"}]}], "+", 
  RowBox[{"6", " ", 
   RowBox[{"z", "[", "1", "]"}], " ", 
   RowBox[{"z", "[", "2", "]"}], " ", 
   RowBox[{"z", "[", "3", "]"}], " ", 
   RowBox[{"z", "[", "4", "]"}]}], "-", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "2", "]"}], "2"], " ", 
   RowBox[{"z", "[", "3", "]"}], " ", 
   RowBox[{"z", "[", "4", "]"}]}], "-", 
  RowBox[{
   RowBox[{"z", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "3", "]"}], "2"], " ", 
   RowBox[{"z", "[", "4", "]"}]}], "-", 
  RowBox[{
   RowBox[{"z", "[", "2", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "3", "]"}], "2"], " ", 
   RowBox[{"z", "[", "4", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "1", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "4", "]"}], "2"]}], "-", 
  RowBox[{
   RowBox[{"z", "[", "1", "]"}], " ", 
   RowBox[{"z", "[", "2", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "4", "]"}], "2"]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "4", "]"}], "2"]}], "-", 
  RowBox[{
   RowBox[{"z", "[", "1", "]"}], " ", 
   RowBox[{"z", "[", "3", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "4", "]"}], "2"]}], "-", 
  RowBox[{
   RowBox[{"z", "[", "2", "]"}], " ", 
   RowBox[{"z", "[", "3", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "4", "]"}], "2"]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"z", "[", "3", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"z", "[", "4", "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{3.659144018519947*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["4-spin correlator, both fusion channels", "Subsection",
 CellChangeTimes->{{3.6590437803828497`*^9, 3.659043790837967*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"testSpin41", "=", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Simplify", "@", " ", 
     RowBox[{"afltZk4pt", "[", 
      RowBox[{"k", ",", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"1", "/", "16"}], ",", "4"}], "]"}], ",", "0", ",", "b"}], 
      "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"k", ",", "0", ",", "5"}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"testSpin42", "=", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Simplify", "@", " ", 
     RowBox[{"afltZk4pt", "[", 
      RowBox[{"k", ",", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"1", "/", "16"}], ",", "4"}], "]"}], ",", 
       RowBox[{"1", "/", "2"}], ",", "b"}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"k", ",", "0", ",", "5"}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.6590433461429367`*^9, 3.659043368102521*^9}, {
  3.6590440870861397`*^9, 3.659044088374371*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{"-", 
    FractionBox["1", "8"]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{"7", "+", 
        RowBox[{"15", " ", 
         SuperscriptBox["b", "2"]}], "+", 
        RowBox[{"7", " ", 
         SuperscriptBox["b", "4"]}]}], ")"}]}], 
     RowBox[{"64", " ", 
      RowBox[{"(", 
       RowBox[{"6", "+", 
        RowBox[{"13", " ", 
         SuperscriptBox["b", "2"]}], "+", 
        RowBox[{"6", " ", 
         SuperscriptBox["b", "4"]}]}], ")"}]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"7", " ", 
      RowBox[{"(", 
       RowBox[{"15", "+", 
        RowBox[{"32", " ", 
         SuperscriptBox["b", "2"]}], "+", 
        RowBox[{"15", " ", 
         SuperscriptBox["b", "4"]}]}], ")"}]}], 
     RowBox[{"512", " ", 
      RowBox[{"(", 
       RowBox[{"6", "+", 
        RowBox[{"13", " ", 
         SuperscriptBox["b", "2"]}], "+", 
        RowBox[{"6", " ", 
         SuperscriptBox["b", "4"]}]}], ")"}]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"12075", "+", 
      RowBox[{"60719", " ", 
       SuperscriptBox["b", "2"]}], "+", 
      RowBox[{"98677", " ", 
       SuperscriptBox["b", "4"]}], "+", 
      RowBox[{"60719", " ", 
       SuperscriptBox["b", "6"]}], "+", 
      RowBox[{"12075", " ", 
       SuperscriptBox["b", "8"]}]}], 
     RowBox[{"8192", " ", 
      RowBox[{"(", 
       RowBox[{"60", "+", 
        RowBox[{"304", " ", 
         SuperscriptBox["b", "2"]}], "+", 
        RowBox[{"497", " ", 
         SuperscriptBox["b", "4"]}], "+", 
        RowBox[{"304", " ", 
         SuperscriptBox["b", "6"]}], "+", 
        RowBox[{"60", " ", 
         SuperscriptBox["b", "8"]}]}], ")"}]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{"24955", "+", 
        RowBox[{"125417", " ", 
         SuperscriptBox["b", "2"]}], "+", 
        RowBox[{"203711", " ", 
         SuperscriptBox["b", "4"]}], "+", 
        RowBox[{"125417", " ", 
         SuperscriptBox["b", "6"]}], "+", 
        RowBox[{"24955", " ", 
         SuperscriptBox["b", "8"]}]}], ")"}]}], 
     RowBox[{"65536", " ", 
      RowBox[{"(", 
       RowBox[{"60", "+", 
        RowBox[{"304", " ", 
         SuperscriptBox["b", "2"]}], "+", 
        RowBox[{"497", " ", 
         SuperscriptBox["b", "4"]}], "+", 
        RowBox[{"304", " ", 
         SuperscriptBox["b", "6"]}], "+", 
        RowBox[{"60", " ", 
         SuperscriptBox["b", "8"]}]}], ")"}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.659043380937212*^9, 3.659045966289419*^9, 
  3.659148518063529*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   FractionBox["1", "8"], ",", 
   FractionBox["7", "128"], ",", 
   FractionBox["33", "1024"], ",", 
   FractionBox[
    RowBox[{"256680", "+", 
     RowBox[{"1302777", " ", 
      SuperscriptBox["b", "2"]}], "+", 
     RowBox[{"2162215", " ", 
      SuperscriptBox["b", "4"]}], "+", 
     RowBox[{"1302777", " ", 
      SuperscriptBox["b", "6"]}], "+", 
     RowBox[{"256680", " ", 
      SuperscriptBox["b", "8"]}]}], 
    RowBox[{"32768", " ", 
     RowBox[{"(", 
      RowBox[{"360", "+", 
       RowBox[{"1827", " ", 
        SuperscriptBox["b", "2"]}], "+", 
       RowBox[{"3032", " ", 
        SuperscriptBox["b", "4"]}], "+", 
       RowBox[{"1827", " ", 
        SuperscriptBox["b", "6"]}], "+", 
       RowBox[{"360", " ", 
        SuperscriptBox["b", "8"]}]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{"119", " ", 
     RowBox[{"(", 
      RowBox[{"12600", "+", 
       RowBox[{"63963", " ", 
        SuperscriptBox["b", "2"]}], "+", 
       RowBox[{"106177", " ", 
        SuperscriptBox["b", "4"]}], "+", 
       RowBox[{"63963", " ", 
        SuperscriptBox["b", "6"]}], "+", 
       RowBox[{"12600", " ", 
        SuperscriptBox["b", "8"]}]}], ")"}]}], 
    RowBox[{"262144", " ", 
     RowBox[{"(", 
      RowBox[{"360", "+", 
       RowBox[{"1827", " ", 
        SuperscriptBox["b", "2"]}], "+", 
       RowBox[{"3032", " ", 
        SuperscriptBox["b", "4"]}], "+", 
       RowBox[{"1827", " ", 
        SuperscriptBox["b", "6"]}], "+", 
       RowBox[{"360", " ", 
        SuperscriptBox["b", "8"]}]}], ")"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.659043380937212*^9, 3.659045966289419*^9, 
  3.659148529112759*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Simplify", "@", 
  RowBox[{"Series", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"q", "^", 
      RowBox[{"(", 
       RowBox[{"1", "/", "8"}], ")"}]}], "*", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "q"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"2", "spin\[Alpha]", 
        RowBox[{"(", 
         RowBox[{"b", "+", 
          RowBox[{"1", "/", "b"}], "-", "spin\[Alpha]"}], ")"}]}], ")"}]}], 
     "*", 
     RowBox[{"spin4block1", "[", "q", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"q", ",", "0", ",", "6"}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "@", 
  RowBox[{"Series", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", "q"}], "]"}]}], ")"}], "/", "2"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"q", ",", "0", ",", "6"}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Factor", "@", 
  RowBox[{"(", 
   RowBox[{"testSpin41", "/.", 
    RowBox[{"{", 
     RowBox[{"b", "\[Rule]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]"}], 
       SqrtBox["3"]]}], "}"}]}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.659043651808929*^9, 3.659043667319091*^9}, {
  3.659043733189946*^9, 3.659043750992478*^9}, {3.659149013847567*^9, 
  3.659149037054143*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "-", 
   FractionBox["q", "8"], "-", 
   FractionBox[
    RowBox[{"5", " ", 
     SuperscriptBox["q", "2"]}], "128"], "-", 
   FractionBox[
    RowBox[{"21", " ", 
     SuperscriptBox["q", "3"]}], "1024"], "-", 
   FractionBox[
    RowBox[{"429", " ", 
     SuperscriptBox["q", "4"]}], "32768"], "-", 
   FractionBox[
    RowBox[{"2431", " ", 
     SuperscriptBox["q", "5"]}], "262144"], "-", 
   FractionBox[
    RowBox[{"29393", " ", 
     SuperscriptBox["q", "6"]}], "4194304"], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "q", "]"}], 
     RowBox[{"49", "/", "8"}]],
    SeriesData[$CellContext`q, 0, {}, 0, 49, 8],
    Editable->False]}],
  SeriesData[$CellContext`q, 0, {1, 0, 0, 0, 0, 0, 0, 0, 
    Rational[-1, 8], 0, 0, 0, 0, 0, 0, 0, 
    Rational[-5, 128], 0, 0, 0, 0, 0, 0, 0, 
    Rational[-21, 1024], 0, 0, 0, 0, 0, 0, 0, 
    Rational[-429, 32768], 0, 0, 0, 0, 0, 0, 0, 
    Rational[-2431, 262144], 0, 0, 0, 0, 0, 0, 0, 
    Rational[-29393, 4194304]}, 0, 49, 8],
  Editable->False]], "Output",
 CellChangeTimes->{{3.659043646611248*^9, 3.6590436683501577`*^9}, {
   3.659043734114567*^9, 3.65904375177864*^9}, 3.6591485296722727`*^9, {
   3.6591490097020893`*^9, 3.659149038096364*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "-", 
   FractionBox["q", "8"], "-", 
   FractionBox[
    RowBox[{"5", " ", 
     SuperscriptBox["q", "2"]}], "128"], "-", 
   FractionBox[
    RowBox[{"21", " ", 
     SuperscriptBox["q", "3"]}], "1024"], "-", 
   FractionBox[
    RowBox[{"429", " ", 
     SuperscriptBox["q", "4"]}], "32768"], "-", 
   FractionBox[
    RowBox[{"2431", " ", 
     SuperscriptBox["q", "5"]}], "262144"], "-", 
   FractionBox[
    RowBox[{"29393", " ", 
     SuperscriptBox["q", "6"]}], "4194304"], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "q", "]"}], "7"],
    SeriesData[$CellContext`q, 0, {}, 0, 7, 1],
    Editable->False]}],
  SeriesData[$CellContext`q, 0, {1, 
    Rational[-1, 8], 
    Rational[-5, 128], 
    Rational[-21, 1024], 
    Rational[-429, 32768], 
    Rational[-2431, 262144], 
    Rational[-29393, 4194304]}, 0, 7, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.659043646611248*^9, 3.6590436683501577`*^9}, {
   3.659043734114567*^9, 3.65904375177864*^9}, 3.6591485296722727`*^9, {
   3.6591490097020893`*^9, 3.659149038105061*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{"-", 
    FractionBox["1", "8"]}], ",", 
   RowBox[{"-", 
    FractionBox["5", "128"]}], ",", 
   RowBox[{"-", 
    FractionBox["21", "1024"]}], ",", 
   RowBox[{"-", 
    FractionBox["429", "32768"]}], ",", 
   RowBox[{"-", 
    FractionBox["2431", "262144"]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.659043646611248*^9, 3.6590436683501577`*^9}, {
   3.659043734114567*^9, 3.65904375177864*^9}, 3.6591485296722727`*^9, {
   3.6591490097020893`*^9, 3.659149038112176*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Simplify", "@", 
  RowBox[{"Series", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"q", "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "3"}], "/", "8"}], ")"}]}], "*", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "q"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"2", "spin\[Alpha]", 
        RowBox[{"(", 
         RowBox[{"b", "+", 
          RowBox[{"1", "/", "b"}], "-", "spin\[Alpha]"}], ")"}]}], ")"}]}], 
     "*", 
     RowBox[{"spin4block2", "[", "q", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"q", ",", "0", ",", "6"}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "@", 
  RowBox[{"Series", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"2", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "-", "q"}], "]"}]}], ")"}], "/", "q"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"q", ",", "0", ",", "6"}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Factor", "@", 
  RowBox[{"(", 
   RowBox[{"testSpin42", "/.", 
    RowBox[{"{", 
     RowBox[{"b", "\[Rule]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]"}], 
       SqrtBox["3"]]}], "}"}]}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.65904357890135*^9, 3.659043596654427*^9}, {
  3.65904363140275*^9, 3.659043643407583*^9}, {3.659043674759989*^9, 
  3.659043708118898*^9}, {3.659043758848576*^9, 3.6590437624068623`*^9}, {
  3.659149049487118*^9, 3.659149072221081*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   FractionBox["1", "2"], "+", 
   FractionBox["q", "16"], "+", 
   FractionBox[
    RowBox[{"7", " ", 
     SuperscriptBox["q", "2"]}], "256"], "+", 
   FractionBox[
    RowBox[{"33", " ", 
     SuperscriptBox["q", "3"]}], "2048"], "+", 
   FractionBox[
    RowBox[{"715", " ", 
     SuperscriptBox["q", "4"]}], "65536"], "+", 
   FractionBox[
    RowBox[{"4199", " ", 
     SuperscriptBox["q", "5"]}], "524288"], "+", 
   FractionBox[
    RowBox[{"52003", " ", 
     SuperscriptBox["q", "6"]}], "8388608"], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "q", "]"}], 
     RowBox[{"49", "/", "8"}]],
    SeriesData[$CellContext`q, 0, {}, 0, 49, 8],
    Editable->False]}],
  SeriesData[$CellContext`q, 0, {
    Rational[1, 2], 0, 0, 0, 0, 0, 0, 0, 
    Rational[1, 16], 0, 0, 0, 0, 0, 0, 0, 
    Rational[7, 256], 0, 0, 0, 0, 0, 0, 0, 
    Rational[33, 2048], 0, 0, 0, 0, 0, 0, 0, 
    Rational[715, 65536], 0, 0, 0, 0, 0, 0, 0, 
    Rational[4199, 524288], 0, 0, 0, 0, 0, 0, 0, 
    Rational[52003, 8388608]}, 0, 49, 8],
  Editable->False]], "Output",
 CellChangeTimes->{{3.659149068131467*^9, 3.659149073001957*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "+", 
   FractionBox["q", "8"], "+", 
   FractionBox[
    RowBox[{"7", " ", 
     SuperscriptBox["q", "2"]}], "128"], "+", 
   FractionBox[
    RowBox[{"33", " ", 
     SuperscriptBox["q", "3"]}], "1024"], "+", 
   FractionBox[
    RowBox[{"715", " ", 
     SuperscriptBox["q", "4"]}], "32768"], "+", 
   FractionBox[
    RowBox[{"4199", " ", 
     SuperscriptBox["q", "5"]}], "262144"], "+", 
   FractionBox[
    RowBox[{"52003", " ", 
     SuperscriptBox["q", "6"]}], "4194304"], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "q", "]"}], "7"],
    SeriesData[$CellContext`q, 0, {}, 0, 7, 1],
    Editable->False]}],
  SeriesData[$CellContext`q, 0, {1, 
    Rational[1, 8], 
    Rational[7, 128], 
    Rational[33, 1024], 
    Rational[715, 32768], 
    Rational[4199, 262144], 
    Rational[52003, 4194304]}, 0, 7, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.659149068131467*^9, 3.6591490730108852`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   FractionBox["1", "8"], ",", 
   FractionBox["7", "128"], ",", 
   FractionBox["33", "1024"], ",", 
   FractionBox["715", "32768"], ",", 
   FractionBox["4199", "262144"]}], "}"}]], "Output",
 CellChangeTimes->{{3.659149068131467*^9, 3.6591490730173798`*^9}}]
}, Open  ]],

Cell["OK, so for 4-pt examples afltZk4pt ", "Text",
 CellChangeTimes->{{3.6591488379177313`*^9, 3.6591488617741117`*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["higher-pt blocks", "Section",
 CellChangeTimes->{{3.659045788982778*^9, 3.6590457962150106`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Factor", "@", " ", 
    RowBox[{"afltZk4pt", "[", 
     RowBox[{"k", ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{
        RowBox[{"1", "/", "16"}], ",", "4"}], "]"}], ",", 
      RowBox[{"1", "/", "2"}], ",", 
      RowBox[{"2", 
       RowBox[{"I", "/", 
        RowBox[{"Sqrt", "[", "3", "]"}]}]}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "0", ",", "5"}], "}"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.659046141241355*^9, 3.659046163289423*^9}, {
  3.659046217930669*^9, 3.659046228456335*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \[NoBreak]\\!\\(1\\/0\\)\[NoBreak] \
encountered. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.659046238558275*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \[NoBreak]\\!\\(1\\/0\\)\[NoBreak] \
encountered. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.659046238597527*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \[NoBreak]\\!\\(1\\/0\\)\[NoBreak] \
encountered. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.659046238676875*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Power :: \
infy\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.659046238694621*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   FractionBox["1", "8"], ",", "ComplexInfinity", ",", "Indeterminate", ",", 
   "Indeterminate", ",", "Indeterminate"}], "}"}]], "Output",
 CellChangeTimes->{3.659046239509458*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Simplify", "@", " ", 
     RowBox[{"afltZk4pt", "[", 
      RowBox[{"k", ",", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"1", "/", "16"}], ",", "4"}], "]"}], ",", 
       RowBox[{"1", "/", "2"}], ",", "b"}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"k", ",", "0", ",", "5"}], "}"}]}], "\[IndentingNewLine]", "]"}],
   "/.", 
  RowBox[{"b", "->", 
   RowBox[{"2", 
    RowBox[{"I", "/", 
     RowBox[{"Sqrt", "[", "3", "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.6590461735464487`*^9, 3.659046185067947*^9}, {
  3.65904623604101*^9, 3.659046283496107*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   FractionBox["1", "8"], ",", 
   FractionBox["7", "128"], ",", 
   FractionBox["33", "1024"], ",", 
   FractionBox["715", "32768"], ",", 
   FractionBox["4199", "262144"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.659046197091423*^9, {3.6590462535669737`*^9, 3.659046292417777*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"energy6", "=", 
  RowBox[{"Sum", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"q", "[", "1", "]"}], "^", "k1"}], "*", 
     RowBox[{
      RowBox[{"q", "[", "2", "]"}], "^", "k2"}], "*", 
     RowBox[{
      RowBox[{"q", "[", "3", "]"}], "^", "k3"}], "*", "\[IndentingNewLine]", 
     RowBox[{"Simplify", "@", "  ", 
      RowBox[{"afltZk", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"k1", ",", "k2", ",", "k3"}], "}"}], ",", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"1", "/", "2"}], ",", "6"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"1", "/", "2"}], ",", "0"}], "}"}], ",", "b"}], "]"}]}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"k1", ",", "0", ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"k2", ",", "0", ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"k3", ",", "0", ",", "2"}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.659048001519704*^9, 3.659048034188734*^9}, {
  3.659048123177657*^9, 3.659048124417008*^9}, {3.6590481943766947`*^9, 
  3.659048219770838*^9}, {3.65904832791366*^9, 3.659048329118774*^9}, {
  3.659048878889934*^9, 3.6590488874877377`*^9}, {3.6590498507361107`*^9, 
  3.6590498524404087`*^9}}],

Cell[BoxData[
 RowBox[{"1", "-", 
  RowBox[{"q", "[", "1", "]"}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["b", "2"], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "1", "]"}], "2"]}], 
   RowBox[{"12", "+", 
    RowBox[{"26", " ", 
     SuperscriptBox["b", "2"]}], "+", 
    RowBox[{"12", " ", 
     SuperscriptBox["b", "4"]}]}]], "-", 
  RowBox[{
   RowBox[{"q", "[", "1", "]"}], " ", 
   RowBox[{"q", "[", "2", "]"}]}], "+", 
  FractionBox[
   RowBox[{"6", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["b", "2"]}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "1", "]"}], "2"], " ", 
    RowBox[{"q", "[", "2", "]"}]}], 
   RowBox[{"6", "+", 
    RowBox[{"13", " ", 
     SuperscriptBox["b", "2"]}], "+", 
    RowBox[{"6", " ", 
     SuperscriptBox["b", "4"]}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["b", "2"], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "2", "]"}], "2"]}], 
   RowBox[{"12", "+", 
    RowBox[{"26", " ", 
     SuperscriptBox["b", "2"]}], "+", 
    RowBox[{"12", " ", 
     SuperscriptBox["b", "4"]}]}]], "-", 
  RowBox[{"q", "[", "3", "]"}], "+", 
  RowBox[{
   RowBox[{"q", "[", "1", "]"}], " ", 
   RowBox[{"q", "[", "3", "]"}]}], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["b", "2"], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "1", "]"}], "2"], " ", 
    RowBox[{"q", "[", "3", "]"}]}], 
   RowBox[{"12", "+", 
    RowBox[{"26", " ", 
     SuperscriptBox["b", "2"]}], "+", 
    RowBox[{"12", " ", 
     SuperscriptBox["b", "4"]}]}]], "-", 
  RowBox[{
   RowBox[{"q", "[", "2", "]"}], " ", 
   RowBox[{"q", "[", "3", "]"}]}], "+", 
  RowBox[{
   RowBox[{"q", "[", "1", "]"}], " ", 
   RowBox[{"q", "[", "2", "]"}], " ", 
   RowBox[{"q", "[", "3", "]"}]}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["b", "2"], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "1", "]"}], "2"], " ", 
    RowBox[{"q", "[", "2", "]"}], " ", 
    RowBox[{"q", "[", "3", "]"}]}], 
   RowBox[{"12", "+", 
    RowBox[{"26", " ", 
     SuperscriptBox["b", "2"]}], "+", 
    RowBox[{"12", " ", 
     SuperscriptBox["b", "4"]}]}]], "+", 
  RowBox[{
   RowBox[{"q", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"q", "[", "2", "]"}], "2"], " ", 
   RowBox[{"q", "[", "3", "]"}]}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["b", "2"], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "2", "]"}], "2"], " ", 
    RowBox[{"q", "[", "3", "]"}]}], 
   RowBox[{"12", "+", 
    RowBox[{"26", " ", 
     SuperscriptBox["b", "2"]}], "+", 
    RowBox[{"12", " ", 
     SuperscriptBox["b", "4"]}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["b", "2"], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "3", "]"}], "2"]}], 
   RowBox[{"12", "+", 
    RowBox[{"26", " ", 
     SuperscriptBox["b", "2"]}], "+", 
    RowBox[{"12", " ", 
     SuperscriptBox["b", "4"]}]}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["b", "2"], " ", 
    RowBox[{"q", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "3", "]"}], "2"]}], 
   RowBox[{"12", "+", 
    RowBox[{"26", " ", 
     SuperscriptBox["b", "2"]}], "+", 
    RowBox[{"12", " ", 
     SuperscriptBox["b", "4"]}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["b", "4"], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "3", "]"}], "2"]}], 
   RowBox[{"4", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"6", "+", 
       RowBox[{"13", " ", 
        SuperscriptBox["b", "2"]}], "+", 
       RowBox[{"6", " ", 
        SuperscriptBox["b", "4"]}]}], ")"}], "2"]}]], "+", 
  FractionBox[
   RowBox[{"6", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["b", "2"]}], ")"}], "2"], " ", 
    RowBox[{"q", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "3", "]"}], "2"]}], 
   RowBox[{"6", "+", 
    RowBox[{"13", " ", 
     SuperscriptBox["b", "2"]}], "+", 
    RowBox[{"6", " ", 
     SuperscriptBox["b", "4"]}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["b", "2"], " ", 
    RowBox[{"q", "[", "1", "]"}], " ", 
    RowBox[{"q", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "3", "]"}], "2"]}], 
   RowBox[{"12", "+", 
    RowBox[{"26", " ", 
     SuperscriptBox["b", "2"]}], "+", 
    RowBox[{"12", " ", 
     SuperscriptBox["b", "4"]}]}]], "-", 
  FractionBox[
   RowBox[{"6", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["b", "2"]}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "1", "]"}], "2"], " ", 
    RowBox[{"q", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "3", "]"}], "2"]}], 
   RowBox[{"6", "+", 
    RowBox[{"13", " ", 
     SuperscriptBox["b", "2"]}], "+", 
    RowBox[{"6", " ", 
     SuperscriptBox["b", "4"]}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["b", "2"], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "3", "]"}], "2"]}], 
   RowBox[{"12", "+", 
    RowBox[{"26", " ", 
     SuperscriptBox["b", "2"]}], "+", 
    RowBox[{"12", " ", 
     SuperscriptBox["b", "4"]}]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["b", "2"], " ", 
    RowBox[{"q", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "3", "]"}], "2"]}], 
   RowBox[{"12", "+", 
    RowBox[{"26", " ", 
     SuperscriptBox["b", "2"]}], "+", 
    RowBox[{"12", " ", 
     SuperscriptBox["b", "4"]}]}]], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    RowBox[{"(", 
     RowBox[{"12", "+", 
      RowBox[{"55", " ", 
       SuperscriptBox["b", "2"]}], "+", 
      RowBox[{"87", " ", 
       SuperscriptBox["b", "4"]}], "+", 
      RowBox[{"55", " ", 
       SuperscriptBox["b", "6"]}], "+", 
      RowBox[{"12", " ", 
       SuperscriptBox["b", "8"]}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "3", "]"}], "2"]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"6", "+", 
      RowBox[{"13", " ", 
       SuperscriptBox["b", "2"]}], "+", 
      RowBox[{"6", " ", 
       SuperscriptBox["b", "4"]}]}], ")"}], "2"]]}]], "Output",
 CellChangeTimes->{3.659048058866397*^9, 3.6590481912052813`*^9, 
  3.6590483255615263`*^9, 3.659048379789007*^9, 3.659048936741899*^9, 
  3.659049906583589*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"energy6q", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"energy6", "/.", 
    RowBox[{"b", "->", 
     RowBox[{"2", 
      RowBox[{"I", "/", 
       RowBox[{"Sqrt", "[", "3", "]"}]}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"energy6\[Chi]", "=", 
  RowBox[{
   RowBox[{"Factor", "@", "energy6q"}], "/.", 
   RowBox[{
    RowBox[{"q", "[", "i_", "]"}], "\[RuleDelayed]", 
    RowBox[{
     RowBox[{"\[Chi]", "[", 
      RowBox[{"i", "+", "1"}], "]"}], "/", 
     RowBox[{"\[Chi]", "[", 
      RowBox[{"i", "+", "2"}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"energy6z", "=", 
  RowBox[{
   RowBox[{"Factor", "@", "energy6\[Chi]"}], "/.", 
   RowBox[{
    RowBox[{"\[Chi]", "[", "i_", "]"}], "\[RuleDelayed]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"z", "[", "i", "]"}], "-", 
       RowBox[{"z", "[", "1", "]"}]}], ")"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"z", "[", "5", "]"}], "-", 
        RowBox[{"z", "[", "6", "]"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"z", "[", "5", "]"}], "-", 
          RowBox[{"z", "[", "1", "]"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"z", "[", "i", "]"}], "-", 
          RowBox[{"z", "[", "6", "]"}]}], ")"}]}], ")"}]}]}]}]}]}]}], "Input",\

 CellChangeTimes->{{3.659048397550187*^9, 3.6590484034712057`*^9}, {
  3.6590498658556337`*^9, 3.659049914641246*^9}}],

Cell[BoxData[
 RowBox[{"1", "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"q", "[", "2", "]"}]}], ")"}], " ", 
   RowBox[{"q", "[", "3", "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"q", "[", "2", "]"}], "+", 
     SuperscriptBox[
      RowBox[{"q", "[", "2", "]"}], "2"]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"q", "[", "3", "]"}], "2"]}], "+", 
  RowBox[{
   RowBox[{"q", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"q", "[", "3", "]"}], "-", 
     SuperscriptBox[
      RowBox[{"q", "[", "3", "]"}], "2"], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"q", "[", "2", "]"}], "2"], " ", 
      RowBox[{"q", "[", "3", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"q", "[", "3", "]"}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"q", "[", "2", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"q", "[", "3", "]"}], "+", 
        SuperscriptBox[
         RowBox[{"q", "[", "3", "]"}], "2"]}], ")"}]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"q", "[", "1", "]"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"q", "[", "3", "]"}], "+", 
     SuperscriptBox[
      RowBox[{"q", "[", "3", "]"}], "2"], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"q", "[", "2", "]"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"q", "[", "3", "]"}], "-", 
        RowBox[{"6", " ", 
         SuperscriptBox[
          RowBox[{"q", "[", "3", "]"}], "2"]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"q", "[", "2", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"q", "[", "3", "]"}], "+", 
        SuperscriptBox[
         RowBox[{"q", "[", "3", "]"}], "2"]}], ")"}]}]}], ")"}]}]}]], "Output",\

 CellChangeTimes->{3.6590484039915323`*^9, 3.659049306578292*^9, 
  3.659049915382329*^9}],

Cell[BoxData[
 RowBox[{"1", "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"\[Chi]", "[", "2", "]"}], "2"], 
   SuperscriptBox[
    RowBox[{"\[Chi]", "[", "3", "]"}], "2"]], "-", 
  FractionBox[
   RowBox[{"\[Chi]", "[", "2", "]"}], 
   RowBox[{"\[Chi]", "[", "3", "]"}]], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"\[Chi]", "[", "2", "]"}], "2"], 
   SuperscriptBox[
    RowBox[{"\[Chi]", "[", "4", "]"}], "2"]], "-", 
  FractionBox[
   RowBox[{"\[Chi]", "[", "2", "]"}], 
   RowBox[{"\[Chi]", "[", "4", "]"}]], "-", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"\[Chi]", "[", "2", "]"}], "2"], 
   RowBox[{
    RowBox[{"\[Chi]", "[", "3", "]"}], " ", 
    RowBox[{"\[Chi]", "[", "4", "]"}]}]], "-", 
  FractionBox[
   RowBox[{"6", " ", 
    SuperscriptBox[
     RowBox[{"\[Chi]", "[", "2", "]"}], "2"]}], 
   SuperscriptBox[
    RowBox[{"\[Chi]", "[", "5", "]"}], "2"]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"\[Chi]", "[", "2", "]"}], " ", 
    RowBox[{"\[Chi]", "[", "3", "]"}]}], 
   SuperscriptBox[
    RowBox[{"\[Chi]", "[", "5", "]"}], "2"]], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"\[Chi]", "[", "3", "]"}], "2"], 
   SuperscriptBox[
    RowBox[{"\[Chi]", "[", "5", "]"}], "2"]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"\[Chi]", "[", "2", "]"}], " ", 
    RowBox[{"\[Chi]", "[", "4", "]"}]}], 
   SuperscriptBox[
    RowBox[{"\[Chi]", "[", "5", "]"}], "2"]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"\[Chi]", "[", "2", "]"}], "2"], " ", 
    RowBox[{"\[Chi]", "[", "4", "]"}]}], 
   RowBox[{
    RowBox[{"\[Chi]", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Chi]", "[", "5", "]"}], "2"]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"\[Chi]", "[", "3", "]"}], " ", 
    RowBox[{"\[Chi]", "[", "4", "]"}]}], 
   SuperscriptBox[
    RowBox[{"\[Chi]", "[", "5", "]"}], "2"]], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"\[Chi]", "[", "4", "]"}], "2"], 
   SuperscriptBox[
    RowBox[{"\[Chi]", "[", "5", "]"}], "2"]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"\[Chi]", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Chi]", "[", "4", "]"}], "2"]}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"\[Chi]", "[", "3", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Chi]", "[", "5", "]"}], "2"]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"\[Chi]", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Chi]", "[", "4", "]"}], "2"]}], 
   RowBox[{
    RowBox[{"\[Chi]", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Chi]", "[", "5", "]"}], "2"]}]], "+", 
  FractionBox[
   RowBox[{"\[Chi]", "[", "2", "]"}], 
   RowBox[{"\[Chi]", "[", "5", "]"}]], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"\[Chi]", "[", "2", "]"}], "2"], 
   RowBox[{
    RowBox[{"\[Chi]", "[", "3", "]"}], " ", 
    RowBox[{"\[Chi]", "[", "5", "]"}]}]], "-", 
  FractionBox[
   RowBox[{"\[Chi]", "[", "3", "]"}], 
   RowBox[{"\[Chi]", "[", "5", "]"}]], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"\[Chi]", "[", "2", "]"}], "2"], 
   RowBox[{
    RowBox[{"\[Chi]", "[", "4", "]"}], " ", 
    RowBox[{"\[Chi]", "[", "5", "]"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"\[Chi]", "[", "2", "]"}], " ", 
    RowBox[{"\[Chi]", "[", "3", "]"}]}], 
   RowBox[{
    RowBox[{"\[Chi]", "[", "4", "]"}], " ", 
    RowBox[{"\[Chi]", "[", "5", "]"}]}]], "-", 
  FractionBox[
   RowBox[{"\[Chi]", "[", "4", "]"}], 
   RowBox[{"\[Chi]", "[", "5", "]"}]], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"\[Chi]", "[", "2", "]"}], "2"], " ", 
    RowBox[{"\[Chi]", "[", "4", "]"}]}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"\[Chi]", "[", "3", "]"}], "2"], " ", 
    RowBox[{"\[Chi]", "[", "5", "]"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"\[Chi]", "[", "2", "]"}], " ", 
    RowBox[{"\[Chi]", "[", "4", "]"}]}], 
   RowBox[{
    RowBox[{"\[Chi]", "[", "3", "]"}], " ", 
    RowBox[{"\[Chi]", "[", "5", "]"}]}]]}]], "Output",
 CellChangeTimes->{3.6590484039915323`*^9, 3.659049306578292*^9, 
  3.6590499153908167`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "@", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"z", "[", 
        RowBox[{"i", "+", "1"}], "]"}], "-", 
       RowBox[{"z", "[", "1", "]"}]}], ")"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"z", "[", "5", "]"}], "-", 
        RowBox[{"z", "[", "6", "]"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"z", "[", "5", "]"}], "-", 
          RowBox[{"z", "[", "1", "]"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"i", "+", "1"}], "]"}], "-", 
          RowBox[{"z", "[", "6", "]"}]}], ")"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", ")"}]}], "/", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"z", "[", 
       RowBox[{"i", "+", "2"}], "]"}], "-", 
      RowBox[{"z", "[", "1", "]"}]}], ")"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"z", "[", "5", "]"}], "-", 
       RowBox[{"z", "[", "6", "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"z", "[", "5", "]"}], "-", 
         RowBox[{"z", "[", "1", "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"z", "[", 
          RowBox[{"i", "+", "2"}], "]"}], "-", 
         RowBox[{"z", "[", "6", "]"}]}], ")"}]}], ")"}]}]}], 
   "\[IndentingNewLine]", ")"}]}]], "Input",
 CellChangeTimes->{{3.6590494852826233`*^9, 3.659049504532131*^9}, {
  3.659049534934108*^9, 3.6590495855162888`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"z", "[", "1", "]"}]}], "+", 
     RowBox[{"z", "[", "5", "]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"z", "[", "1", "]"}]}], "+", 
     RowBox[{"z", "[", 
      RowBox[{"1", "+", "i"}], "]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"z", "[", "6", "]"}]}], "+", 
     RowBox[{"z", "[", 
      RowBox[{"2", "+", "i"}], "]"}]}], ")"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"z", "[", "1", "]"}], "-", 
     RowBox[{"z", "[", "5", "]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"z", "[", "6", "]"}], "-", 
     RowBox[{"z", "[", 
      RowBox[{"1", "+", "i"}], "]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"z", "[", "1", "]"}]}], "+", 
     RowBox[{"z", "[", 
      RowBox[{"2", "+", "i"}], "]"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.659049509449724*^9, 3.659049585990638*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bigfrac", "=", 
  RowBox[{"Together", "[", "\[IndentingNewLine]", 
   RowBox[{"(", 
    RowBox[{"energy6q", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q", "[", "i_", "]"}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"i", "+", "1"}], "]"}], "-", 
          RowBox[{"z", "[", "1", "]"}]}], ")"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"i", "+", "2"}], "]"}], "-", 
           RowBox[{"z", "[", "6", "]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"z", "[", 
              RowBox[{"i", "+", "2"}], "]"}], "-", 
             RowBox[{"z", "[", "1", "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"z", "[", 
              RowBox[{"i", "+", "1"}], "]"}], "-", 
             RowBox[{"z", "[", "6", "]"}]}], ")"}]}], ")"}]}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ")"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.659049945622431*^9, 3.6590500314122887`*^9}}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         FractionBox[
          RowBox[{
           TemplateBox[{"1544"},
            "OutputSizeLimit`Skeleton",
            DisplayFunction->(FrameBox[
              RowBox[{"\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}],
               Background -> GrayLevel[0.75], 
              BaseStyle -> {
               "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                ShowStringCharacters -> False}, BaselinePosition -> Baseline, 
              ContentPadding -> False, FrameMargins -> 1, FrameStyle -> 
              GrayLevel[0.75], RoundingRadius -> 7]& )], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"z", "[", "3", "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"z", "[", "4", "]"}], "2"], " ", 
            SuperscriptBox[
             TemplateBox[{"1"},
              "OutputSizeLimit`Skeleton",
              DisplayFunction->(FrameBox[
                
                RowBox[{
                 "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                Background -> GrayLevel[0.75], 
                BaseStyle -> {
                 "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                  ShowStringCharacters -> False}, BaselinePosition -> 
                Baseline, ContentPadding -> False, FrameMargins -> 1, 
                FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], "2"],
             " ", 
            SuperscriptBox[
             RowBox[{"z", "[", "6", "]"}], "6"]}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"z", "[", "1", "]"}], "-", 
              RowBox[{"z", "[", "3", "]"}]}], ")"}], "2"], " ", 
           TemplateBox[{"4"},
            "OutputSizeLimit`Skeleton",
            DisplayFunction->(FrameBox[
              RowBox[{"\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}],
               Background -> GrayLevel[0.75], 
              BaseStyle -> {
               "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                ShowStringCharacters -> False}, BaselinePosition -> Baseline, 
              ContentPadding -> False, FrameMargins -> 1, FrameStyle -> 
              GrayLevel[0.75], RoundingRadius -> 7]& )], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"z", "[", "4", "]"}], "-", 
              RowBox[{"z", "[", "6", "]"}]}], ")"}], "2"]}]],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{73., {3., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarCategory",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{61., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 306, 15466379229695820653, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{68., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 306, 15466379229695820653, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{50., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 306, 15466379229695820653, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{89., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Background->RGBColor[0.9657, 0.9753, 0.9802],
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[306]]], "Output",
 CellChangeTimes->{{3.659049973027239*^9, 3.659050032378933*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "SymmetricReduction"}]], "Input",
 CellChangeTimes->{{3.659050046702227*^9, 3.659050049689808*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox["\<\"\\!\\(\\*RowBox[{\\\"SymmetricReduction\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"f\\\", \\\"TI\\\"], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], StyleBox[\\\"1\\\", \
\\\"TR\\\"]], \\\",\\\", StyleBox[\\\"\[Ellipsis]\\\", \\\"TR\\\"], \
\\\",\\\", SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], StyleBox[\\\"n\\\", \
\\\"TI\\\"]]}], \\\"}\\\"}]}], \\\"]\\\"}]\\) gives a pair of polynomials \\!\
\\(\\*RowBox[{\\\"{\\\", RowBox[{StyleBox[\\\"p\\\", \\\"TI\\\"], \\\",\\\", \
StyleBox[\\\"q\\\", \\\"TI\\\"]}], \\\"}\\\"}]\\) in \
\\!\\(\\*RowBox[{SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], \\\"1\\\"], \\\
\",\\\", \\\"\[Ellipsis]\\\", \\\",\\\", SubscriptBox[StyleBox[\\\"x\\\", \
\\\"TI\\\"], StyleBox[\\\"n\\\", \\\"TI\\\"]]}]\\) such that \
\\!\\(\\*RowBox[{StyleBox[\\\"f\\\", \\\"TI\\\"], \\\"==\\\", \
RowBox[{StyleBox[\\\"p\\\", \\\"TI\\\"], \\\"+\\\", StyleBox[\\\"q\\\", \
\\\"TI\\\"]}]}]\\), where \\!\\(\\*StyleBox[\\\"p\\\", \\\"TI\\\"]\\) is the \
symmetric part and \\!\\(\\*StyleBox[\\\"q\\\", \\\"TI\\\"]\\) is the \
remainder.\\n\\!\\(\\*RowBox[{\\\"SymmetricReduction\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"f\\\", \\\"TI\\\"], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], StyleBox[\\\"1\\\", \
\\\"TR\\\"]], \\\",\\\", StyleBox[\\\"\[Ellipsis]\\\", \\\"TR\\\"], \
\\\",\\\", SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], StyleBox[\\\"n\\\", \
\\\"TI\\\"]]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{SubscriptBox[StyleBox[\\\"s\\\", \\\"TI\\\"], StyleBox[\\\"1\\\", \
\\\"TR\\\"]], \\\",\\\", StyleBox[\\\"\[Ellipsis]\\\", \\\"TR\\\"], \
\\\",\\\", SubscriptBox[StyleBox[\\\"s\\\", \\\"TI\\\"], StyleBox[\\\"n\\\", \
\\\"TI\\\"]]}], \\\"}\\\"}]}], \\\"]\\\"}]\\) gives the pair \
\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{StyleBox[\\\"p\\\", \\\"TI\\\"], \
\\\",\\\", StyleBox[\\\"q\\\", \\\"TI\\\"]}], \\\"}\\\"}]\\) with the \
elementary symmetric polynomials in \\!\\(\\*StyleBox[\\\"p\\\", \
\\\"TI\\\"]\\) replaced by \\!\\(\\*RowBox[{SubscriptBox[StyleBox[\\\"s\\\", \
\\\"TI\\\"], \\\"1\\\"], \\\",\\\", \\\"\[Ellipsis]\\\", \\\",\\\", \
SubscriptBox[StyleBox[\\\"s\\\", \\\"TI\\\"], StyleBox[\\\"n\\\", \
\\\"TI\\\"]]}]\\).\"\>", "MSG"], "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->"paclet:ref/SymmetricReduction"]}]], "Print", "PrintUsage",
 CellChangeTimes->{3.6590500500225353`*^9},
 CellTags->"Info-d56be4a2-929a-4d2e-9229-1f9c6727a7a3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SymmetricReduction", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Denominator", "[", "bigfrac", "]"}], 
    RowBox[{"Numerator", "[", "bigfrac", "]"}]}], ",", 
   RowBox[{"Array", "[", 
    RowBox[{"z", ",", "6"}], "]"}], ",", 
   RowBox[{"Array", "[", 
    RowBox[{"s", ",", "6"}], "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.659050035241*^9, 3.659050111112049*^9}}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"s", "[", "1", "]"}], "8"], " ", 
             SuperscriptBox[
              RowBox[{"s", "[", "4", "]"}], "4"]}], "-", 
            RowBox[{"8", " ", 
             SuperscriptBox[
              RowBox[{"s", "[", "1", "]"}], "6"], " ", 
             RowBox[{"s", "[", "2", "]"}], " ", 
             SuperscriptBox[
              RowBox[{"s", "[", "4", "]"}], "4"]}], "+", 
            RowBox[{"20", " ", 
             SuperscriptBox[
              RowBox[{"s", "[", "1", "]"}], "4"], " ", 
             SuperscriptBox[
              RowBox[{"s", "[", "2", "]"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"s", "[", "4", "]"}], "4"]}], "-", 
            RowBox[{"16", " ", 
             SuperscriptBox[
              RowBox[{"s", "[", "1", "]"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"s", "[", "2", "]"}], "3"], " ", 
             SuperscriptBox[
              RowBox[{"s", "[", "4", "]"}], "4"]}], "+", 
            TemplateBox[{"329"},
             "OutputSizeLimit`Skeleton",
             DisplayFunction->(FrameBox[
               
               RowBox[{
                "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
               Background -> GrayLevel[0.75], 
               BaseStyle -> {
                "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                 ShowStringCharacters -> False}, BaselinePosition -> Baseline,
                ContentPadding -> False, FrameMargins -> 1, FrameStyle -> 
               GrayLevel[0.75], RoundingRadius -> 7]& )], "+", 
            RowBox[{"23560", " ", 
             RowBox[{"s", "[", "2", "]"}], " ", 
             RowBox[{"s", "[", "4", "]"}], " ", 
             SuperscriptBox[
              RowBox[{"s", "[", "6", "]"}], "3"]}], "+", 
            RowBox[{"10009", " ", 
             RowBox[{"s", "[", "1", "]"}], " ", 
             RowBox[{"s", "[", "5", "]"}], " ", 
             SuperscriptBox[
              RowBox[{"s", "[", "6", "]"}], "3"]}], "-", 
            RowBox[{"46100", " ", 
             SuperscriptBox[
              RowBox[{"s", "[", "6", "]"}], "4"]}]}], ",", 
           TemplateBox[{"1"},
            "OutputSizeLimit`Skeleton",
            DisplayFunction->(FrameBox[
              RowBox[{"\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}],
               Background -> GrayLevel[0.75], 
              BaseStyle -> {
               "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                ShowStringCharacters -> False}, BaselinePosition -> Baseline, 
              ContentPadding -> False, FrameMargins -> 1, FrameStyle -> 
              GrayLevel[0.75], RoundingRadius -> 7]& )]}], "}"}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{73., {3., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarCategory",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{61., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{61., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 311, 15466379229695820653, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{68., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 311, 15466379229695820653, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{50., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 311, 15466379229695820653, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{89., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Background->RGBColor[0.9657, 0.9753, 0.9802],
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[311]]], "Output",
 CellChangeTimes->{
  3.659050038703499*^9, {3.659050070716714*^9, 3.6590500989896603`*^9}, 
   3.659050157042367*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"u1Factor", "[", 
   RowBox[{"4", ",", "energy\[Alpha]", ",", "b"}], "]"}], "/.", 
  RowBox[{"b", "->", 
   RowBox[{"2", 
    RowBox[{"I", "/", 
     RowBox[{"Sqrt", "[", "3", "]"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u1Factor", "[", 
   RowBox[{"4", ",", "spin\[Alpha]", ",", "b"}], "]"}], "/.", 
  RowBox[{"b", "->", 
   RowBox[{"2", 
    RowBox[{"I", "/", 
     RowBox[{"Sqrt", "[", "3", "]"}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.659149395848638*^9, 3.659149405644556*^9}}],

Cell[BoxData[
 RowBox[{"1", "-", 
  RowBox[{"q", "[", "1", "]"}]}]], "Output",
 CellChangeTimes->{{3.6591493968194323`*^9, 3.6591494246899633`*^9}}],

Cell[BoxData[
 SuperscriptBox[
  RowBox[{"(", 
   RowBox[{"1", "-", 
    RowBox[{"q", "[", "1", "]"}]}], ")"}], 
  RowBox[{"1", "/", "8"}]]], "Output",
 CellChangeTimes->{{3.6591493968194323`*^9, 3.659149424698558*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"u1Factor", "[", 
   RowBox[{"6", ",", "energy\[Alpha]", ",", "b"}], "]"}], "/.", 
  RowBox[{"b", "->", 
   RowBox[{"2", 
    RowBox[{"I", "/", 
     RowBox[{"Sqrt", "[", "3", "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.659149356304652*^9, 3.659149388131256*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"q", "[", "1", "]"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"q", "[", "2", "]"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     RowBox[{"q", "[", "1", "]"}], " ", 
     RowBox[{"q", "[", "2", "]"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"q", "[", "3", "]"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     RowBox[{"q", "[", "2", "]"}], " ", 
     RowBox[{"q", "[", "3", "]"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     RowBox[{"q", "[", "1", "]"}], " ", 
     RowBox[{"q", "[", "2", "]"}], " ", 
     RowBox[{"q", "[", "3", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.65914936670418*^9, 3.659149388902368*^9}, 
   3.659149427764827*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Together", "[", "\[IndentingNewLine]", 
  RowBox[{"(", 
   RowBox[{"energy6q", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"q", "[", "i_", "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"z", "[", 
          RowBox[{"i", "+", "1"}], "]"}], "-", 
         RowBox[{"z", "[", "1", "]"}]}], ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{"i", "+", "2"}], "]"}], "-", 
          RowBox[{"z", "[", "6", "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"z", "[", 
             RowBox[{"i", "+", "2"}], "]"}], "-", 
            RowBox[{"z", "[", "1", "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"z", "[", 
             RowBox[{"i", "+", "1"}], "]"}], "-", 
            RowBox[{"z", "[", "6", "]"}]}], ")"}]}], ")"}]}]}]}], 
     "\[IndentingNewLine]", "}"}]}], ")"}], "]"}]], "Input",
 CellChangeTimes->{{3.659050303392926*^9, 3.659050343061742*^9}}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         FractionBox[
          RowBox[{
           TemplateBox[{"1544"},
            "OutputSizeLimit`Skeleton",
            DisplayFunction->(FrameBox[
              RowBox[{"\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}],
               Background -> GrayLevel[0.75], 
              BaseStyle -> {
               "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                ShowStringCharacters -> False}, BaselinePosition -> Baseline, 
              ContentPadding -> False, FrameMargins -> 1, FrameStyle -> 
              GrayLevel[0.75], RoundingRadius -> 7]& )], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"z", "[", "3", "]"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"z", "[", "4", "]"}], "2"], " ", 
            SuperscriptBox[
             TemplateBox[{"1"},
              "OutputSizeLimit`Skeleton",
              DisplayFunction->(FrameBox[
                
                RowBox[{
                 "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                Background -> GrayLevel[0.75], 
                BaseStyle -> {
                 "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                  ShowStringCharacters -> False}, BaselinePosition -> 
                Baseline, ContentPadding -> False, FrameMargins -> 1, 
                FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], "2"],
             " ", 
            SuperscriptBox[
             RowBox[{"z", "[", "6", "]"}], "6"]}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"z", "[", "1", "]"}], "-", 
              RowBox[{"z", "[", "3", "]"}]}], ")"}], "2"], " ", 
           TemplateBox[{"4"},
            "OutputSizeLimit`Skeleton",
            DisplayFunction->(FrameBox[
              RowBox[{"\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}],
               Background -> GrayLevel[0.75], 
              BaseStyle -> {
               "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                ShowStringCharacters -> False}, BaselinePosition -> Baseline, 
              ContentPadding -> False, FrameMargins -> 1, FrameStyle -> 
              GrayLevel[0.75], RoundingRadius -> 7]& )], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"z", "[", "4", "]"}], "-", 
              RowBox[{"z", "[", "6", "]"}]}], ")"}], "2"]}]],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{73., {3., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarCategory",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{61., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 321, 15466379229695820653, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{68., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{68., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 321, 15466379229695820653, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{50., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 321, 15466379229695820653, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{89., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{89., {0., 10.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Background->RGBColor[0.9657, 0.9753, 0.9802],
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[321]]], "Output",
 CellChangeTimes->{{3.659050304941443*^9, 3.6590503439128847`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"energy\[Alpha]", "/.", 
   RowBox[{"b", "->", 
    RowBox[{"2", 
     RowBox[{"I", "/", 
      RowBox[{"Sqrt", "[", "3", "]"}]}]}]}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2", "energy\[Alpha]", 
     RowBox[{"(", 
      RowBox[{"b", "+", 
       RowBox[{"1", "/", "b"}], "-", "energy\[Alpha]"}], ")"}]}], ")"}], "/.", 
   RowBox[{"b", "->", 
    RowBox[{"2", 
     RowBox[{"I", "/", 
      RowBox[{"Sqrt", "[", "3", "]"}]}]}]}]}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.6590503566958637`*^9, 3.659050369836705*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", 
   SqrtBox["3"]}], "2"]], "Output",
 CellChangeTimes->{{3.659050357460475*^9, 3.659050370402172*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.659050357460475*^9, 3.659050370409094*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Try to replicate Santachiara paper", "Section",
 CellChangeTimes->{{3.6591499269064198`*^9, 3.659149933864902*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"diffSubs", "=", 
   RowBox[{"{", "\n", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"w", "[", 
       RowBox[{"i_", ",", "j_"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"w", "[", "i", "]"}], "-", 
        RowBox[{"w", "[", "j", "]"}]}], ")"}]}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"zw", "[", 
       RowBox[{"i_", ",", "j_"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"z", "[", "i", "]"}], "-", 
        RowBox[{"w", "[", "j", "]"}]}], ")"}]}]}], "\n", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qSubs", "=", 
   RowBox[{"{", "\n", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"w", "[", "1", "]"}], "\[Rule]", "0"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"w", "[", "2", "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"q", "[", "1", "]"}], 
       RowBox[{"q", "[", "2", "]"}], 
       RowBox[{"q", "[", "3", "]"}]}]}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"w", "[", "3", "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"q", "[", "2", "]"}], 
       RowBox[{"q", "[", "3", "]"}]}]}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"w", "[", "4", "]"}], "\[Rule]", 
      RowBox[{"q", "[", "3", "]"}]}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"z", "[", "1", "]"}], "\[Rule]", "1"}]}], "\n", "}"}]}], 
  ";"}]}], "Code",
 CellChangeTimes->{3.6592793318020477`*^9}],

Cell[CellGroupData[{

Cell["Nayak/Wilczek eq 7.17-18, for polynomial (not working)", "Subsection",
 CellChangeTimes->{{3.659279288671324*^9, 3.659279309829945*^9}, {
  3.659280262515706*^9, 3.65928026456231*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nw\[Chi]", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"w", "[", 
        RowBox[{"1", ",", "2"}], "]"}], 
       RowBox[{"w", "[", 
        RowBox[{"3", ",", "4"}], "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"w", "[", 
        RowBox[{"1", ",", "3"}], "]"}], 
       RowBox[{"w", "[", 
        RowBox[{"2", ",", "4"}], "]"}]}], ")"}]}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"nwh", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Alpha]_", ",", "\[Beta]_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Gamma]_", ",", "\[Delta]_"}], "}"}]}], "]"}], ":=", "\n", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", "\n", "\t", 
       RowBox[{"temp", "=", " ", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"(", "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"zw", "[", 
             RowBox[{"i", ",", "\[Alpha]"}], "]"}], 
            RowBox[{"zw", "[", 
             RowBox[{"i", ",", "\[Beta]"}], "]"}], 
            RowBox[{"zw", "[", 
             RowBox[{"j", ",", "\[Gamma]"}], "]"}], 
            RowBox[{"zw", "[", 
             RowBox[{"j", ",", "\[Delta]"}], "]"}]}], "\[IndentingNewLine]", 
           "\t", ")"}], "/", 
          RowBox[{"(", "\[IndentingNewLine]", "\t\t", 
           RowBox[{
            RowBox[{"zw", "[", 
             RowBox[{"i", ",", "\[Gamma]"}], "]"}], 
            RowBox[{"zw", "[", 
             RowBox[{"i", ",", "\[Delta]"}], "]"}], 
            RowBox[{"zw", "[", 
             RowBox[{"j", ",", "\[Alpha]"}], "]"}], 
            RowBox[{"zw", "[", 
             RowBox[{"j", ",", "\[Beta]"}], "]"}]}], "\[IndentingNewLine]", 
           "\t", ")"}]}], "]"}]}], "\n", "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"temp", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "\[Rule]", "1"}], ",", 
           RowBox[{"j", "\[Rule]", "2"}]}], "}"}]}], ")"}], " ", "+", " ", 
       RowBox[{"(", 
        RowBox[{"temp", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "\[Rule]", "2"}], ",", 
           RowBox[{"j", "\[Rule]", "1"}]}], "}"}]}], ")"}]}]}], "\n", "]"}]}],
    ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nwJastrow", "=", 
    RowBox[{
     RowBox[{"(", "\n", "\t", 
      RowBox[{
       RowBox[{"w", "[", 
        RowBox[{"1", ",", "2"}], "]"}], 
       RowBox[{"w", "[", 
        RowBox[{"1", ",", "3"}], "]"}], 
       RowBox[{"w", "[", 
        RowBox[{"1", ",", "4"}], "]"}], 
       RowBox[{"w", "[", 
        RowBox[{"2", ",", "3"}], "]"}], 
       RowBox[{"w", "[", 
        RowBox[{"2", ",", "4"}], "]"}], 
       RowBox[{"w", "[", 
        RowBox[{"3", ",", "4"}], "]"}]}], "\n", ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "8"}], ")"}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"nw\[CapitalPsi]", "[", "\[Sigma]_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"1", ",", "3"}], "]"}], 
        RowBox[{"w", "[", 
         RowBox[{"2", ",", "4"}], "]"}]}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"1", "/", "4"}], ")"}]}], "/", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"1", "+", 
       RowBox[{"\[Sigma]", "*", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", "nw\[Chi]"}], "]"}]}]}], "]"}]}], 
    RowBox[{"(", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"nwJastrow", "*", 
       RowBox[{"nwh", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "4"}], "}"}]}], "]"}]}], "+", 
      RowBox[{"\[Sigma]", "*", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", "nw\[Chi]"}], "]"}], "nwJastrow", "*", 
       RowBox[{"nwh", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
     ")"}]}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.65922239597353*^9, 3.659222561333363*^9}, {
   3.659222832143882*^9, 3.659222921929605*^9}, 3.6592230019546347`*^9, {
   3.65922523618377*^9, 3.6592253387384787`*^9}, {3.659225387945101*^9, 
   3.6592254060120153`*^9}, {3.659279184820846*^9, 3.65927920744353*^9}, {
   3.659279269993981*^9, 3.659279279401329*^9}, {3.659279325290719*^9, 
   3.659279352153079*^9}, {3.6592794035538387`*^9, 3.659279517685457*^9}, {
   3.659279622818019*^9, 3.6592797155617857`*^9}, {3.659279930629568*^9, 
   3.659279999625852*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PowerExpand", "@", 
  RowBox[{"Simplify", "@", 
   RowBox[{"PowerExpand", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"nw\[CapitalPsi]", "[", "1", "]"}], "/.", "diffSubs"}], "/.", 
     "qSubs"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6592797407399693`*^9, 3.659279762732909*^9}, {
  3.659279798385199*^9, 3.6592798113449583`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], 
     RowBox[{"3", "/", "8"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"q", "[", "1", "]"}]}], ")"}], 
     RowBox[{"1", "/", "8"}]], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "1", "]"}], 
     RowBox[{"1", "/", "8"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"q", "[", "2", "]"}]}], ")"}], 
     RowBox[{"1", "/", "8"}]], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "2", "]"}], 
     RowBox[{"5", "/", "8"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{
        RowBox[{"q", "[", "1", "]"}], " ", 
        RowBox[{"q", "[", "2", "]"}]}]}], ")"}], 
     RowBox[{"3", "/", "8"}]], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "3", "]"}], 
     RowBox[{"5", "/", "4"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         FractionBox[
          SqrtBox[
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"q", "[", "1", "]"}]}]], 
          SqrtBox[
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{
             RowBox[{"q", "[", "1", "]"}], " ", 
             RowBox[{"q", "[", "2", "]"}]}]}]]]}], ")"}], " ", 
       RowBox[{"z", "[", "2", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"q", "[", "2", "]"}], " ", 
          SuperscriptBox[
           RowBox[{"q", "[", "3", "]"}], "2"]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"z", "[", "2", "]"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"q", "[", "2", "]"}]}], ")"}], " ", 
          RowBox[{"q", "[", "3", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"z", "[", "2", "]"}]}], ")"}]}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"q", "[", "1", "]"}], " ", 
       RowBox[{"q", "[", "2", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"q", "[", "2", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox[
             SqrtBox[
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"q", "[", "1", "]"}]}]], 
             SqrtBox[
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{
                RowBox[{"q", "[", "1", "]"}], " ", 
                RowBox[{"q", "[", "2", "]"}]}]}]]]}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"q", "[", "3", "]"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"z", "[", "2", "]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox[
             SqrtBox[
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"q", "[", "1", "]"}]}]], 
             SqrtBox[
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{
                RowBox[{"q", "[", "1", "]"}], " ", 
                RowBox[{"q", "[", "2", "]"}]}]}]]]}], ")"}], " ", 
          RowBox[{"z", "[", "2", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"z", "[", "2", "]"}]}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"q", "[", "3", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox[
             RowBox[{"2", " ", 
              SqrtBox[
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"q", "[", "1", "]"}]}]], " ", 
              RowBox[{"z", "[", "2", "]"}]}], 
             SqrtBox[
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{
                RowBox[{"q", "[", "1", "]"}], " ", 
                RowBox[{"q", "[", "2", "]"}]}]}]]], "+", 
            SuperscriptBox[
             RowBox[{"z", "[", "2", "]"}], "2"], "+", 
            RowBox[{
             RowBox[{"q", "[", "2", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                SqrtBox[
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"q", "[", "1", "]"}]}]], 
                SqrtBox[
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{
                   RowBox[{"q", "[", "1", "]"}], " ", 
                   RowBox[{"q", "[", "2", "]"}]}]}]]], "+", 
               RowBox[{"2", " ", 
                RowBox[{"z", "[", "2", "]"}]}], "+", 
               FractionBox[
                RowBox[{
                 SqrtBox[
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   RowBox[{"q", "[", "1", "]"}]}]], " ", 
                 SuperscriptBox[
                  RowBox[{"z", "[", "2", "]"}], "2"]}], 
                SqrtBox[
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{
                   RowBox[{"q", "[", "1", "]"}], " ", 
                   RowBox[{"q", "[", "2", "]"}]}]}]]]}], ")"}]}]}], ")"}]}]}],
         ")"}]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SqrtBox[
     RowBox[{"1", "+", 
      FractionBox[
       SqrtBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"q", "[", "1", "]"}]}]], 
       SqrtBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          RowBox[{"q", "[", "1", "]"}], " ", 
          RowBox[{"q", "[", "2", "]"}]}]}]]]}]], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      RowBox[{"q", "[", "3", "]"}]}]], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      RowBox[{
       RowBox[{"q", "[", "2", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}]}]}]], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      RowBox[{
       RowBox[{"q", "[", "1", "]"}], " ", 
       RowBox[{"q", "[", "2", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}]}]}]], " ", 
    SqrtBox[
     RowBox[{"z", "[", "2", "]"}]], " ", 
    SqrtBox[
     RowBox[{
      RowBox[{"-", 
       RowBox[{"q", "[", "3", "]"}]}], "+", 
      RowBox[{"z", "[", "2", "]"}]}]], " ", 
    SqrtBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"q", "[", "2", "]"}]}], " ", 
       RowBox[{"q", "[", "3", "]"}]}], "+", 
      RowBox[{"z", "[", "2", "]"}]}]], " ", 
    SqrtBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"q", "[", "1", "]"}]}], " ", 
       RowBox[{"q", "[", "2", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}]}], "+", 
      RowBox[{"z", "[", "2", "]"}]}]]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.659279751347192*^9, 3.659279763876142*^9}, {
   3.659279800838866*^9, 3.6592798117371683`*^9}, 3.659280002678257*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Nayak/Wilczek result, as quoted in ST (working)", "Subsection",
 CellChangeTimes->{{3.659222371501067*^9, 3.659222376529069*^9}, {
  3.6592791756177263`*^9, 3.6592791799144297`*^9}, {3.659280564759561*^9, 
  3.6592805662545557`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "NB", " ", "misprint", " ", "in", " ", "\[Chi]", " ", "in", " ", "PRD"}], 
   "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"st\[Chi]", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"2", ",", "3"}], "]"}], 
        RowBox[{"w", "[", 
         RowBox[{"1", ",", "4"}], "]"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"1", ",", "3"}], "]"}], 
        RowBox[{"w", "[", 
         RowBox[{"2", ",", "4"}], "]"}]}], ")"}]}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"stg", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"1", ",", "3"}], "]"}], 
        RowBox[{
         RowBox[{"w", "[", 
          RowBox[{"2", ",", "4"}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"w", "[", 
            RowBox[{"1", ",", "2"}], "]"}], 
           RowBox[{"w", "[", 
            RowBox[{"2", ",", "3"}], "]"}], 
           RowBox[{"w", "[", 
            RowBox[{"3", ",", "4"}], "]"}], 
           RowBox[{"w", "[", 
            RowBox[{"4", ",", "1"}], "]"}]}], ")"}]}]}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"1", "/", "8"}], ")"}]}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sth", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i_", ",", "j_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k_", ",", "l_"}], "}"}]}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Sqrt", "[", "#", "]"}], "+", 
         RowBox[{"1", "/", 
          RowBox[{"Sqrt", "[", "#", "]"}]}]}], "&"}], ")"}], "[", 
      RowBox[{
       RowBox[{"(", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"zw", "[", 
          RowBox[{"1", ",", "i"}], "]"}], 
         RowBox[{"zw", "[", 
          RowBox[{"1", ",", "j"}], "]"}], 
         RowBox[{"zw", "[", 
          RowBox[{"2", ",", "k"}], "]"}], 
         RowBox[{"zw", "[", 
          RowBox[{"2", ",", "l"}], "]"}]}], "\[IndentingNewLine]", ")"}], "/", 
       RowBox[{"(", "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"zw", "[", 
          RowBox[{"1", ",", "k"}], "]"}], 
         RowBox[{"zw", "[", 
          RowBox[{"1", ",", "l"}], "]"}], 
         RowBox[{"zw", "[", 
          RowBox[{"2", ",", "i"}], "]"}], 
         RowBox[{"zw", "[", 
          RowBox[{"2", ",", "j"}], "]"}]}], "\[IndentingNewLine]", ")"}]}], 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"stF", "[", "\[Sigma]_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"stg", "/", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "+", 
          RowBox[{"\[Sigma]", "*", 
           RowBox[{"Sqrt", "[", "st\[Chi]", "]"}]}]}], "]"}]}], ")"}], 
      RowBox[{"(", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"sth", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "4"}], "}"}]}], "]"}], "+", 
        RowBox[{"\[Sigma]", "*", 
         RowBox[{"Sqrt", "[", "st\[Chi]", "]"}], 
         RowBox[{"sth", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", ")"}]}]}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.65922239597353*^9, 3.659222561333363*^9}, {
   3.659222832143882*^9, 3.659222921929605*^9}, 3.6592230019546347`*^9, {
   3.65922523618377*^9, 3.6592253387384787`*^9}, {3.659225387945101*^9, 
   3.6592254060120153`*^9}, {3.659279184820846*^9, 3.65927920744353*^9}, {
   3.659279269993981*^9, 3.659279279401329*^9}, {3.659279325290719*^9, 
   3.6592793355138197`*^9}, {3.659280227235874*^9, 3.6592802520418*^9}, {
   3.65931552083037*^9, 3.6593155218197403`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Normal", "@", 
   RowBox[{"Series", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"stF", "[", "1", "]"}], "/", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"q", "[", "1", "]"}], "^", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "/", "8"}], ")"}]}], 
            RowBox[{
             RowBox[{"q", "[", "2", "]"}], "^", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "/", "8"}], ")"}]}], 
            RowBox[{
             RowBox[{"q", "[", "3", "]"}], "^", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "/", "4"}], ")"}]}]}], 
           "\[IndentingNewLine]", ")"}]}], "/.", "diffSubs"}], "/.", 
        "qSubs"}], "]"}], "/.", 
      RowBox[{
       RowBox[{"q", "[", "i_", "]"}], "\[RuleDelayed]", 
       RowBox[{"\[CurlyEpsilon]", "*", 
        RowBox[{"q", "[", "i", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "2"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"PowerExpand", "[", 
  RowBox[{"Limit", "[", 
   RowBox[{"%", ",", 
    RowBox[{
     RowBox[{"z", "[", "2", "]"}], "\[Rule]", "Infinity"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"nwFPlusGoal", "=", 
  RowBox[{
   RowBox[{"Collect", "[", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"%", "*", 
      RowBox[{"(", 
       RowBox[{"32", 
        RowBox[{
         RowBox[{"Sqrt", "[", "2", "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"128", "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"1", "/", "8"}], ")"}]}]}], ")"}]}]}], ")"}]}], ",", 
     "\[IndentingNewLine]", "\t", "\[CurlyEpsilon]", ",", 
     "\[IndentingNewLine]", "\t", "Factor"}], "\[IndentingNewLine]", "]"}], "/.", 
   RowBox[{"\[CurlyEpsilon]", "\[Rule]", "1"}]}]}]}], "Input",
 CellChangeTimes->{{3.65922300817305*^9, 3.6592230160699453`*^9}, {
  3.659223069024765*^9, 3.659223165728507*^9}, {3.6592250533710117`*^9, 
  3.659225080088296*^9}, {3.659225113962357*^9, 3.6592251290259666`*^9}, {
  3.6592251847360764`*^9, 3.659225185073245*^9}, {3.659225357739972*^9, 
  3.659225358075924*^9}, {3.6592800663944817`*^9, 3.659280066539658*^9}, {
  3.65928029995507*^9, 3.659280354326303*^9}, {3.659280522661491*^9, 
  3.659280524494226*^9}, {3.659283681597171*^9, 3.659283727260984*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"-", "1"}], ")"}], 
    RowBox[{"1", "/", "8"}]], " ", 
   RowBox[{"(", 
    RowBox[{"128", "+", 
     RowBox[{"16", " ", "\[CurlyEpsilon]", " ", 
      RowBox[{"q", "[", "2", "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["\[CurlyEpsilon]", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"q", "[", "1", "]"}], "2"]}], "+", 
        RowBox[{"9", " ", 
         SuperscriptBox[
          RowBox[{"q", "[", "2", "]"}], "2"]}], "+", 
        RowBox[{"16", " ", 
         SuperscriptBox[
          RowBox[{"q", "[", "3", "]"}], "2"]}]}], ")"}]}]}], ")"}]}], 
  RowBox[{"32", " ", 
   SqrtBox["2"]}]]], "Output",
 CellChangeTimes->{{3.659223011971643*^9, 3.659223016651572*^9}, {
   3.6592230711059217`*^9, 3.659223167407003*^9}, 3.659225083094543*^9, {
   3.659225114626416*^9, 3.65922512977919*^9}, 3.6592251869567537`*^9, 
   3.659225359683921*^9, 3.6592254116285686`*^9, 3.659280080543289*^9, 
   3.659280236377129*^9, {3.659280327394614*^9, 3.65928035472746*^9}, 
   3.659280524941894*^9, {3.659283684221446*^9, 3.659283727943022*^9}}],

Cell[BoxData[
 RowBox[{"1", "+", 
  FractionBox[
   RowBox[{"q", "[", "2", "]"}], "8"], "+", 
  RowBox[{
   FractionBox["1", "128"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"q", "[", "1", "]"}], "2"]}], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox[
       RowBox[{"q", "[", "2", "]"}], "2"]}], "+", 
     RowBox[{"16", " ", 
      SuperscriptBox[
       RowBox[{"q", "[", "3", "]"}], "2"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.659223011971643*^9, 3.659223016651572*^9}, {
   3.6592230711059217`*^9, 3.659223167407003*^9}, 3.659225083094543*^9, {
   3.659225114626416*^9, 3.65922512977919*^9}, 3.6592251869567537`*^9, 
   3.659225359683921*^9, 3.6592254116285686`*^9, 3.659280080543289*^9, 
   3.659280236377129*^9, {3.659280327394614*^9, 3.65928035472746*^9}, 
   3.659280524941894*^9, {3.659283684221446*^9, 3.6592837279535418`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Misprints", " ", "-", " ", "missing", " ", "-", " ", 
     RowBox[{"signs", " ", "in", " ", "\[Delta]s", " ", "for", " ", 
      RowBox[{"q", "[", "2", "]"}]}]}], ",", 
    RowBox[{"q", "[", "3", "]"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Normal", "@", 
     RowBox[{"Series", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"stF", "[", 
             RowBox[{"-", "1"}], "]"}], "/", 
            RowBox[{"(", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"q", "[", "1", "]"}], "^", 
               RowBox[{"(", 
                RowBox[{"3", "/", "8"}], ")"}]}], 
              RowBox[{
               RowBox[{"q", "[", "2", "]"}], "^", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "/", "8"}], ")"}]}], 
              RowBox[{
               RowBox[{"q", "[", "3", "]"}], "^", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "/", "4"}], ")"}]}]}], 
             "\[IndentingNewLine]", ")"}]}], "/.", "diffSubs"}], "/.", 
          "qSubs"}], "]"}], "/.", 
        RowBox[{
         RowBox[{"q", "[", "i_", "]"}], "\[RuleDelayed]", 
         RowBox[{"\[CurlyEpsilon]", "*", 
          RowBox[{"q", "[", "i", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "2"}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"PowerExpand", "[", 
    RowBox[{"Limit", "[", 
     RowBox[{"%", ",", 
      RowBox[{
       RowBox[{"z", "[", "2", "]"}], "\[Rule]", "Infinity"}]}], "]"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"nwFMinusGoal", "=", 
    RowBox[{
     RowBox[{"Collect", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"%", "*", "2", "*", 
        RowBox[{"(", 
         RowBox[{"32", 
          RowBox[{
           RowBox[{"Sqrt", "[", "2", "]"}], "/", 
           RowBox[{"(", 
            RowBox[{"128", "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "^", 
              RowBox[{"(", 
               RowBox[{"1", "/", "8"}], ")"}]}]}], ")"}]}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", "\t", "\[CurlyEpsilon]", ",", 
       "\[IndentingNewLine]", "\t", "Factor"}], "\[IndentingNewLine]", "]"}], 
     "/.", 
     RowBox[{"\[CurlyEpsilon]", "\[Rule]", "1"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.65922300817305*^9, 3.6592230160699453`*^9}, {
  3.659223069024765*^9, 3.659223165728507*^9}, {3.6592250533710117`*^9, 
  3.659225080088296*^9}, {3.659225113962357*^9, 3.6592251290259666`*^9}, {
  3.6592251847360764`*^9, 3.659225185073245*^9}, {3.659225357739972*^9, 
  3.659225358075924*^9}, {3.6592800663944817`*^9, 3.659280066539658*^9}, {
  3.65928029995507*^9, 3.6592804327169123`*^9}, {3.6592804715754128`*^9, 
  3.65928050548582*^9}, {3.659283734160543*^9, 3.6592837406477013`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "128"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"128", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], 
      RowBox[{"1", "/", "8"}]], " ", 
     SqrtBox["2"]}], "+", 
    RowBox[{"32", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], 
      RowBox[{"1", "/", "8"}]], " ", 
     SqrtBox["2"], " ", "\[CurlyEpsilon]", " ", 
     RowBox[{"q", "[", "1", "]"}]}], "+", 
    RowBox[{"18", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], 
      RowBox[{"1", "/", "8"}]], " ", 
     SqrtBox["2"], " ", 
     SuperscriptBox["\[CurlyEpsilon]", "2"], " ", 
     SuperscriptBox[
      RowBox[{"q", "[", "1", "]"}], "2"]}], "-", 
    RowBox[{"48", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], 
      RowBox[{"1", "/", "8"}]], " ", 
     SqrtBox["2"], " ", "\[CurlyEpsilon]", " ", 
     RowBox[{"q", "[", "2", "]"}]}], "+", 
    RowBox[{"20", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], 
      RowBox[{"1", "/", "8"}]], " ", 
     SqrtBox["2"], " ", 
     SuperscriptBox["\[CurlyEpsilon]", "2"], " ", 
     RowBox[{"q", "[", "1", "]"}], " ", 
     RowBox[{"q", "[", "2", "]"}]}], "-", 
    RowBox[{"15", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], 
      RowBox[{"1", "/", "8"}]], " ", 
     SqrtBox["2"], " ", 
     SuperscriptBox["\[CurlyEpsilon]", "2"], " ", 
     SuperscriptBox[
      RowBox[{"q", "[", "2", "]"}], "2"]}], "+", 
    RowBox[{"16", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], 
      RowBox[{"1", "/", "8"}]], " ", 
     SqrtBox["2"], " ", 
     SuperscriptBox["\[CurlyEpsilon]", "2"], " ", 
     SuperscriptBox[
      RowBox[{"q", "[", "3", "]"}], "2"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.659223011971643*^9, 3.659223016651572*^9}, {
   3.6592230711059217`*^9, 3.659223167407003*^9}, 3.659225083094543*^9, {
   3.659225114626416*^9, 3.65922512977919*^9}, 3.6592251869567537`*^9, 
   3.659225359683921*^9, 3.6592254116285686`*^9, 3.659280080543289*^9, 
   3.659280236377129*^9, {3.659280327394614*^9, 3.65928035472746*^9}, {
   3.659280397126741*^9, 3.6592804073787727`*^9}, {3.659280472619587*^9, 
   3.6592805058755817`*^9}, 3.6592837412310743`*^9}],

Cell[BoxData[
 RowBox[{"1", "+", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"q", "[", "1", "]"}]}], "-", 
     RowBox[{"3", " ", 
      RowBox[{"q", "[", "2", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "128"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"18", " ", 
      SuperscriptBox[
       RowBox[{"q", "[", "1", "]"}], "2"]}], "+", 
     RowBox[{"20", " ", 
      RowBox[{"q", "[", "1", "]"}], " ", 
      RowBox[{"q", "[", "2", "]"}]}], "-", 
     RowBox[{"15", " ", 
      SuperscriptBox[
       RowBox[{"q", "[", "2", "]"}], "2"]}], "+", 
     RowBox[{"16", " ", 
      SuperscriptBox[
       RowBox[{"q", "[", "3", "]"}], "2"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.659223011971643*^9, 3.659223016651572*^9}, {
   3.6592230711059217`*^9, 3.659223167407003*^9}, 3.659225083094543*^9, {
   3.659225114626416*^9, 3.65922512977919*^9}, 3.6592251869567537`*^9, 
   3.659225359683921*^9, 3.6592254116285686`*^9, 3.659280080543289*^9, 
   3.659280236377129*^9, {3.659280327394614*^9, 3.65928035472746*^9}, {
   3.659280397126741*^9, 3.6592804073787727`*^9}, {3.659280472619587*^9, 
   3.6592805058755817`*^9}, 3.6592837412419453`*^9}]
}, Open  ]],

Cell["\<\
Matches result quoted in PRD, up to weirdo numerical prefactors...\
\>", "Text",
 CellChangeTimes->{{3.659280540525928*^9, 3.659280557658894*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Santachiara/Tanzini (not working)", "Subsection",
 CellChangeTimes->{{3.659222381737162*^9, 3.659222388824551*^9}, {
  3.659281562049325*^9, 3.659281564175746*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"st\[CapitalDelta]s", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "/", "16"}], ",", 
     RowBox[{"1", "/", "16"}], ",", 
     RowBox[{"1", "/", "16"}], ",", 
     RowBox[{"1", "/", "16"}], ",", 
     RowBox[{"1", "/", "2"}], ",", 
     RowBox[{"1", "/", "2"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"st\[CapitalDelta]intsPlus", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"1", "/", "16"}], ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"st\[CapitalDelta]intsMinus", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "/", "2"}], ",", 
     RowBox[{"1", "/", "16"}], ",", "0"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6592244256981983`*^9, 3.659224482003252*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[CapitalDelta]sto\[Delta]s", "[", 
  RowBox[{"st\[CapitalDelta]s", ",", "st\[CapitalDelta]intsPlus"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"q\[Delta]Product", "[", 
  RowBox[{"st\[CapitalDelta]s", ",", "st\[CapitalDelta]intsPlus"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"\[CapitalDelta]sto\[Delta]s", "[", 
  RowBox[{"st\[CapitalDelta]s", ",", "st\[CapitalDelta]intsMinus"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"q\[Delta]Product", "[", 
  RowBox[{"st\[CapitalDelta]s", ",", "st\[CapitalDelta]intsMinus"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.659224466333053*^9, 3.6592244773230247`*^9}, {
  3.659224591748395*^9, 3.65922462812971*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "8"]}], ",", 
   RowBox[{"-", 
    FractionBox["1", "8"]}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.6592244777243347`*^9, 3.6592244841737337`*^9}, {
  3.6592245987392263`*^9, 3.659224628589993*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", 
    SuperscriptBox[
     RowBox[{"q", "[", "1", "]"}], 
     RowBox[{"1", "/", "8"}]]], ",", 
   FractionBox["1", 
    SuperscriptBox[
     RowBox[{"q", "[", "2", "]"}], 
     RowBox[{"1", "/", "8"}]]], ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{{3.6592244777243347`*^9, 3.6592244841737337`*^9}, {
  3.6592245987392263`*^9, 3.659224628599743*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["3", "8"], ",", 
   RowBox[{"-", 
    FractionBox["1", "8"]}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.6592244777243347`*^9, 3.6592244841737337`*^9}, {
  3.6592245987392263`*^9, 3.659224628605914*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"q", "[", "1", "]"}], 
    RowBox[{"3", "/", "8"}]], ",", 
   FractionBox["1", 
    SuperscriptBox[
     RowBox[{"q", "[", "2", "]"}], 
     RowBox[{"1", "/", "8"}]]], ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{{3.6592244777243347`*^9, 3.6592244841737337`*^9}, {
  3.6592245987392263`*^9, 3.659224628612915*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"1", "+", 
     RowBox[{"(", 
      RowBox[{"3", "/", 
       RowBox[{"(", 
        RowBox[{"2", 
         RowBox[{"b", "^", "2"}]}], ")"}]}], ")"}]}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"3", "/", "2"}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{"1", "/", 
       RowBox[{"b", "^", "2"}]}], ")"}]}]}], "}"}], "/.", 
  RowBox[{"b", "\[Rule]", 
   RowBox[{"2", 
    RowBox[{"I", "/", 
     RowBox[{"Sqrt", "[", "3", "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{
  3.659221590244906*^9, {3.659221629246427*^9, 3.659221650343693*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "8"]}], ",", 
   FractionBox["3", "4"]}], "}"}]], "Output",
 CellChangeTimes->{3.659221651136346*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Factor", "@", "1"}], "/", 
   RowBox[{"u1Factor", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "16"}], ",", 
       RowBox[{"1", "/", "16"}], ",", 
       RowBox[{"1", "/", "16"}], ",", 
       RowBox[{"1", "/", "16"}], ",", 
       RowBox[{"1", "/", "2"}], ",", 
       RowBox[{"1", "/", "2"}]}], "}"}], ",", "b"}], "]"}]}], "/.", 
  RowBox[{"b", "\[Rule]", 
   RowBox[{"2", 
    RowBox[{"I", "/", 
     RowBox[{"Sqrt", "[", "3", "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.659221547788389*^9, 3.6592215519700413`*^9}, {
  3.659221594295504*^9, 3.659221622183867*^9}, {3.659223550830678*^9, 
  3.659223558028064*^9}}],

Cell[BoxData[
 RowBox[{"1", "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"q", "[", "1", "]"}]}], ")"}], 
     RowBox[{"1", "/", "8"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"q", "[", "2", "]"}]}], ")"}], 
     RowBox[{"1", "/", "8"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"q", "[", "1", "]"}], " ", 
        RowBox[{"q", "[", "2", "]"}]}]}], ")"}], 
     RowBox[{"1", "/", "8"}]], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      RowBox[{"q", "[", "3", "]"}]}]], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      RowBox[{
       RowBox[{"q", "[", "2", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}]}]}]], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      RowBox[{
       RowBox[{"q", "[", "1", "]"}], " ", 
       RowBox[{"q", "[", "2", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}]}]}]]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.659221552729059*^9, {3.659221598771649*^9, 3.659221622685995*^9}, {
   3.659223551913785*^9, 3.65922355850244*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"IntegerCompositions", "[", "2", "]"}]], "Input",
 CellChangeTimes->{{3.659221723445447*^9, 3.659221726300198*^9}, {
  3.659221764685215*^9, 3.6592217663179417`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "2", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.659221766816586*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"stupid", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "2"}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.659221803636911*^9, 3.659221835402923*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"spin4e2Fplus", "=", "\[IndentingNewLine]", 
  RowBox[{"Collect", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PowerExpand", "@", " ", 
     RowBox[{"Factor", "[", 
      RowBox[{"Total", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"q", "[", "1", "]"}], "^", "#1"}], "*", 
           RowBox[{
            RowBox[{"q", "[", "2", "]"}], "^", "#2"}], "*", 
           RowBox[{
            RowBox[{"q", "[", "3", "]"}], "^", "#3"}], "*", 
           "\[IndentingNewLine]", 
           RowBox[{"Simplify", "@", "  ", 
            RowBox[{"afltZk", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}], ",", 
              "\[IndentingNewLine]", "st\[CapitalDelta]s", ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"1", "/", "16"}], ",", "0"}], "}"}], ",", 
              "\[IndentingNewLine]", "b"}], "]"}]}]}], "&"}], ")"}], "@@@", 
        " ", "stupid"}], "\[IndentingNewLine]", "]"}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"q", "[", "_", "]"}], ",", "\[IndentingNewLine]", "Factor"}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{"b", "\[Rule]", 
   RowBox[{"2", 
    RowBox[{"I", "/", 
     RowBox[{"Sqrt", "[", "3", "]"}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.659225776037682*^9, 3.659225832308928*^9}, {
  3.6592258650353737`*^9, 3.6592259273676033`*^9}}],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   RowBox[{"3", " ", 
    RowBox[{"(", 
     RowBox[{"7", "+", 
      RowBox[{"15", " ", 
       SuperscriptBox["b", "2"]}], "+", 
      RowBox[{"7", " ", 
       SuperscriptBox["b", "4"]}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "1", "]"}], "2"]}], 
   RowBox[{"64", " ", 
    RowBox[{"(", 
     RowBox[{"3", "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["b", "2"]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["b", "2"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["b", "2"], "-", 
      SqrtBox[
       RowBox[{"1", "+", 
        SuperscriptBox["b", "4"]}]]}], ")"}], " ", 
    RowBox[{"q", "[", "3", "]"}]}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["b", "2"]}], "+", 
      SqrtBox[
       RowBox[{"4", "+", 
        RowBox[{"7", " ", 
         SuperscriptBox["b", "2"]}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["b", "4"]}]}]]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["b", "2"], "-", 
      SqrtBox[
       RowBox[{"1", "+", 
        SuperscriptBox["b", "4"]}]]}], ")"}], " ", 
    RowBox[{"q", "[", "2", "]"}], " ", 
    RowBox[{"q", "[", "3", "]"}]}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["b", "2"]}], "+", 
      SqrtBox[
       RowBox[{"4", "+", 
        RowBox[{"7", " ", 
         SuperscriptBox["b", "2"]}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["b", "4"]}]}]]}], ")"}]}]], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"12", "+", 
       RowBox[{"38", " ", 
        SuperscriptBox["b", "2"]}], "+", 
       RowBox[{"52", " ", 
        SuperscriptBox["b", "4"]}], "+", 
       RowBox[{"52", " ", 
        SuperscriptBox["b", "6"]}], "+", 
       RowBox[{"38", " ", 
        SuperscriptBox["b", "8"]}], "+", 
       RowBox[{"12", " ", 
        SuperscriptBox["b", "10"]}], "-", 
       RowBox[{"12", " ", 
        SqrtBox[
         RowBox[{"1", "+", 
          SuperscriptBox["b", "4"]}]]}], "-", 
       RowBox[{"38", " ", 
        SuperscriptBox["b", "2"], " ", 
        SqrtBox[
         RowBox[{"1", "+", 
          SuperscriptBox["b", "4"]}]]}], "-", 
       RowBox[{"50", " ", 
        SuperscriptBox["b", "4"], " ", 
        SqrtBox[
         RowBox[{"1", "+", 
          SuperscriptBox["b", "4"]}]]}], "-", 
       RowBox[{"38", " ", 
        SuperscriptBox["b", "6"], " ", 
        SqrtBox[
         RowBox[{"1", "+", 
          SuperscriptBox["b", "4"]}]]}], "-", 
       RowBox[{"12", " ", 
        SuperscriptBox["b", "8"], " ", 
        SqrtBox[
         RowBox[{"1", "+", 
          SuperscriptBox["b", "4"]}]]}], "+", 
       RowBox[{"6", " ", 
        SqrtBox[
         RowBox[{"4", "+", 
          RowBox[{"7", " ", 
           SuperscriptBox["b", "2"]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["b", "4"]}]}]]}], "+", 
       RowBox[{"19", " ", 
        SuperscriptBox["b", "2"], " ", 
        SqrtBox[
         RowBox[{"4", "+", 
          RowBox[{"7", " ", 
           SuperscriptBox["b", "2"]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["b", "4"]}]}]]}], "+", 
       RowBox[{"24", " ", 
        SuperscriptBox["b", "4"], " ", 
        SqrtBox[
         RowBox[{"4", "+", 
          RowBox[{"7", " ", 
           SuperscriptBox["b", "2"]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["b", "4"]}]}]]}], "+", 
       RowBox[{"19", " ", 
        SuperscriptBox["b", "6"], " ", 
        SqrtBox[
         RowBox[{"4", "+", 
          RowBox[{"7", " ", 
           SuperscriptBox["b", "2"]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["b", "4"]}]}]]}], "+", 
       RowBox[{"6", " ", 
        SuperscriptBox["b", "8"], " ", 
        SqrtBox[
         RowBox[{"4", "+", 
          RowBox[{"7", " ", 
           SuperscriptBox["b", "2"]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["b", "4"]}]}]]}], "-", 
       RowBox[{"6", " ", 
        SqrtBox[
         RowBox[{"1", "+", 
          SuperscriptBox["b", "4"]}]], " ", 
        SqrtBox[
         RowBox[{"4", "+", 
          RowBox[{"7", " ", 
           SuperscriptBox["b", "2"]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["b", "4"]}]}]]}], "-", 
       RowBox[{"19", " ", 
        SuperscriptBox["b", "2"], " ", 
        SqrtBox[
         RowBox[{"1", "+", 
          SuperscriptBox["b", "4"]}]], " ", 
        SqrtBox[
         RowBox[{"4", "+", 
          RowBox[{"7", " ", 
           SuperscriptBox["b", "2"]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["b", "4"]}]}]]}], "-", 
       RowBox[{"19", " ", 
        SuperscriptBox["b", "4"], " ", 
        SqrtBox[
         RowBox[{"1", "+", 
          SuperscriptBox["b", "4"]}]], " ", 
        SqrtBox[
         RowBox[{"4", "+", 
          RowBox[{"7", " ", 
           SuperscriptBox["b", "2"]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["b", "4"]}]}]]}], "-", 
       RowBox[{"6", " ", 
        SuperscriptBox["b", "6"], " ", 
        SqrtBox[
         RowBox[{"1", "+", 
          SuperscriptBox["b", "4"]}]], " ", 
        SqrtBox[
         RowBox[{"4", "+", 
          RowBox[{"7", " ", 
           SuperscriptBox["b", "2"]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["b", "4"]}]}]]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"q", "[", "3", "]"}], "2"]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"16", " ", 
     SuperscriptBox["b", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"3", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["b", "2"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["b", "2"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["b", "2"]}], "+", 
       SqrtBox[
        RowBox[{"4", "+", 
         RowBox[{"7", " ", 
          SuperscriptBox["b", "2"]}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["b", "4"]}]}]]}], ")"}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"q", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "8"]}], "-", 
     FractionBox[
      RowBox[{"q", "[", "2", "]"}], "8"], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox["b", "2"], "-", 
         SqrtBox[
          RowBox[{"1", "+", 
           SuperscriptBox["b", "4"]}]]}], ")"}], " ", 
       RowBox[{"q", "[", "3", "]"}]}], 
      RowBox[{"32", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["b", "2"]}], "+", 
         SqrtBox[
          RowBox[{"4", "+", 
           RowBox[{"7", " ", 
            SuperscriptBox["b", "2"]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["b", "4"]}]}]]}], ")"}]}]]}], ")"}]}]}]], "Output",\

 CellChangeTimes->{{3.659225781118806*^9, 3.6592257922892647`*^9}, 
   3.659225832933165*^9, {3.659225901373417*^9, 3.659225927992648*^9}}],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   RowBox[{"5", " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "1", "]"}], "2"]}], "128"], "+", 
  RowBox[{
   RowBox[{"q", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "8"]}], "-", 
     FractionBox[
      RowBox[{"q", "[", "2", "]"}], "8"], "+", 
     FractionBox[
      RowBox[{"q", "[", "3", "]"}], "32"]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"q", "[", "3", "]"}], "4"], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"q", "[", "2", "]"}], " ", 
   RowBox[{"q", "[", "3", "]"}]}], "+", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"q", "[", "3", "]"}], "2"], "32"]}]], "Output",
 CellChangeTimes->{{3.659225781118806*^9, 3.6592257922892647`*^9}, 
   3.659225832933165*^9, {3.659225901373417*^9, 3.659225928003972*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"3", "/", 
     RowBox[{"(", 
      RowBox[{"2", 
       RowBox[{"b", "^", "2"}]}], ")"}]}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"3", "/", "2"}], ")"}], "+", 
     RowBox[{"1", "/", 
      RowBox[{"b", "^", "2"}]}]}]}], "}"}], "/.", 
  RowBox[{"b", "\[Rule]", 
   RowBox[{"2", 
    RowBox[{"I", "/", 
     RowBox[{"Sqrt", "[", "3", "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.659225960088662*^9, 3.659226009529766*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["9", "8"]}], ",", 
   FractionBox["3", "4"]}], "}"}]], "Output",
 CellChangeTimes->{3.659225970853005*^9, 3.659226009913063*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"spin4e2Fminus", "=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Expand", "@", " ", 
     RowBox[{"Factor", "[", 
      RowBox[{"Total", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"q", "[", "1", "]"}], "^", "#1"}], "*", 
           RowBox[{
            RowBox[{"q", "[", "2", "]"}], "^", "#2"}], "*", 
           RowBox[{
            RowBox[{"q", "[", "3", "]"}], "^", "#3"}], "*", 
           "\[IndentingNewLine]", 
           RowBox[{"Simplify", "@", "  ", 
            RowBox[{"afltZk", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}], ",", 
              "\[IndentingNewLine]", "st\[CapitalDelta]s", ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "/", "2"}], ",", 
                RowBox[{"1", "/", "16"}], ",", "0"}], "}"}], ",", 
              "\[IndentingNewLine]", "b"}], "]"}]}]}], "&"}], ")"}], "@@@", 
        " ", "stupid"}], "\[IndentingNewLine]", "]"}], "]"}]}], "/.", 
    RowBox[{"b", "\[Rule]", 
     RowBox[{"2", 
      RowBox[{"I", "/", 
       RowBox[{"Sqrt", "[", "3", "]"}]}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.6591499575457706`*^9, 3.6591499651442966`*^9}, {
  3.659150010735661*^9, 3.659150059988249*^9}, {3.65922184157067*^9, 
  3.6592218804369383`*^9}, {3.659221914504017*^9, 3.659221973857492*^9}, {
  3.659225753260119*^9, 3.659225769751608*^9}}],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   RowBox[{"q", "[", "1", "]"}], "8"], "-", 
  FractionBox[
   RowBox[{"5", " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "1", "]"}], "2"]}], "128"], "-", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"q", "[", "1", "]"}], " ", 
   RowBox[{"q", "[", "2", "]"}]}], "-", 
  FractionBox[
   RowBox[{"q", "[", "3", "]"}], "2"], "+", 
  RowBox[{
   FractionBox["1", "16"], " ", 
   RowBox[{"q", "[", "1", "]"}], " ", 
   RowBox[{"q", "[", "3", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"q", "[", "2", "]"}], " ", 
   RowBox[{"q", "[", "3", "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.659150056787754*^9, 3.659150743018545*^9, 3.659221881630616*^9, {
   3.659221915993052*^9, 3.6592219745583963`*^9}, 3.6592257619896307`*^9}],

Cell[BoxData[
 RowBox[{"1", "+", 
  FractionBox[
   RowBox[{"q", "[", "1", "]"}], "8"], "+", 
  FractionBox[
   RowBox[{"7", " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "1", "]"}], "2"]}], "128"], "-", 
  FractionBox[
   RowBox[{"q", "[", "2", "]"}], "2"], "+", 
  RowBox[{
   FractionBox["1", "16"], " ", 
   RowBox[{"q", "[", "1", "]"}], " ", 
   RowBox[{"q", "[", "2", "]"}]}], "-", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"q", "[", "2", "]"}], "2"], "8"], "-", 
  FractionBox[
   RowBox[{"q", "[", "3", "]"}], "2"], "-", 
  RowBox[{
   FractionBox["1", "16"], " ", 
   RowBox[{"q", "[", "1", "]"}], " ", 
   RowBox[{"q", "[", "3", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"q", "[", "2", "]"}], " ", 
   RowBox[{"q", "[", "3", "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.659150056787754*^9, 3.659150743018545*^9, 3.659221881630616*^9, {
   3.659221915993052*^9, 3.6592219745583963`*^9}, 3.6592257622998953`*^9}]
}, Open  ]],

Cell["\<\
Descendant level\[CloseCurlyQuote]s GOT to be conserved under fusion with any \
primary, right? Would cut down set of partitions a whole lot...\
\>", "Text",
 CellChangeTimes->{{3.659150235557403*^9, 3.659150269602612*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Santachiara/Tanzini 2 (working)", "Subsection",
 CellChangeTimes->{{3.659281568974168*^9, 3.659281569902936*^9}, {
  3.659284155447782*^9, 3.659284157022377*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"stExts", "=", 
   RowBox[{"Join", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", "4"}], "]"}], ",", "\n", "\t", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "1"}], "}"}], ",", "2"}], "]"}]}], "\n", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stIntsPlus", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stIntsMinus", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.6592244256981983`*^9, 3.659224482003252*^9}, {
  3.659281639372052*^9, 3.659281729438632*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stupid", " ", "=", " ", 
   RowBox[{"{", "\n", "\t", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", "\n", "\t", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "2"}], "}"}]}], "\n", "}"}]}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.659221803636911*^9, 3.659221835402923*^9}, {
  3.659281611989304*^9, 3.659281620369504*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"spin4e2Fplus", "=", "\[IndentingNewLine]", 
   RowBox[{"Collect", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PowerExpand", "@", " ", 
      RowBox[{"Factor", "[", 
       RowBox[{"Total", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"q", "[", "1", "]"}], "^", "#1"}], "*", 
            RowBox[{
             RowBox[{"q", "[", "2", "]"}], "^", "#2"}], "*", 
            RowBox[{
             RowBox[{"q", "[", "3", "]"}], "^", "#3"}], "*", 
            "\[IndentingNewLine]", 
            RowBox[{"Simplify", "@", "  ", 
             RowBox[{"afltZkDegen", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}], ",", 
               "\[IndentingNewLine]", "stExts", ",", "\[IndentingNewLine]", 
               RowBox[{"stIntsPlus", "+", "\[Delta]"}], ",", 
               "\[IndentingNewLine]", "b"}], "]"}]}]}], "&"}], ")"}], "@@@", 
         " ", "stupid"}], "\[IndentingNewLine]", "]"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"q", "[", "_", "]"}], ",", "\[IndentingNewLine]", "Factor"}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"stFPlus", "=", 
  RowBox[{"Limit", "[", 
   RowBox[{"spin4e2Fplus", ",", 
    RowBox[{"\[Delta]", "\[Rule]", "0"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Collect", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"stFPlus", "/.", 
    RowBox[{
     RowBox[{"q", "[", "i_", "]"}], "\[RuleDelayed]", 
     RowBox[{"\[CurlyEpsilon]", "*", 
      RowBox[{"q", "[", "i", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"q", "[", "_", "]"}], ",", "\[IndentingNewLine]", "Factor"}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.659225776037682*^9, 3.659225832308928*^9}, {
   3.6592258650353737`*^9, 3.6592259273676033`*^9}, {3.6592817351876287`*^9, 
   3.659281757732589*^9}, 3.6592817934192743`*^9, {3.659283445088912*^9, 
   3.659283445526524*^9}, {3.659283604242425*^9, 3.659283605073777*^9}, {
   3.659283819669854*^9, 3.6592838262712717`*^9}, {3.659284059000996*^9, 
   3.659284081827848*^9}, {3.659284207234405*^9, 3.6592842276712723`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"4", " ", 
    SuperscriptBox["b", "4"], " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["b", "2"]}]}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", 
        RowBox[{"q", "[", "1", "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"q", "[", "3", "]"}]}]}], ")"}], "2"], "+", 
    RowBox[{"6", " ", 
     SuperscriptBox["b", "6"], " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"q", "[", "1", "]"}], "2"]}], "+", 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"q", "[", "2", "]"}]}], ")"}], " ", 
        RowBox[{"q", "[", "3", "]"}]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{"q", "[", "3", "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"q", "[", "1", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{"2", " ", 
           RowBox[{"q", "[", "2", "]"}]}], "+", 
          RowBox[{"3", " ", 
           RowBox[{"q", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["b", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"33", " ", 
        SuperscriptBox[
         RowBox[{"q", "[", "1", "]"}], "2"]}], "+", 
       RowBox[{"4", " ", 
        RowBox[{"q", "[", "1", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"3", " ", 
           RowBox[{"q", "[", "2", "]"}]}], "+", 
          RowBox[{"11", " ", 
           RowBox[{"q", "[", "3", "]"}]}]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"q", "[", "3", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"4", "+", 
          RowBox[{"4", " ", 
           RowBox[{"q", "[", "2", "]"}]}], "+", 
          RowBox[{"11", " ", 
           RowBox[{"q", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["b", "4"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"36", " ", 
        SuperscriptBox[
         RowBox[{"q", "[", "1", "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"q", "[", "1", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"26", "+", 
          RowBox[{"26", " ", 
           RowBox[{"q", "[", "2", "]"}]}], "+", 
          RowBox[{"51", " ", 
           RowBox[{"q", "[", "3", "]"}]}]}], ")"}]}], "+", 
       RowBox[{"8", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"3", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"q", "[", "2", "]"}]}], ")"}], " ", 
           RowBox[{"q", "[", "3", "]"}]}], "+", 
          RowBox[{"5", " ", 
           SuperscriptBox[
            RowBox[{"q", "[", "3", "]"}], "2"]}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.659281762172875*^9, 3.6592817946625566`*^9}, 
   3.659283399072679*^9, 3.6592834463202763`*^9, 3.659283485958149*^9, 
   3.659283610694581*^9, 3.659283827453876*^9, {3.6592840645719213`*^9, 
   3.659284082280512*^9}, {3.659284208540584*^9, 3.659284229324573*^9}}],

Cell[BoxData[
 RowBox[{"1", "+", 
  FractionBox[
   RowBox[{"3", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["b", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["b", "2"]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"3", "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["b", "2"]}]}], ")"}], " ", 
    SuperscriptBox["\[CurlyEpsilon]", "2"], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "1", "]"}], "2"]}], 
   RowBox[{"4", " ", 
    SuperscriptBox["b", "4"], " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["b", "2"]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["b", "2"]}]}], ")"}], " ", "\[CurlyEpsilon]", " ", 
    RowBox[{"q", "[", "3", "]"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["b", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["b", "2"]}]}], ")"}], " ", 
    SuperscriptBox["\[CurlyEpsilon]", "2"], " ", 
    RowBox[{"q", "[", "2", "]"}], " ", 
    RowBox[{"q", "[", "3", "]"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["b", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["b", "2"]}]}], ")"}], "2"], " ", 
    SuperscriptBox["\[CurlyEpsilon]", "2"], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "3", "]"}], "2"]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["b", "4"]}]], "+", 
  RowBox[{
   RowBox[{"q", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"3", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["b", "2"]}]}], ")"}], " ", "\[CurlyEpsilon]"}], 
      RowBox[{"2", " ", 
       SuperscriptBox["b", "2"]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"3", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["b", "2"]}]}], ")"}], " ", 
       SuperscriptBox["\[CurlyEpsilon]", "2"], " ", 
       RowBox[{"q", "[", "2", "]"}]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["b", "2"]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"3", "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["b", "2"]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{"3", " ", 
          SuperscriptBox["b", "2"]}]}], ")"}], " ", 
       SuperscriptBox["\[CurlyEpsilon]", "2"], " ", 
       RowBox[{"q", "[", "3", "]"}]}], 
      RowBox[{"4", " ", 
       SuperscriptBox["b", "4"]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.659281762172875*^9, 3.6592817946625566`*^9}, 
   3.659283399072679*^9, 3.6592834463202763`*^9, 3.659283485958149*^9, 
   3.659283610694581*^9, 3.659283827453876*^9, {3.6592840645719213`*^9, 
   3.659284082280512*^9}, {3.659284208540584*^9, 3.659284229336623*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Factor", "/@", 
  RowBox[{"Series", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"q", "[", "1", "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"q", "[", "2", "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{
             RowBox[{"q", "[", "1", "]"}], 
             RowBox[{"q", "[", "2", "]"}]}]}], ")"}]}], ")"}], "^", 
        "\[Chi]1"}], "*", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"q", "[", "3", "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{
             RowBox[{"q", "[", "2", "]"}], 
             RowBox[{"q", "[", "3", "]"}]}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{
             RowBox[{"q", "[", "1", "]"}], 
             RowBox[{"q", "[", "2", "]"}], 
             RowBox[{"q", "[", "3", "]"}]}]}], ")"}]}], ")"}], "^", 
        "\[Chi]2"}], "*", "\[IndentingNewLine]", "stFPlus"}], "/.", 
      RowBox[{"b", "\[Rule]", "bIsing"}]}], "/.", 
     RowBox[{
      RowBox[{"q", "[", "i_", "]"}], "\[RuleDelayed]", 
      RowBox[{"\[CurlyEpsilon]", "*", 
       RowBox[{"q", "[", "i", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "2"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Collect", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"%", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Chi]1", "\[Rule]", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "8"}]}], ",", 
      RowBox[{"\[Chi]2", "\[Rule]", 
       RowBox[{"3", "/", "4"}]}]}], "}"}]}], ",", "\[IndentingNewLine]", 
   "\[CurlyEpsilon]", ",", "\[IndentingNewLine]", "Factor"}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.659283864634491*^9, 3.659284005967683*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "+", 
   RowBox[{
    FractionBox["1", "8"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"q", "[", "1", "]"}]}], "-", 
      RowBox[{"8", " ", "\[Chi]1", " ", 
       RowBox[{"q", "[", "1", "]"}]}], "-", 
      RowBox[{"8", " ", "\[Chi]1", " ", 
       RowBox[{"q", "[", "2", "]"}]}], "+", 
      RowBox[{"6", " ", 
       RowBox[{"q", "[", "3", "]"}]}], "-", 
      RowBox[{"8", " ", "\[Chi]2", " ", 
       RowBox[{"q", "[", "3", "]"}]}]}], ")"}], " ", "\[CurlyEpsilon]"}], "+", 
   RowBox[{
    FractionBox["1", "128"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "5"}], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "1", "]"}], "2"]}], "-", 
      RowBox[{"48", " ", "\[Chi]1", " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "1", "]"}], "2"]}], "+", 
      RowBox[{"64", " ", 
       SuperscriptBox["\[Chi]1", "2"], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "1", "]"}], "2"]}], "-", 
      RowBox[{"16", " ", 
       RowBox[{"q", "[", "1", "]"}], " ", 
       RowBox[{"q", "[", "2", "]"}]}], "-", 
      RowBox[{"112", " ", "\[Chi]1", " ", 
       RowBox[{"q", "[", "1", "]"}], " ", 
       RowBox[{"q", "[", "2", "]"}]}], "+", 
      RowBox[{"128", " ", 
       SuperscriptBox["\[Chi]1", "2"], " ", 
       RowBox[{"q", "[", "1", "]"}], " ", 
       RowBox[{"q", "[", "2", "]"}]}], "-", 
      RowBox[{"64", " ", "\[Chi]1", " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "2", "]"}], "2"]}], "+", 
      RowBox[{"64", " ", 
       SuperscriptBox["\[Chi]1", "2"], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "2", "]"}], "2"]}], "-", 
      RowBox[{"12", " ", 
       RowBox[{"q", "[", "1", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}]}], "-", 
      RowBox[{"96", " ", "\[Chi]1", " ", 
       RowBox[{"q", "[", "1", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}]}], "+", 
      RowBox[{"16", " ", "\[Chi]2", " ", 
       RowBox[{"q", "[", "1", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}]}], "+", 
      RowBox[{"128", " ", "\[Chi]1", " ", "\[Chi]2", " ", 
       RowBox[{"q", "[", "1", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}]}], "+", 
      RowBox[{"96", " ", 
       RowBox[{"q", "[", "2", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}]}], "-", 
      RowBox[{"96", " ", "\[Chi]1", " ", 
       RowBox[{"q", "[", "2", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}]}], "-", 
      RowBox[{"128", " ", "\[Chi]2", " ", 
       RowBox[{"q", "[", "2", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}]}], "+", 
      RowBox[{"128", " ", "\[Chi]1", " ", "\[Chi]2", " ", 
       RowBox[{"q", "[", "2", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}]}], "+", 
      RowBox[{"100", " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "3", "]"}], "2"]}], "-", 
      RowBox[{"160", " ", "\[Chi]2", " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "3", "]"}], "2"]}], "+", 
      RowBox[{"64", " ", 
       SuperscriptBox["\[Chi]2", "2"], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "3", "]"}], "2"]}]}], ")"}], " ", 
    SuperscriptBox["\[CurlyEpsilon]", "2"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[CurlyEpsilon]", "]"}], "3"],
    SeriesData[$CellContext`\[CurlyEpsilon], 0, {}, 0, 3, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[CurlyEpsilon], 0, {
   1, Rational[1, 8] (-$CellContext`q[1] - 
     8 $CellContext`\[Chi]1 $CellContext`q[1] - 
     8 $CellContext`\[Chi]1 $CellContext`q[2] + 6 $CellContext`q[3] - 
     8 $CellContext`\[Chi]2 $CellContext`q[3]), 
    Rational[1, 128] ((-5) $CellContext`q[1]^2 - 
     48 $CellContext`\[Chi]1 $CellContext`q[1]^2 + 
     64 $CellContext`\[Chi]1^2 $CellContext`q[1]^2 - 
     16 $CellContext`q[1] $CellContext`q[2] - 
     112 $CellContext`\[Chi]1 $CellContext`q[1] $CellContext`q[2] + 
     128 $CellContext`\[Chi]1^2 $CellContext`q[1] $CellContext`q[2] - 
     64 $CellContext`\[Chi]1 $CellContext`q[2]^2 + 
     64 $CellContext`\[Chi]1^2 $CellContext`q[2]^2 - 
     12 $CellContext`q[1] $CellContext`q[3] - 
     96 $CellContext`\[Chi]1 $CellContext`q[1] $CellContext`q[3] + 
     16 $CellContext`\[Chi]2 $CellContext`q[1] $CellContext`q[3] + 
     128 $CellContext`\[Chi]1 $CellContext`\[Chi]2 $CellContext`q[
       1] $CellContext`q[3] + 96 $CellContext`q[2] $CellContext`q[3] - 
     96 $CellContext`\[Chi]1 $CellContext`q[2] $CellContext`q[3] - 
     128 $CellContext`\[Chi]2 $CellContext`q[2] $CellContext`q[3] + 
     128 $CellContext`\[Chi]1 $CellContext`\[Chi]2 $CellContext`q[
       2] $CellContext`q[3] + 100 $CellContext`q[3]^2 - 
     160 $CellContext`\[Chi]2 $CellContext`q[3]^2 + 
     64 $CellContext`\[Chi]2^2 $CellContext`q[3]^2)}, 0, 3, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.6592839045452967`*^9, 3.659283931075121*^9}, {
   3.65928399195984*^9, 3.65928400640919*^9}, 3.659284086082164*^9}],

Cell[BoxData[
 RowBox[{"1", "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[CurlyEpsilon]", " ", 
   RowBox[{"q", "[", "2", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "128"], " ", 
   SuperscriptBox["\[CurlyEpsilon]", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"q", "[", "1", "]"}], "2"]}], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox[
       RowBox[{"q", "[", "2", "]"}], "2"]}], "+", 
     RowBox[{"16", " ", 
      SuperscriptBox[
       RowBox[{"q", "[", "3", "]"}], "2"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.6592839045452967`*^9, 3.659283931075121*^9}, {
   3.65928399195984*^9, 3.65928400640919*^9}, 3.6592840860941467`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"1", "+", 
     RowBox[{"3", "/", 
      RowBox[{"(", 
       RowBox[{"2", 
        RowBox[{"b", "^", "2"}]}], ")"}]}]}], ",", 
    RowBox[{
     RowBox[{"3", "/", "2"}], "+", 
     RowBox[{"1", "/", 
      RowBox[{"b", "^", "2"}]}]}]}], "}"}], "/.", 
  RowBox[{"b", "\[Rule]", "bIsing"}]}]], "Input",
 CellChangeTimes->{{3.659284019179325*^9, 3.659284039446032*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "8"]}], ",", 
   FractionBox["3", "4"]}], "}"}]], "Output",
 CellChangeTimes->{3.659284040073937*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"spin4e2Fminus", "=", "\[IndentingNewLine]", 
   RowBox[{"Collect", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PowerExpand", "@", " ", 
      RowBox[{"Factor", "[", 
       RowBox[{"Total", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"q", "[", "1", "]"}], "^", "#1"}], "*", 
            RowBox[{
             RowBox[{"q", "[", "2", "]"}], "^", "#2"}], "*", 
            RowBox[{
             RowBox[{"q", "[", "3", "]"}], "^", "#3"}], "*", 
            "\[IndentingNewLine]", 
            RowBox[{"Simplify", "@", "  ", 
             RowBox[{"afltZkDegen", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}], ",", 
               "\[IndentingNewLine]", "stExts", ",", "\[IndentingNewLine]", 
               RowBox[{"stIntsMinus", "+", "\[Delta]"}], ",", 
               "\[IndentingNewLine]", "b"}], "]"}]}]}], "&"}], ")"}], "@@@", 
         " ", "stupid"}], "\[IndentingNewLine]", "]"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"q", "[", "_", "]"}], ",", "\[IndentingNewLine]", "Factor"}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"stFMinus", "=", 
  RowBox[{"Limit", "[", 
   RowBox[{"spin4e2Fminus", ",", 
    RowBox[{"\[Delta]", "\[Rule]", "0"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Collect", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"stFMinus", "/.", 
     RowBox[{"b", "\[Rule]", "bIsing"}]}], "/.", 
    RowBox[{
     RowBox[{"q", "[", "i_", "]"}], "\[RuleDelayed]", 
     RowBox[{"\[CurlyEpsilon]", "*", 
      RowBox[{"q", "[", "i", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
   "\[CurlyEpsilon]", ",", "\[IndentingNewLine]", "Factor"}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.659225776037682*^9, 3.659225832308928*^9}, {
   3.6592258650353737`*^9, 3.6592259273676033`*^9}, {3.6592817351876287`*^9, 
   3.659281757732589*^9}, 3.6592817934192743`*^9, {3.659283445088912*^9, 
   3.659283445526524*^9}, {3.659283604242425*^9, 3.659283605073777*^9}, {
   3.659283819669854*^9, 3.6592838262712717`*^9}, {3.659284059000996*^9, 
   3.659284124374051*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"4", " ", 
    SuperscriptBox["b", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "+", 
      SuperscriptBox["b", "2"]}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"q", "[", "1", "]"}], "+", 
        RowBox[{"4", " ", 
         RowBox[{"q", "[", "2", "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"q", "[", "3", "]"}]}]}], ")"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox["b", "6"], " ", 
     RowBox[{"(", 
      RowBox[{"4", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"q", "[", "1", "]"}], "2"]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{"q", "[", "2", "]"}], "2"]}], "+", 
       RowBox[{"6", " ", 
        RowBox[{"q", "[", "3", "]"}]}], "+", 
       RowBox[{"8", " ", 
        SuperscriptBox[
         RowBox[{"q", "[", "3", "]"}], "2"]}], "+", 
       RowBox[{"4", " ", 
        RowBox[{"q", "[", "2", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"3", " ", 
           RowBox[{"q", "[", "3", "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"q", "[", "1", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{"4", " ", 
           RowBox[{"q", "[", "2", "]"}]}], "+", 
          RowBox[{"3", " ", 
           RowBox[{"q", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["b", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"q", "[", "1", "]"}], "2"], "+", 
       RowBox[{"8", " ", 
        SuperscriptBox[
         RowBox[{"q", "[", "2", "]"}], "2"]}], "+", 
       RowBox[{"8", " ", 
        RowBox[{"q", "[", "2", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", 
           RowBox[{"q", "[", "3", "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"q", "[", "1", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{"6", " ", 
           RowBox[{"q", "[", "2", "]"}]}], "+", 
          RowBox[{"4", " ", 
           RowBox[{"q", "[", "3", "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"q", "[", "3", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"4", "+", 
          RowBox[{"7", " ", 
           RowBox[{"q", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["b", "4"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"q", "[", "1", "]"}], "2"], "-", 
       RowBox[{
        RowBox[{"q", "[", "1", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{"q", "[", "3", "]"}]}], ")"}]}], "+", 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"q", "[", "2", "]"}], "2"], "-", 
          RowBox[{
           RowBox[{"q", "[", "2", "]"}], " ", 
           RowBox[{"q", "[", "3", "]"}]}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"q", "[", "3", "]"}], "+", 
             SuperscriptBox[
              RowBox[{"q", "[", "3", "]"}], "2"]}], ")"}]}]}], ")"}]}]}], 
      ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.6592841255450897`*^9}],

Cell[BoxData[
 RowBox[{"1", "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[CurlyEpsilon]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"q", "[", "1", "]"}], "-", 
     RowBox[{"4", " ", 
      RowBox[{"q", "[", "2", "]"}]}], "+", 
     RowBox[{"6", " ", 
      RowBox[{"q", "[", "3", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "128"], " ", 
   SuperscriptBox["\[CurlyEpsilon]", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"7", " ", 
      SuperscriptBox[
       RowBox[{"q", "[", "1", "]"}], "2"]}], "+", 
     RowBox[{"8", " ", 
      RowBox[{"q", "[", "1", "]"}], " ", 
      RowBox[{"q", "[", "2", "]"}]}], "-", 
     RowBox[{"16", " ", 
      SuperscriptBox[
       RowBox[{"q", "[", "2", "]"}], "2"]}], "+", 
     RowBox[{"12", " ", 
      RowBox[{"q", "[", "1", "]"}], " ", 
      RowBox[{"q", "[", "3", "]"}]}], "+", 
     RowBox[{"48", " ", 
      RowBox[{"q", "[", "2", "]"}], " ", 
      RowBox[{"q", "[", "3", "]"}]}], "+", 
     RowBox[{"100", " ", 
      SuperscriptBox[
       RowBox[{"q", "[", "3", "]"}], "2"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.659284125551585*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Factor", "/@", 
  RowBox[{"Series", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"q", "[", "1", "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"q", "[", "2", "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{
             RowBox[{"q", "[", "1", "]"}], 
             RowBox[{"q", "[", "2", "]"}]}]}], ")"}]}], ")"}], "^", 
        "\[Chi]1"}], "*", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"q", "[", "3", "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{
             RowBox[{"q", "[", "2", "]"}], 
             RowBox[{"q", "[", "3", "]"}]}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{
             RowBox[{"q", "[", "1", "]"}], 
             RowBox[{"q", "[", "2", "]"}], 
             RowBox[{"q", "[", "3", "]"}]}]}], ")"}]}], ")"}], "^", 
        "\[Chi]2"}], "*", "\[IndentingNewLine]", "stFMinus"}], "/.", 
      RowBox[{"b", "\[Rule]", "bIsing"}]}], "/.", 
     RowBox[{
      RowBox[{"q", "[", "i_", "]"}], "\[RuleDelayed]", 
      RowBox[{"\[CurlyEpsilon]", "*", 
       RowBox[{"q", "[", "i", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "2"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Collect", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"%", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Chi]1", "\[Rule]", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "8"}]}], ",", 
      RowBox[{"\[Chi]2", "\[Rule]", 
       RowBox[{"3", "/", "4"}]}]}], "}"}]}], ",", "\[IndentingNewLine]", 
   "\[CurlyEpsilon]", ",", "\[IndentingNewLine]", "Factor"}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.659284135692519*^9, 3.659284137333949*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "+", 
   RowBox[{
    FractionBox["1", "8"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"q", "[", "1", "]"}], "-", 
      RowBox[{"8", " ", "\[Chi]1", " ", 
       RowBox[{"q", "[", "1", "]"}]}], "-", 
      RowBox[{"4", " ", 
       RowBox[{"q", "[", "2", "]"}]}], "-", 
      RowBox[{"8", " ", "\[Chi]1", " ", 
       RowBox[{"q", "[", "2", "]"}]}], "+", 
      RowBox[{"6", " ", 
       RowBox[{"q", "[", "3", "]"}]}], "-", 
      RowBox[{"8", " ", "\[Chi]2", " ", 
       RowBox[{"q", "[", "3", "]"}]}]}], ")"}], " ", "\[CurlyEpsilon]"}], "+", 
   RowBox[{
    FractionBox["1", "128"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"7", " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "1", "]"}], "2"]}], "-", 
      RowBox[{"80", " ", "\[Chi]1", " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "1", "]"}], "2"]}], "+", 
      RowBox[{"64", " ", 
       SuperscriptBox["\[Chi]1", "2"], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "1", "]"}], "2"]}], "+", 
      RowBox[{"8", " ", 
       RowBox[{"q", "[", "1", "]"}], " ", 
       RowBox[{"q", "[", "2", "]"}]}], "-", 
      RowBox[{"80", " ", "\[Chi]1", " ", 
       RowBox[{"q", "[", "1", "]"}], " ", 
       RowBox[{"q", "[", "2", "]"}]}], "+", 
      RowBox[{"128", " ", 
       SuperscriptBox["\[Chi]1", "2"], " ", 
       RowBox[{"q", "[", "1", "]"}], " ", 
       RowBox[{"q", "[", "2", "]"}]}], "-", 
      RowBox[{"16", " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "2", "]"}], "2"]}], "+", 
      RowBox[{"64", " ", 
       SuperscriptBox["\[Chi]1", "2"], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "2", "]"}], "2"]}], "+", 
      RowBox[{"12", " ", 
       RowBox[{"q", "[", "1", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}]}], "-", 
      RowBox[{"96", " ", "\[Chi]1", " ", 
       RowBox[{"q", "[", "1", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}]}], "-", 
      RowBox[{"16", " ", "\[Chi]2", " ", 
       RowBox[{"q", "[", "1", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}]}], "+", 
      RowBox[{"128", " ", "\[Chi]1", " ", "\[Chi]2", " ", 
       RowBox[{"q", "[", "1", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}]}], "+", 
      RowBox[{"48", " ", 
       RowBox[{"q", "[", "2", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}]}], "-", 
      RowBox[{"96", " ", "\[Chi]1", " ", 
       RowBox[{"q", "[", "2", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}]}], "-", 
      RowBox[{"64", " ", "\[Chi]2", " ", 
       RowBox[{"q", "[", "2", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}]}], "+", 
      RowBox[{"128", " ", "\[Chi]1", " ", "\[Chi]2", " ", 
       RowBox[{"q", "[", "2", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}]}], "+", 
      RowBox[{"100", " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "3", "]"}], "2"]}], "-", 
      RowBox[{"160", " ", "\[Chi]2", " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "3", "]"}], "2"]}], "+", 
      RowBox[{"64", " ", 
       SuperscriptBox["\[Chi]2", "2"], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "3", "]"}], "2"]}]}], ")"}], " ", 
    SuperscriptBox["\[CurlyEpsilon]", "2"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[CurlyEpsilon]", "]"}], "3"],
    SeriesData[$CellContext`\[CurlyEpsilon], 0, {}, 0, 3, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[CurlyEpsilon], 0, {
   1, Rational[1, 8] ($CellContext`q[1] - 
     8 $CellContext`\[Chi]1 $CellContext`q[1] - 4 $CellContext`q[2] - 
     8 $CellContext`\[Chi]1 $CellContext`q[2] + 6 $CellContext`q[3] - 
     8 $CellContext`\[Chi]2 $CellContext`q[3]), 
    Rational[1, 128] (7 $CellContext`q[1]^2 - 
     80 $CellContext`\[Chi]1 $CellContext`q[1]^2 + 
     64 $CellContext`\[Chi]1^2 $CellContext`q[1]^2 + 
     8 $CellContext`q[1] $CellContext`q[2] - 
     80 $CellContext`\[Chi]1 $CellContext`q[1] $CellContext`q[2] + 
     128 $CellContext`\[Chi]1^2 $CellContext`q[1] $CellContext`q[2] - 
     16 $CellContext`q[2]^2 + 64 $CellContext`\[Chi]1^2 $CellContext`q[2]^2 + 
     12 $CellContext`q[1] $CellContext`q[3] - 
     96 $CellContext`\[Chi]1 $CellContext`q[1] $CellContext`q[3] - 
     16 $CellContext`\[Chi]2 $CellContext`q[1] $CellContext`q[3] + 
     128 $CellContext`\[Chi]1 $CellContext`\[Chi]2 $CellContext`q[
       1] $CellContext`q[3] + 48 $CellContext`q[2] $CellContext`q[3] - 
     96 $CellContext`\[Chi]1 $CellContext`q[2] $CellContext`q[3] - 
     64 $CellContext`\[Chi]2 $CellContext`q[2] $CellContext`q[3] + 
     128 $CellContext`\[Chi]1 $CellContext`\[Chi]2 $CellContext`q[
       2] $CellContext`q[3] + 100 $CellContext`q[3]^2 - 
     160 $CellContext`\[Chi]2 $CellContext`q[3]^2 + 
     64 $CellContext`\[Chi]2^2 $CellContext`q[3]^2)}, 0, 3, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.659284138638773*^9}],

Cell[BoxData[
 RowBox[{"1", "+", 
  RowBox[{
   FractionBox["1", "8"], " ", "\[CurlyEpsilon]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"q", "[", "1", "]"}]}], "-", 
     RowBox[{"3", " ", 
      RowBox[{"q", "[", "2", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "128"], " ", 
   SuperscriptBox["\[CurlyEpsilon]", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"18", " ", 
      SuperscriptBox[
       RowBox[{"q", "[", "1", "]"}], "2"]}], "+", 
     RowBox[{"20", " ", 
      RowBox[{"q", "[", "1", "]"}], " ", 
      RowBox[{"q", "[", "2", "]"}]}], "-", 
     RowBox[{"15", " ", 
      SuperscriptBox[
       RowBox[{"q", "[", "2", "]"}], "2"]}], "+", 
     RowBox[{"16", " ", 
      SuperscriptBox[
       RowBox[{"q", "[", "3", "]"}], "2"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.659284138644291*^9}]
}, Open  ]],

Cell["\<\
OK so in ST\[CloseCurlyQuote]s notation, we\[CloseCurlyQuote]ve established \
that
Z_aflt * Z_U(1) \\propto Block/ q^\[Delta] factor.\
\>", "Text",
 CellChangeTimes->{{3.659284261803686*^9, 3.659284324826277*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "u1Factor", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"u1Factor", "[", 
    RowBox[{"\[Alpha]Exts_", ",", "b_"}], "]"}], ":=", "\n", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t", 
      RowBox[{
       RowBox[{"n", " ", "=", " ", 
        RowBox[{"Length", "[", "\[Alpha]Exts", "]"}]}], ",", "\n", "\t", 
       RowBox[{"Q", "=", " ", 
        RowBox[{"b", "+", " ", 
         RowBox[{"1", "/", "b"}]}]}]}], "\n", "}"}], ",", "\n", 
     RowBox[{"Product", "[", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"Product", "[", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"Product", "[", 
             RowBox[{
              RowBox[{"q", "[", "i", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "k", ",", "m"}], "}"}]}], "]"}]}], ")"}], 
          "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], 
            RowBox[{"\[Alpha]Exts", "[", 
             RowBox[{"[", 
              RowBox[{"k", "+", "1"}], "]"}], "]"}], 
            RowBox[{"(", 
             RowBox[{"Q", "-", 
              RowBox[{"\[Alpha]Exts", "[", 
               RowBox[{"[", 
                RowBox[{"m", "+", "2"}], "]"}], "]"}]}], ")"}]}], ")"}]}], 
         ",", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"{", 
          RowBox[{"m", ",", "k", ",", 
           RowBox[{"n", "-", "3"}]}], "}"}]}], "\[IndentingNewLine]", "\t", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"n", "-", "3"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
    "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.6590501741928453`*^9, 3.659050264318695*^9}, {
   3.659149269605949*^9, 3.6591493518253403`*^9}, {3.659149414872245*^9, 
   3.6591494173427057`*^9}, {3.6592214228006477`*^9, 3.659221523957952*^9}, 
   3.6592845240432177`*^9, {3.659284555159359*^9, 3.659284612871705*^9}, {
   3.659284701905354*^9, 3.6592847033218813`*^9}, {3.6593150013240633`*^9, 
   3.6593150278318043`*^9}, {3.6593150694165916`*^9, 3.659315118866393*^9}, {
   3.659315181302066*^9, 3.659315190213584*^9}, {3.659315244589798*^9, 
   3.659315316919456*^9}, {3.6593153597588863`*^9, 3.659315424167824*^9}}],

Cell[CellGroupData[{

Cell[BoxData["stExts"], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.659315137857793*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
  RowBox[{"PowerExpand", "@", 
   RowBox[{"u1Factor", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Alpha]rs", "[", 
         RowBox[{"#", ",", "b"}], "]"}], "&"}], "/@", "stExts"}], ")"}], ",", 
     "b"}], "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.659284630209606*^9, 3.659284661214555*^9}, {
  3.659284746510803*^9, 3.659284748501659*^9}, {3.6593150426305*^9, 
  3.65931505357266*^9}, {3.659315125321373*^9, 3.659315158281722*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"q", "[", "1", "]"}]}], ")"}], 
   RowBox[{"1", "+", 
    FractionBox["3", 
     RowBox[{"2", " ", 
      SuperscriptBox["b", "2"]}]]}]], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"q", "[", "2", "]"}]}], ")"}], 
   RowBox[{"1", "+", 
    FractionBox["3", 
     RowBox[{"2", " ", 
      SuperscriptBox["b", "2"]}]]}]], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{
      RowBox[{"q", "[", "1", "]"}], " ", 
      RowBox[{"q", "[", "2", "]"}]}]}], ")"}], 
   RowBox[{"1", "+", 
    FractionBox["3", 
     RowBox[{"2", " ", 
      SuperscriptBox["b", "2"]}]]}]], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"q", "[", "3", "]"}]}], ")"}], 
   RowBox[{
    FractionBox["3", "2"], "+", 
    FractionBox["1", 
     SuperscriptBox["b", "2"]]}]], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{
      RowBox[{"q", "[", "2", "]"}], " ", 
      RowBox[{"q", "[", "3", "]"}]}]}], ")"}], 
   RowBox[{
    FractionBox["3", "2"], "+", 
    FractionBox["1", 
     SuperscriptBox["b", "2"]]}]], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{
      RowBox[{"q", "[", "1", "]"}], " ", 
      RowBox[{"q", "[", "2", "]"}], " ", 
      RowBox[{"q", "[", "3", "]"}]}]}], ")"}], 
   RowBox[{
    FractionBox["3", "2"], "+", 
    FractionBox["1", 
     SuperscriptBox["b", "2"]]}]]}]], "Output",
 CellChangeTimes->{{3.6592846381541653`*^9, 3.659284662294066*^9}, {
  3.6592847295041*^9, 3.659284749479169*^9}, {3.659315004506833*^9, 
  3.659315054317624*^9}, {3.659315097777051*^9, 3.659315192956504*^9}, {
  3.659315248918803*^9, 3.659315310325987*^9}, {3.65931535405486*^9, 
  3.659315426246852*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["What about polynomial wavefunctions?", "Section",
 CellChangeTimes->{{3.6593155467718687`*^9, 3.659315554443348*^9}}],

Cell["Should be possible to get a poly in BOTH zs and ws, right?", "Text",
 CellChangeTimes->{{3.6593165145433702`*^9, 3.659316529215041*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vdmWW", "=", 
   RowBox[{
    RowBox[{"(", "\n", "\t", 
     RowBox[{
      RowBox[{"w", "[", 
       RowBox[{"1", ",", "2"}], "]"}], 
      RowBox[{"w", "[", 
       RowBox[{"1", ",", "3"}], "]"}], 
      RowBox[{"w", "[", 
       RowBox[{"1", ",", "4"}], "]"}], 
      RowBox[{"w", "[", 
       RowBox[{"2", ",", "3"}], "]"}], 
      RowBox[{"w", "[", 
       RowBox[{"2", ",", "4"}], "]"}], 
      RowBox[{"w", "[", 
       RowBox[{"3", ",", "4"}], "]"}]}], "\[IndentingNewLine]", ")"}], "/.", 
    "diffSubs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vdmZW", "=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"zw", "[", 
      RowBox[{"1", ",", "1"}], "]"}], 
     RowBox[{"zw", "[", 
      RowBox[{"1", ",", "2"}], "]"}], 
     RowBox[{"zw", "[", 
      RowBox[{"1", ",", "3"}], "]"}], 
     RowBox[{"zw", "[", 
      RowBox[{"1", ",", "4"}], "]"}], "*", "\[IndentingNewLine]", 
     RowBox[{"zw", "[", 
      RowBox[{"2", ",", "1"}], "]"}], 
     RowBox[{"zw", "[", 
      RowBox[{"2", ",", "2"}], "]"}], 
     RowBox[{"zw", "[", 
      RowBox[{"2", ",", "3"}], "]"}], 
     RowBox[{"zw", "[", 
      RowBox[{"2", ",", "4"}], "]"}]}], "\[IndentingNewLine]", ")"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.659315691207345*^9, 3.6593157731850977`*^9}, {
   3.659316118555419*^9, 3.65931613516928*^9}, {3.659316202260828*^9, 
   3.659316202508724*^9}, 3.659316334957788*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Factor", "@", 
   RowBox[{"PowerExpand", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"vdmZW", "^", 
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}]}], 
      RowBox[{"stF", "[", "1", "]"}]}], "/.", "diffSubs"}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Series", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"%", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"w", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"w", "[", "2", "]"}], "\[Rule]", "\[CurlyEpsilon]"}], ",", 
      RowBox[{
       RowBox[{"w", "[", "3", "]"}], "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"w", "[", "4", "]"}], "\[Rule]", 
       RowBox[{"1", "+", "\[CurlyEpsilon]"}]}]}], "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.65931637601854*^9, 3.659316473438244*^9}, {
  3.6593165919664803`*^9, 3.659316615395027*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"7", "/", "8"}]], " ", 
        SqrtBox["2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", "1", "]"}], " ", 
           RowBox[{"z", "[", "2", "]"}]}], "-", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"z", "[", "1", "]"}], "2"], " ", 
           RowBox[{"z", "[", "2", "]"}]}], "-", 
          RowBox[{
           RowBox[{"z", "[", "1", "]"}], " ", 
           SuperscriptBox[
            RowBox[{"z", "[", "2", "]"}], "2"]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"z", "[", "1", "]"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"z", "[", "2", "]"}], "2"]}]}], ")"}]}], ")"}]}], 
     SuperscriptBox["\[CurlyEpsilon]", 
      RowBox[{"1", "/", "4"}]]]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], 
     RowBox[{"7", "/", "8"}]], " ", 
    SqrtBox["2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"z", "[", "1", "]"}], "-", 
      SuperscriptBox[
       RowBox[{"z", "[", "1", "]"}], "2"], "+", 
      RowBox[{"z", "[", "2", "]"}], "-", 
      RowBox[{"4", " ", 
       RowBox[{"z", "[", "1", "]"}], " ", 
       RowBox[{"z", "[", "2", "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"z", "[", "1", "]"}], "2"], " ", 
       RowBox[{"z", "[", "2", "]"}]}], "-", 
      SuperscriptBox[
       RowBox[{"z", "[", "2", "]"}], "2"], "+", 
      RowBox[{"2", " ", 
       RowBox[{"z", "[", "1", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"z", "[", "2", "]"}], "2"]}]}], ")"}], " ", 
    SuperscriptBox["\[CurlyEpsilon]", 
     RowBox[{"3", "/", "4"}]]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[CurlyEpsilon]", "]"}], 
     RowBox[{"5", "/", "4"}]],
    SeriesData[$CellContext`\[CurlyEpsilon], 0, {}, -1, 5, 4],
    Editable->False]}],
  SeriesData[$CellContext`\[CurlyEpsilon], 
   0, {(-2) (-1)^Rational[7, 8] 
    2^Rational[
      1, 2] ($CellContext`z[1] $CellContext`z[2] - $CellContext`z[
       1]^2 $CellContext`z[2] - $CellContext`z[
      1] $CellContext`z[2]^2 + $CellContext`z[1]^2 $CellContext`z[2]^2), 0, 0,
     0, (-1)^Rational[7, 8] 
    2^Rational[1, 2] ($CellContext`z[1] - $CellContext`z[
      1]^2 + $CellContext`z[2] - 4 $CellContext`z[1] $CellContext`z[2] + 
     2 $CellContext`z[1]^2 $CellContext`z[2] - $CellContext`z[2]^2 + 
     2 $CellContext`z[1] $CellContext`z[2]^2)}, -1, 5, 4],
  Editable->False]], "Output",
 CellChangeTimes->{{3.659316362619059*^9, 3.659316411284258*^9}, {
  3.659316451781931*^9, 3.6593164741371527`*^9}, {3.6593165971977663`*^9, 
  3.659316616101911*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Factor", "@", 
  RowBox[{"PowerExpand", "@", 
   RowBox[{"Factor", "@", 
    RowBox[{"PowerExpand", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", "vdmWW", ")"}], "^", 
         RowBox[{"(", "\[Alpha]", ")"}]}], 
        RowBox[{
         RowBox[{"(", "vdmZW", ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}]}], 
        RowBox[{"stF", "[", "1", "]"}]}], "/.", "\[IndentingNewLine]", 
       "diffSubs"}], "/.", "qSubs"}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{
  3.659316563246228*^9, {3.6593166446817083`*^9, 3.659316725385784*^9}, {
   3.659316767108485*^9, 3.659316768395068*^9}, {3.659316806105105*^9, 
   3.659316858513301*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], 
     RowBox[{"1", "+", "\[Alpha]"}]], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "1", "]"}], 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "8"]}], "+", "\[Alpha]"}]], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "2", "]"}], 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "8"]}], "+", 
      RowBox[{"2", " ", "\[Alpha]"}]}]], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "3", "]"}], 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "4"]}], "+", 
      RowBox[{"3", " ", "\[Alpha]"}]}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"q", "[", "3", "]"}]}], "+", 
       RowBox[{
        RowBox[{"q", "[", "2", "]"}], " ", 
        RowBox[{"q", "[", "3", "]"}]}]}], ")"}], "\[Alpha]"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"q", "[", "3", "]"}]}], "+", 
       RowBox[{
        RowBox[{"q", "[", "1", "]"}], " ", 
        RowBox[{"q", "[", "2", "]"}], " ", 
        RowBox[{"q", "[", "3", "]"}]}]}], ")"}], "\[Alpha]"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"q", "[", "2", "]"}]}], " ", 
        RowBox[{"q", "[", "3", "]"}]}], "+", 
       RowBox[{
        RowBox[{"q", "[", "1", "]"}], " ", 
        RowBox[{"q", "[", "2", "]"}], " ", 
        RowBox[{"q", "[", "3", "]"}]}]}], ")"}], "\[Alpha]"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SqrtBox[
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"q", "[", "1", "]"}]}]]}], " ", 
       RowBox[{"q", "[", "1", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "2", "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "3", "]"}], "2"]}], "-", 
      RowBox[{
       RowBox[{"q", "[", "1", "]"}], " ", 
       RowBox[{"q", "[", "2", "]"}], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          RowBox[{"q", "[", "1", "]"}], " ", 
          RowBox[{"q", "[", "2", "]"}]}]}]], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "3", "]"}], "2"]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"q", "[", "1", "]"}]}]], " ", 
       RowBox[{"q", "[", "1", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "2", "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "3", "]"}], "3"]}], "+", 
      RowBox[{
       RowBox[{"q", "[", "1", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "2", "]"}], "2"], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          RowBox[{"q", "[", "1", "]"}], " ", 
          RowBox[{"q", "[", "2", "]"}]}]}]], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "3", "]"}], "3"]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"q", "[", "1", "]"}]}]], " ", 
       RowBox[{"q", "[", "3", "]"}], " ", 
       RowBox[{"z", "[", "2", "]"}]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"q", "[", "1", "]"}]}]], " ", 
       RowBox[{"q", "[", "2", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}], " ", 
       RowBox[{"z", "[", "2", "]"}]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"q", "[", "1", "]"}]}]], " ", 
       RowBox[{"q", "[", "1", "]"}], " ", 
       RowBox[{"q", "[", "2", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}], " ", 
       RowBox[{"z", "[", "2", "]"}]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          RowBox[{"q", "[", "1", "]"}], " ", 
          RowBox[{"q", "[", "2", "]"}]}]}]], " ", 
       RowBox[{"q", "[", "3", "]"}], " ", 
       RowBox[{"z", "[", "2", "]"}]}], "+", 
      RowBox[{
       RowBox[{"q", "[", "2", "]"}], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          RowBox[{"q", "[", "1", "]"}], " ", 
          RowBox[{"q", "[", "2", "]"}]}]}]], " ", 
       RowBox[{"q", "[", "3", "]"}], " ", 
       RowBox[{"z", "[", "2", "]"}]}], "+", 
      RowBox[{
       RowBox[{"q", "[", "1", "]"}], " ", 
       RowBox[{"q", "[", "2", "]"}], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          RowBox[{"q", "[", "1", "]"}], " ", 
          RowBox[{"q", "[", "2", "]"}]}]}]], " ", 
       RowBox[{"q", "[", "3", "]"}], " ", 
       RowBox[{"z", "[", "2", "]"}]}], "-", 
      RowBox[{"2", " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"q", "[", "1", "]"}]}]], " ", 
       RowBox[{"q", "[", "2", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "3", "]"}], "2"], " ", 
       RowBox[{"z", "[", "2", "]"}]}], "-", 
      RowBox[{"2", " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"q", "[", "1", "]"}]}]], " ", 
       RowBox[{"q", "[", "1", "]"}], " ", 
       RowBox[{"q", "[", "2", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "3", "]"}], "2"], " ", 
       RowBox[{"z", "[", "2", "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"q", "[", "2", "]"}], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          RowBox[{"q", "[", "1", "]"}], " ", 
          RowBox[{"q", "[", "2", "]"}]}]}]], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "3", "]"}], "2"], " ", 
       RowBox[{"z", "[", "2", "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"q", "[", "1", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "2", "]"}], "2"], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          RowBox[{"q", "[", "1", "]"}], " ", 
          RowBox[{"q", "[", "2", "]"}]}]}]], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "3", "]"}], "2"], " ", 
       RowBox[{"z", "[", "2", "]"}]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"q", "[", "1", "]"}]}]], " ", 
       RowBox[{"q", "[", "1", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "2", "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "3", "]"}], "3"], " ", 
       RowBox[{"z", "[", "2", "]"}]}], "+", 
      RowBox[{
       RowBox[{"q", "[", "1", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "2", "]"}], "2"], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          RowBox[{"q", "[", "1", "]"}], " ", 
          RowBox[{"q", "[", "2", "]"}]}]}]], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "3", "]"}], "3"], " ", 
       RowBox[{"z", "[", "2", "]"}]}], "-", 
      RowBox[{"2", " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"q", "[", "1", "]"}]}]], " ", 
       SuperscriptBox[
        RowBox[{"z", "[", "2", "]"}], "2"]}], "-", 
      RowBox[{"2", " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          RowBox[{"q", "[", "1", "]"}], " ", 
          RowBox[{"q", "[", "2", "]"}]}]}]], " ", 
       SuperscriptBox[
        RowBox[{"z", "[", "2", "]"}], "2"]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"q", "[", "1", "]"}]}]], " ", 
       RowBox[{"q", "[", "3", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"z", "[", "2", "]"}], "2"]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"q", "[", "1", "]"}]}]], " ", 
       RowBox[{"q", "[", "2", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"z", "[", "2", "]"}], "2"]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"q", "[", "1", "]"}]}]], " ", 
       RowBox[{"q", "[", "1", "]"}], " ", 
       RowBox[{"q", "[", "2", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"z", "[", "2", "]"}], "2"]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          RowBox[{"q", "[", "1", "]"}], " ", 
          RowBox[{"q", "[", "2", "]"}]}]}]], " ", 
       RowBox[{"q", "[", "3", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"z", "[", "2", "]"}], "2"]}], "+", 
      RowBox[{
       RowBox[{"q", "[", "2", "]"}], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          RowBox[{"q", "[", "1", "]"}], " ", 
          RowBox[{"q", "[", "2", "]"}]}]}]], " ", 
       RowBox[{"q", "[", "3", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"z", "[", "2", "]"}], "2"]}], "+", 
      RowBox[{
       RowBox[{"q", "[", "1", "]"}], " ", 
       RowBox[{"q", "[", "2", "]"}], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          RowBox[{"q", "[", "1", "]"}], " ", 
          RowBox[{"q", "[", "2", "]"}]}]}]], " ", 
       RowBox[{"q", "[", "3", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"z", "[", "2", "]"}], "2"]}], "-", 
      RowBox[{
       SqrtBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"q", "[", "1", "]"}]}]], " ", 
       RowBox[{"q", "[", "1", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "2", "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "3", "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"z", "[", "2", "]"}], "2"]}], "-", 
      RowBox[{
       RowBox[{"q", "[", "1", "]"}], " ", 
       RowBox[{"q", "[", "2", "]"}], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{
          RowBox[{"q", "[", "1", "]"}], " ", 
          RowBox[{"q", "[", "2", "]"}]}]}]], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "3", "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"z", "[", "2", "]"}], "2"]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"q", "[", "1", "]"}]}], ")"}], 
     RowBox[{"1", "/", "8"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"q", "[", "2", "]"}]}], ")"}], 
     RowBox[{"1", "/", "8"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{
        RowBox[{"q", "[", "1", "]"}], " ", 
        RowBox[{"q", "[", "2", "]"}]}]}], ")"}], 
     RowBox[{"3", "/", "8"}]], " ", 
    SqrtBox[
     RowBox[{"1", "+", 
      FractionBox[
       SqrtBox[
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"q", "[", "2", "]"}]}], " ", 
          RowBox[{"q", "[", "3", "]"}]}], "+", 
         RowBox[{
          RowBox[{"q", "[", "1", "]"}], " ", 
          RowBox[{"q", "[", "2", "]"}], " ", 
          RowBox[{"q", "[", "3", "]"}]}]}]], 
       RowBox[{
        SqrtBox[
         RowBox[{"q", "[", "2", "]"}]], " ", 
        SqrtBox[
         RowBox[{
          RowBox[{"-", 
           RowBox[{"q", "[", "3", "]"}]}], "+", 
          RowBox[{
           RowBox[{"q", "[", "1", "]"}], " ", 
           RowBox[{"q", "[", "2", "]"}], " ", 
           RowBox[{"q", "[", "3", "]"}]}]}]]}]]}]]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.659316563691078*^9, {3.659316645433511*^9, 3.659316725845652*^9}, 
   3.659316768994549*^9, {3.659316806624407*^9, 3.659316859047863*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Factor", "@", 
  RowBox[{"Limit", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PowerExpand", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", "vdmWW", ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"1", "/", "8"}], ")"}]}], 
       RowBox[{
        RowBox[{"(", "vdmZW", ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"1", "/", "2"}], ")"}]}], 
       RowBox[{"stF", "[", "1", "]"}]}], "/.", "\[IndentingNewLine]", 
      "diffSubs"}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"z", "[", "2", "]"}], "\[Rule]", "Infinity"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Factor", "@", 
  RowBox[{"PowerExpand", "[", 
   RowBox[{"%", "/.", "qSubs"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.65931558496524*^9, 3.6593156149977293`*^9}, {
  3.659315764252746*^9, 3.6593157781205397`*^9}, {3.659315811231529*^9, 
  3.6593160991207123`*^9}, {3.6593161498171463`*^9, 3.65931621104431*^9}, {
  3.659316282662911*^9, 3.659316298526092*^9}, {3.659316554701858*^9, 
  3.659316557917355*^9}}],

Cell[CellGroupData[{

Cell["Try all particles, no qholes", "Subsection",
 CellChangeTimes->{{3.659317066843007*^9, 3.659317072185493*^9}, {
  3.659317465380252*^9, 3.659317467098557*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vandermonde", "[", "n_", "]"}], ":=", "\[IndentingNewLine]", 
    "\t", 
    RowBox[{"Times", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"z", "[", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "]"}],
           "-", 
          RowBox[{"z", "[", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           "]"}]}], ")"}], "&"}], "/@", 
       RowBox[{"Subsets", "[", 
        RowBox[{
         RowBox[{"Range", "[", "n", "]"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ")"}]}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"build", " ", "in", " ", "symmetrization", " ", "automatically"}], 
   " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"mr", "[", 
    RowBox[{"n_", "?", "EvenQ"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t", 
      RowBox[{
       RowBox[{"v1", "=", 
        RowBox[{"vandermonde", "[", 
         RowBox[{"n", "/", "2"}], "]"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"v2", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"vandermonde", "[", 
           RowBox[{"n", "/", "2"}], "]"}], "/.", 
          RowBox[{
           RowBox[{"z", "[", "k_", "]"}], "\[RuleDelayed]", 
           RowBox[{"z", "[", 
            RowBox[{"k", "+", 
             RowBox[{"n", "/", "2"}]}], "]"}]}]}], ")"}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"Plus", "@@", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{
            RowBox[{"v1", "*", "v2", "*", "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"Product", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"z", "[", "i", "]"}], "-", 
                 RowBox[{"z", "[", "j", "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"n", "/", "2"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{
                   RowBox[{"n", "/", "2"}], "+", "1"}], ",", "n"}], "}"}]}], 
               "]"}], "/", "\[IndentingNewLine]", "\t", 
              RowBox[{"Product", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"z", "[", "i", "]"}], "-", 
                 RowBox[{"z", "[", 
                  RowBox[{"i", "+", 
                   RowBox[{"n", "/", "2"}]}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"n", "/", "2"}]}], "}"}]}], "]"}]}]}], "/.", 
            RowBox[{"{", "\n", "\t\t", 
             RowBox[{
              RowBox[{"z", "[", "k_", "]"}], "\[RuleDelayed]", 
              RowBox[{"z", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "]"}]}], "}"}]}], "&"}], 
          ")"}], "/@", "\n", "\t\t", 
         RowBox[{"Permutations", "[", 
          RowBox[{"Range", "[", "n", "]"}], "]"}]}], "\n", "\t", ")"}]}], "/", 
      RowBox[{"(", 
       RowBox[{"n", "!!"}], ")"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.6593173005594263`*^9, 3.659317312083761*^9}, {
  3.6593183735762873`*^9, 3.6593185291725273`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["4ptcles", "Subsection",
 CellChangeTimes->{{3.659318113877252*^9, 3.6593181150531607`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mr", "[", "4", "]"}], "+", 
   RowBox[{"varphi4", "[", "4", "]"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.659318303304214*^9, 3.659318311977805*^9}, {
  3.6593185093006773`*^9, 3.65931850964402*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.659318305270733*^9, 3.659318312664751*^9}, 
   3.659318510063676*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Limit", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"mr", "[", "4", "]"}]}], "/", 
     RowBox[{
      RowBox[{"z", "[", "4", "]"}], "^", "2"}]}], "/.", 
    RowBox[{"{", "\n", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"z", "[", "1", "]"}], "\[Rule]", "0"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"z", "[", "2", "]"}], "\[Rule]", 
       RowBox[{"q", "[", "1", "]"}]}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"z", "[", "3", "]"}], "\[Rule]", "1"}]}], "\n", "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z", "[", "4", "]"}], "\[Rule]", "Infinity"}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Series", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"%", "/.", 
    RowBox[{
     RowBox[{"q", "[", "i_", "]"}], "\[RuleDelayed]", 
     RowBox[{"\[CurlyEpsilon]", "*", 
      RowBox[{"q", "[", "i", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "10"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{
  3.659317685644198*^9, {3.659318138403605*^9, 3.659318154583791*^9}, 
   3.6593186490578623`*^9}],

Cell[BoxData[
 RowBox[{"1", "-", 
  RowBox[{"q", "[", "1", "]"}], "+", 
  SuperscriptBox[
   RowBox[{"q", "[", "1", "]"}], "2"]}]], "Output",
 CellChangeTimes->{3.659318155249667*^9, 3.659318543288575*^9, 
  3.659318649717402*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "-", 
   RowBox[{
    RowBox[{"q", "[", "1", "]"}], " ", "\[CurlyEpsilon]"}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"q", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox["\[CurlyEpsilon]", "2"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[CurlyEpsilon]", "]"}], "11"],
    SeriesData[$CellContext`\[CurlyEpsilon], 0, {}, 0, 11, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[CurlyEpsilon], 0, {
   1, -$CellContext`q[1], $CellContext`q[1]^2}, 0, 11, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.659318155249667*^9, 3.659318543288575*^9, 
  3.659318649727476*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"e4F", "=", 
   RowBox[{"Collect", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PowerExpand", "@", " ", 
      RowBox[{"Factor", "[", "\[IndentingNewLine]", 
       RowBox[{"Sum", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"q", "[", "1", "]"}], "^", "k"}], "*", 
           "\[IndentingNewLine]", 
           RowBox[{"Simplify", "@", "  ", 
            RowBox[{"afltZkDegen", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", "k", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"2", ",", "1"}], "}"}], ",", "4"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], "}"}], "+", "\[Delta]"}], 
              ",", "\[IndentingNewLine]", "b"}], "]"}]}]}], ")"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "4"}], "}"}]}], "\[IndentingNewLine]", 
        "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"q", "[", "_", "]"}], ",", "\[IndentingNewLine]", "Factor"}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Limit", "[", 
    RowBox[{"e4F", ",", 
     RowBox[{"\[Delta]", "\[Rule]", "0"}]}], "]"}], "*", 
   RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PowerExpand", "@", 
      RowBox[{"(", 
       RowBox[{"u1Factor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Alpha]rs", "[", 
             RowBox[{"#", ",", "b"}], "]"}], "&"}], "/@", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}], ",", "4"}], "]"}]}], ")"}], ",",
          "b"}], "]"}], ")"}]}], "^", 
     RowBox[{"(", "\[Alpha]", ")"}]}], "\[IndentingNewLine]", "]"}]}], "/.", 
  RowBox[{"b", "\[Rule]", "bIsing"}]}], "\[IndentingNewLine]", 
 RowBox[{"Series", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"%", "/.", 
    RowBox[{
     RowBox[{"q", "[", "i_", "]"}], "\[RuleDelayed]", 
     RowBox[{"\[CurlyEpsilon]", "*", 
      RowBox[{"q", "[", "i", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "4"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.6593185731962*^9, 3.659318695269815*^9}, {
  3.6593187606354313`*^9, 3.6593187619690323`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["9", "224"], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    FractionBox["1", 
     RowBox[{"1", "-", 
      RowBox[{"q", "[", "1", "]"}]}]], ")"}], "\[Alpha]"], " ", 
  RowBox[{"(", 
   RowBox[{
    FractionBox[
     RowBox[{"4096", " ", 
      SuperscriptBox[
       RowBox[{"q", "[", "1", "]"}], "4"]}], "27"], "-", 
    RowBox[{
     FractionBox["1024", "27"], " ", 
     SuperscriptBox[
      RowBox[{"q", "[", "1", "]"}], "3"], " ", 
     RowBox[{"(", 
      RowBox[{"8", "+", 
       RowBox[{"35", " ", 
        RowBox[{"q", "[", "1", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["256", "27"], " ", 
     SuperscriptBox[
      RowBox[{"q", "[", "1", "]"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"48", "+", 
       RowBox[{"204", " ", 
        RowBox[{"q", "[", "1", "]"}]}], "+", 
       RowBox[{"473", " ", 
        SuperscriptBox[
         RowBox[{"q", "[", "1", "]"}], "2"]}]}], ")"}]}], "-", 
    RowBox[{
     FractionBox["64", "27"], " ", 
     RowBox[{"q", "[", "1", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"192", "+", 
       RowBox[{"888", " ", 
        RowBox[{"q", "[", "1", "]"}]}], "+", 
       RowBox[{"1936", " ", 
        SuperscriptBox[
         RowBox[{"q", "[", "1", "]"}], "2"]}], "+", 
       RowBox[{"3157", " ", 
        SuperscriptBox[
         RowBox[{"q", "[", "1", "]"}], "3"]}]}], ")"}]}], "+", 
    RowBox[{"480", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"q", "[", "1", "]"}], "+", 
       SuperscriptBox[
        RowBox[{"q", "[", "1", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"q", "[", "1", "]"}], "3"], "+", 
       SuperscriptBox[
        RowBox[{"q", "[", "1", "]"}], "4"]}], ")"}]}], "-", 
    RowBox[{
     FractionBox["32", "3"], " ", 
     RowBox[{"(", 
      RowBox[{"64", "+", 
       RowBox[{"154", " ", 
        RowBox[{"q", "[", "1", "]"}]}], "+", 
       RowBox[{"204", " ", 
        SuperscriptBox[
         RowBox[{"q", "[", "1", "]"}], "2"]}], "+", 
       RowBox[{"239", " ", 
        SuperscriptBox[
         RowBox[{"q", "[", "1", "]"}], "3"]}], "+", 
       RowBox[{"266", " ", 
        SuperscriptBox[
         RowBox[{"q", "[", "1", "]"}], "4"]}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["32", "9"], " ", 
     RowBox[{"(", 
      RowBox[{"64", "+", 
       RowBox[{"448", " ", 
        RowBox[{"q", "[", "1", "]"}]}], "+", 
       RowBox[{"948", " ", 
        SuperscriptBox[
         RowBox[{"q", "[", "1", "]"}], "2"]}], "+", 
       RowBox[{"1414", " ", 
        SuperscriptBox[
         RowBox[{"q", "[", "1", "]"}], "3"]}], "+", 
       RowBox[{"1837", " ", 
        SuperscriptBox[
         RowBox[{"q", "[", "1", "]"}], "4"]}]}], ")"}]}]}], ")"}]}]], "Output",\

 CellChangeTimes->{
  3.659318633779611*^9, {3.6593186719477386`*^9, 3.659318696717463*^9}, 
   3.659318762729376*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"q", "[", "1", "]"}]}], "+", 
      RowBox[{"\[Alpha]", " ", 
       RowBox[{"q", "[", "1", "]"}]}]}], ")"}], " ", "\[CurlyEpsilon]"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"q", "[", "1", "]"}], "2"], "-", 
      RowBox[{
       FractionBox["1", "2"], " ", "\[Alpha]", " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "1", "]"}], "2"]}], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SuperscriptBox["\[Alpha]", "2"], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "1", "]"}], "2"]}]}], ")"}], " ", 
    SuperscriptBox["\[CurlyEpsilon]", "2"]}], "+", 
   RowBox[{
    FractionBox["1", "6"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"5", " ", "\[Alpha]", " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "1", "]"}], "3"]}], "+", 
      RowBox[{
       SuperscriptBox["\[Alpha]", "3"], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "1", "]"}], "3"]}]}], ")"}], " ", 
    SuperscriptBox["\[CurlyEpsilon]", "3"]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"10", " ", "\[Alpha]", " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "1", "]"}], "4"]}], "+", 
      RowBox[{"11", " ", 
       SuperscriptBox["\[Alpha]", "2"], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "1", "]"}], "4"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[Alpha]", "3"], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "1", "]"}], "4"]}], "+", 
      RowBox[{
       SuperscriptBox["\[Alpha]", "4"], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "1", "]"}], "4"]}]}], ")"}], " ", 
    SuperscriptBox["\[CurlyEpsilon]", "4"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[CurlyEpsilon]", "]"}], "5"],
    SeriesData[$CellContext`\[CurlyEpsilon], 0, {}, 0, 5, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[CurlyEpsilon], 0, {
   1, -$CellContext`q[1] + $CellContext`\[Alpha] $CellContext`q[
      1], $CellContext`q[1]^2 + 
    Rational[-1, 2] $CellContext`\[Alpha] $CellContext`q[1]^2 + 
    Rational[1, 2] $CellContext`\[Alpha]^2 $CellContext`q[1]^2, 
    Rational[1, 6] (
     5 $CellContext`\[Alpha] $CellContext`q[
        1]^3 + $CellContext`\[Alpha]^3 $CellContext`q[1]^3), 
    Rational[1, 24] (10 $CellContext`\[Alpha] $CellContext`q[1]^4 + 
     11 $CellContext`\[Alpha]^2 $CellContext`q[1]^4 + 
     2 $CellContext`\[Alpha]^3 $CellContext`q[
        1]^4 + $CellContext`\[Alpha]^4 $CellContext`q[1]^4)}, 0, 5, 1],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.659318633779611*^9, {3.6593186719477386`*^9, 3.659318696717463*^9}, 
   3.659318762739007*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["6 ptcles", "Subsection",
 CellChangeTimes->{{3.659318108645406*^9, 3.659318109781291*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Limit", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"mr", "[", "6", "]"}], "/", 
     RowBox[{
      RowBox[{"z", "[", "6", "]"}], "^", "4"}]}], "/.", 
    RowBox[{"{", "\n", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"z", "[", "1", "]"}], "\[Rule]", "0"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"z", "[", "2", "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"q", "[", "1", "]"}], 
        RowBox[{"q", "[", "2", "]"}], 
        RowBox[{"q", "[", "3", "]"}]}]}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"z", "[", "3", "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"q", "[", "2", "]"}], 
        RowBox[{"q", "[", "3", "]"}]}]}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"z", "[", "4", "]"}], "\[Rule]", 
       RowBox[{"q", "[", "3", "]"}]}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"z", "[", "5", "]"}], "\[Rule]", "1"}]}], "\n", "}"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z", "[", "6", "]"}], "\[Rule]", "Infinity"}]}], 
  "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Series", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"%", "/.", 
    RowBox[{
     RowBox[{"q", "[", "i_", "]"}], "\[RuleDelayed]", 
     RowBox[{"\[CurlyEpsilon]", "*", 
      RowBox[{"q", "[", "i", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "10"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.659317318661235*^9, 3.6593174110918703`*^9}, {
   3.6593175012399*^9, 3.6593175748422194`*^9}, 3.6593176432862463`*^9, {
   3.659317686674251*^9, 3.6593177482463493`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"q", "[", "1", "]"}]}], ")"}]}], " ", 
  RowBox[{"q", "[", "1", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"q", "[", "2", "]"}]}], ")"}], " ", 
  SuperscriptBox[
   RowBox[{"q", "[", "2", "]"}], "3"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     RowBox[{"q", "[", "1", "]"}], " ", 
     RowBox[{"q", "[", "2", "]"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"q", "[", "3", "]"}]}], ")"}], " ", 
  SuperscriptBox[
   RowBox[{"q", "[", "3", "]"}], "5"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     RowBox[{"q", "[", "2", "]"}], " ", 
     RowBox[{"q", "[", "3", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.659317321621236*^9, 3.659317335344873*^9}, {
   3.659317388421968*^9, 3.659317411628516*^9}, {3.659317508758596*^9, 
   3.659317514703176*^9}, {3.659317555796754*^9, 3.659317576019536*^9}, 
   3.659317646561099*^9, {3.6593176925579643`*^9, 3.659317748759225*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    RowBox[{"q", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "2", "]"}], "3"], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "3", "]"}], "5"], " ", 
    SuperscriptBox["\[CurlyEpsilon]", "9"]}], "-", 
   RowBox[{
    RowBox[{"q", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "2", "]"}], "3"], " ", 
    SuperscriptBox[
     RowBox[{"q", "[", "3", "]"}], "5"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"q", "[", "1", "]"}], "+", 
      RowBox[{"q", "[", "2", "]"}], "+", 
      RowBox[{"q", "[", "3", "]"}]}], ")"}], " ", 
    SuperscriptBox["\[CurlyEpsilon]", "10"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[CurlyEpsilon]", "]"}], "11"],
    SeriesData[$CellContext`\[CurlyEpsilon], 0, {}, 9, 11, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[CurlyEpsilon], 
   0, {$CellContext`q[
     1] $CellContext`q[2]^3 $CellContext`q[3]^5, -$CellContext`q[
     1] $CellContext`q[2]^3 $CellContext`q[3]^5 ($CellContext`q[
      1] + $CellContext`q[2] + $CellContext`q[3])}, 9, 11, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.659317321621236*^9, 3.659317335344873*^9}, {
   3.659317388421968*^9, 3.659317411628516*^9}, {3.659317508758596*^9, 
   3.659317514703176*^9}, {3.659317555796754*^9, 3.659317576019536*^9}, 
   3.659317646561099*^9, {3.6593176925579643`*^9, 3.659317748766059*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"energyExts", "=", 
   RowBox[{"Join", "[", "\n", "\t", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "1"}], "}"}], ",", "6"}], "]"}], "\n", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"energyInts", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.6592244256981983`*^9, 3.659224482003252*^9}, {
  3.659281639372052*^9, 3.659281729438632*^9}, {3.6593169916219273`*^9, 
  3.6593170412827253`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"e6F", "=", 
   RowBox[{"Collect", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PowerExpand", "@", " ", 
      RowBox[{"Factor", "[", 
       RowBox[{"Total", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"q", "[", "1", "]"}], "^", "#1"}], "*", 
            RowBox[{
             RowBox[{"q", "[", "2", "]"}], "^", "#2"}], "*", 
            RowBox[{
             RowBox[{"q", "[", "3", "]"}], "^", "#3"}], "*", 
            "\[IndentingNewLine]", 
            RowBox[{"Simplify", "@", "  ", 
             RowBox[{"afltZkDegen", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}], ",", 
               "\[IndentingNewLine]", "energyExts", ",", 
               "\[IndentingNewLine]", 
               RowBox[{"energyInts", "+", "\[Delta]"}], ",", 
               "\[IndentingNewLine]", "b"}], "]"}]}]}], "&"}], ")"}], "@@@", 
         " ", "stupid"}], "\[IndentingNewLine]", "]"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"q", "[", "_", "]"}], ",", "\[IndentingNewLine]", "Factor"}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Limit", "[", 
    RowBox[{"e6F", ",", 
     RowBox[{"\[Delta]", "\[Rule]", "0"}]}], "]"}], "*", 
   RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PowerExpand", "@", 
      RowBox[{"(", 
       RowBox[{"u1Factor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Alpha]rs", "[", 
             RowBox[{"#", ",", "b"}], "]"}], "&"}], "/@", "energyExts"}], 
          ")"}], ",", "b"}], "]"}], ")"}]}], "^", "\[Alpha]"}], 
    "\[IndentingNewLine]", "]"}]}], "/.", 
  RowBox[{"b", "\[Rule]", "bIsing"}]}], "\[IndentingNewLine]", 
 RowBox[{"Series", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"%", "/.", 
    RowBox[{
     RowBox[{"q", "[", "i_", "]"}], "\[RuleDelayed]", 
     RowBox[{"\[CurlyEpsilon]", "*", 
      RowBox[{"q", "[", "i", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"\[CurlyEpsilon]", ",", "0", ",", "2"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.659317076220854*^9, 3.659317143676798*^9}, {
   3.659317212796537*^9, 3.659317216346158*^9}, {3.659317773343481*^9, 
   3.659317856497921*^9}, {3.659318019705508*^9, 3.659318044741918*^9}, 
   3.659318087207617*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["3", "4"], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"q", "[", "1", "]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"q", "[", "2", "]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"q", "[", "1", "]"}], " ", 
          RowBox[{"q", "[", "2", "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"q", "[", "3", "]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"q", "[", "2", "]"}], " ", 
          RowBox[{"q", "[", "3", "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"q", "[", "1", "]"}], " ", 
          RowBox[{"q", "[", "2", "]"}], " ", 
          RowBox[{"q", "[", "3", "]"}]}]}], ")"}]}], ")"}]}], ")"}], 
   "\[Alpha]"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["64", "3"]}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"q", "[", "1", "]"}], "+", 
        RowBox[{"q", "[", "3", "]"}]}], ")"}], "2"]}], "+", 
    RowBox[{"12", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox[
        RowBox[{"q", "[", "1", "]"}], "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"q", "[", "2", "]"}]}], ")"}], " ", 
        RowBox[{"q", "[", "3", "]"}]}], "+", 
       SuperscriptBox[
        RowBox[{"q", "[", "3", "]"}], "2"], "+", 
       RowBox[{
        RowBox[{"q", "[", "1", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"q", "[", "2", "]"}], "+", 
          RowBox[{"q", "[", "3", "]"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["16", "3"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"11", " ", 
        SuperscriptBox[
         RowBox[{"q", "[", "1", "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"q", "[", "3", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"4", "+", 
          RowBox[{"4", " ", 
           RowBox[{"q", "[", "2", "]"}]}], "+", 
          RowBox[{"11", " ", 
           RowBox[{"q", "[", "3", "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"q", "[", "1", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"4", "+", 
          RowBox[{"4", " ", 
           RowBox[{"q", "[", "2", "]"}]}], "+", 
          RowBox[{"17", " ", 
           RowBox[{"q", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}], "-", 
    RowBox[{
     FractionBox["4", "3"], " ", 
     RowBox[{"(", 
      RowBox[{"8", "+", 
       RowBox[{"36", " ", 
        SuperscriptBox[
         RowBox[{"q", "[", "1", "]"}], "2"]}], "+", 
       RowBox[{"26", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"q", "[", "2", "]"}]}], ")"}], " ", 
        RowBox[{"q", "[", "3", "]"}]}], "+", 
       RowBox[{"36", " ", 
        SuperscriptBox[
         RowBox[{"q", "[", "3", "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"q", "[", "1", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"26", "+", 
          RowBox[{"26", " ", 
           RowBox[{"q", "[", "2", "]"}]}], "+", 
          RowBox[{"44", " ", 
           RowBox[{"q", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.6593170818928432`*^9, 3.6593171443503036`*^9}, 
   3.659317217060505*^9, {3.6593177766376*^9, 3.659317856983386*^9}, 
   3.659318046741435*^9, 3.659318088133184*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"q", "[", "1", "]"}]}], "+", 
      RowBox[{"\[Alpha]", " ", 
       RowBox[{"q", "[", "1", "]"}]}], "+", 
      RowBox[{"\[Alpha]", " ", 
       RowBox[{"q", "[", "2", "]"}]}], "-", 
      RowBox[{"q", "[", "3", "]"}], "+", 
      RowBox[{"\[Alpha]", " ", 
       RowBox[{"q", "[", "3", "]"}]}]}], ")"}], " ", "\[CurlyEpsilon]"}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "1", "]"}], "2"]}], "-", 
      RowBox[{"\[Alpha]", " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "1", "]"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["\[Alpha]", "2"], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "1", "]"}], "2"]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"q", "[", "1", "]"}], " ", 
       RowBox[{"q", "[", "2", "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[Alpha]", "2"], " ", 
       RowBox[{"q", "[", "1", "]"}], " ", 
       RowBox[{"q", "[", "2", "]"}]}], "+", 
      RowBox[{"\[Alpha]", " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "2", "]"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["\[Alpha]", "2"], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "2", "]"}], "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"q", "[", "1", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}]}], "-", 
      RowBox[{"4", " ", "\[Alpha]", " ", 
       RowBox[{"q", "[", "1", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[Alpha]", "2"], " ", 
       RowBox[{"q", "[", "1", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"q", "[", "2", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[Alpha]", "2"], " ", 
       RowBox[{"q", "[", "2", "]"}], " ", 
       RowBox[{"q", "[", "3", "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "3", "]"}], "2"]}], "-", 
      RowBox[{"\[Alpha]", " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "3", "]"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["\[Alpha]", "2"], " ", 
       SuperscriptBox[
        RowBox[{"q", "[", "3", "]"}], "2"]}]}], ")"}], " ", 
    SuperscriptBox["\[CurlyEpsilon]", "2"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[CurlyEpsilon]", "]"}], "3"],
    SeriesData[$CellContext`\[CurlyEpsilon], 0, {}, 0, 3, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[CurlyEpsilon], 0, {
   1, -$CellContext`q[1] + $CellContext`\[Alpha] $CellContext`q[
      1] + $CellContext`\[Alpha] $CellContext`q[2] - $CellContext`q[
    3] + $CellContext`\[Alpha] $CellContext`q[3], 
    Rational[1, 2] (
     2 $CellContext`q[1]^2 - $CellContext`\[Alpha] $CellContext`q[
       1]^2 + $CellContext`\[Alpha]^2 $CellContext`q[1]^2 - 
     2 $CellContext`q[1] $CellContext`q[2] + 
     2 $CellContext`\[Alpha]^2 $CellContext`q[1] $CellContext`q[
       2] + $CellContext`\[Alpha] $CellContext`q[
        2]^2 + $CellContext`\[Alpha]^2 $CellContext`q[2]^2 + 
     2 $CellContext`q[1] $CellContext`q[3] - 
     4 $CellContext`\[Alpha] $CellContext`q[1] $CellContext`q[3] + 
     2 $CellContext`\[Alpha]^2 $CellContext`q[1] $CellContext`q[3] - 
     2 $CellContext`q[2] $CellContext`q[3] + 
     2 $CellContext`\[Alpha]^2 $CellContext`q[2] $CellContext`q[3] + 
     2 $CellContext`q[3]^2 - $CellContext`\[Alpha] $CellContext`q[
       3]^2 + $CellContext`\[Alpha]^2 $CellContext`q[3]^2)}, 0, 3, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.6593170818928432`*^9, 3.6593171443503036`*^9}, 
   3.659317217060505*^9, {3.6593177766376*^9, 3.659317856983386*^9}, 
   3.659318046741435*^9, 3.6593180881437073`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Factor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%", "*", 
     RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
      RowBox[{"PowerExpand", "@", 
       RowBox[{"u1Factor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Alpha]rs", "[", 
             RowBox[{"#", ",", "b"}], "]"}], "&"}], "/@", "energyExts"}], 
          ")"}], ",", "b"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], "/.", 
    RowBox[{"b", "\[Rule]", "bIsing"}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{3.6593177469372473`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->None,
WindowSize->{803, 853},
WindowMargins->{{Automatic, 242}, {Automatic, 0}},
ShowSelection->True,
FrontEndVersion->"10.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 6, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info-d56be4a2-929a-4d2e-9229-1f9c6727a7a3"->{
  Cell[181481, 5354, 2583, 40, 108, "Print",
   CellTags->"Info-d56be4a2-929a-4d2e-9229-1f9c6727a7a3"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info-d56be4a2-929a-4d2e-9229-1f9c6727a7a3", 350878, 10253}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 117, 1, 183, "Title"],
Cell[CellGroupData[{
Cell[709, 27, 174, 2, 54, "Subsection"],
Cell[886, 31, 1948, 50, 349, "Code"],
Cell[2837, 83, 1919, 64, 141, "Input"],
Cell[CellGroupData[{
Cell[4781, 151, 522, 15, 57, "Input"],
Cell[5306, 168, 611, 21, 55, "Output"],
Cell[5920, 191, 728, 24, 58, "Output"]
}, Open  ]],
Cell[6663, 218, 220, 6, 61, "Code"],
Cell[6886, 226, 92, 1, 37, "Text"],
Cell[6981, 229, 2077, 66, 141, "Code"],
Cell[9061, 297, 97, 1, 37, "Text"],
Cell[9161, 300, 2290, 58, 367, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11488, 363, 186, 2, 80, "Section"],
Cell[11677, 367, 2833, 90, 246, "Input"],
Cell[14513, 459, 4601, 124, 415, "Input"],
Cell[19117, 585, 87, 1, 57, "Input"],
Cell[19207, 588, 4686, 111, 414, "Input"],
Cell[23896, 701, 4822, 126, 519, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[28755, 832, 150, 2, 62, "Section"],
Cell[28908, 836, 333, 6, 85, "Text"],
Cell[29244, 844, 480, 8, 109, "Text"],
Cell[29727, 854, 3314, 83, 369, "Code"],
Cell[33044, 939, 1054, 25, 234, "Code"],
Cell[34101, 966, 1380, 35, 215, "Code"],
Cell[CellGroupData[{
Cell[35506, 1005, 95, 1, 43, "Subsubsection"],
Cell[CellGroupData[{
Cell[35626, 1010, 832, 20, 99, "Input"],
Cell[36461, 1032, 790, 26, 57, "Output"],
Cell[37254, 1060, 161, 4, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37452, 1069, 214, 5, 35, "Input"],
Cell[37669, 1076, 574, 13, 76, "Output"]
}, Open  ]]
}, Closed]],
Cell[38270, 1093, 99, 1, 34, "Subsubsection"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38406, 1099, 139, 1, 125, "Section"],
Cell[38548, 1102, 3704, 108, 541, "Code"],
Cell[42255, 1212, 2441, 71, 425, "Code"],
Cell[44699, 1285, 5626, 148, 712, "Code"]
}, Closed]],
Cell[CellGroupData[{
Cell[50362, 1438, 162, 2, 62, "Section"],
Cell[50527, 1442, 251, 5, 61, "Text"],
Cell[50781, 1449, 4067, 107, 482, "Code"],
Cell[CellGroupData[{
Cell[54873, 1560, 111, 1, 54, "Subsection"],
Cell[54987, 1563, 258, 5, 61, "Text"],
Cell[55248, 1570, 6029, 160, 862, "Code"],
Cell[CellGroupData[{
Cell[61302, 1734, 97, 1, 43, "Subsubsection"],
Cell[CellGroupData[{
Cell[61424, 1739, 660, 18, 57, "Input"],
Cell[62087, 1759, 3968, 122, 268, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66092, 1886, 716, 18, 57, "Input"],
Cell[66811, 1906, 3984, 119, 247, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70832, 2030, 152, 3, 35, "Input"],
Cell[70987, 2035, 121, 2, 35, "Output"]
}, Open  ]]
}, Closed]],
Cell[71135, 2041, 99, 1, 34, "Subsubsection"]
}, Closed]],
Cell[CellGroupData[{
Cell[71271, 2047, 97, 1, 43, "Subsection"],
Cell[71371, 2050, 232, 5, 37, "Text"],
Cell[CellGroupData[{
Cell[71628, 2059, 167, 2, 43, "Subsubsection"],
Cell[71798, 2063, 8803, 197, 1296, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[80638, 2265, 104, 1, 34, "Subsubsection"],
Cell[80745, 2268, 6918, 153, 957, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87700, 2426, 99, 1, 43, "Subsubsection"],
Cell[CellGroupData[{
Cell[87824, 2431, 696, 15, 225, "Input"],
Cell[88523, 2448, 331, 11, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88891, 2464, 662, 18, 141, "Input"],
Cell[89556, 2484, 1632, 54, 142, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91225, 2543, 1029, 24, 141, "Input"],
Cell[92257, 2569, 413, 6, 26, "Print"],
Cell[92673, 2577, 2075, 61, 142, "Output"]
}, Open  ]],
Cell[94763, 2641, 209, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[94997, 2649, 1169, 32, 162, "Input"],
Cell[96169, 2683, 261, 6, 35, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[96479, 2695, 99, 1, 34, "Subsubsection"],
Cell[96581, 2698, 102, 1, 37, "Text"],
Cell[96686, 2701, 1808, 48, 349, "Code"],
Cell[98497, 2751, 684, 17, 177, "Code"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[99242, 2775, 103, 1, 80, "Section"],
Cell[99348, 2778, 1653, 57, 102, "Code"],
Cell[CellGroupData[{
Cell[101026, 2839, 360, 12, 35, "Input"],
Cell[101389, 2853, 747, 25, 67, "Output"]
}, Open  ]],
Cell[102151, 2881, 1265, 39, 157, "Code"],
Cell[CellGroupData[{
Cell[103441, 2924, 101, 1, 54, "Subsection"],
Cell[CellGroupData[{
Cell[103567, 2929, 1212, 23, 141, "Input"],
Cell[104782, 2954, 2717, 81, 189, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107536, 3040, 298, 7, 99, "Input"],
Cell[107837, 3049, 569, 16, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[108443, 3070, 1763, 51, 273, "Input"],
Cell[110209, 3123, 333, 6, 35, "Output"],
Cell[110545, 3131, 653, 16, 39, "Output"],
Cell[111201, 3149, 421, 9, 35, "Output"],
Cell[111625, 3160, 421, 9, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112083, 3174, 1253, 32, 132, "Input"],
Cell[113339, 3208, 483, 12, 39, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[113871, 3226, 164, 3, 85, "Subsection"],
Cell[114038, 3231, 1966, 62, 101, "Code",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[116029, 3297, 128, 2, 36, "Input"],
Cell[116160, 3301, 126, 3, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[116323, 3309, 527, 15, 99, "Input"],
Cell[116853, 3326, 207, 5, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[117097, 3336, 1456, 43, 120, "Input"],
Cell[118556, 3381, 473, 14, 64, "Output"],
Cell[119032, 3397, 1452, 50, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[120521, 3452, 256, 5, 57, "Input"],
Cell[120780, 3459, 3579, 111, 170, "Output"],
Cell[124362, 3572, 94, 1, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[124493, 3578, 435, 12, 57, "Input"],
Cell[124931, 3592, 4490, 147, 207, "Output"],
Cell[129424, 3741, 878, 29, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130339, 3775, 60, 1, 36, "Input"],
Cell[130402, 3778, 2981, 97, 135, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[133432, 3881, 129, 1, 54, "Subsection"],
Cell[CellGroupData[{
Cell[133586, 3886, 1114, 29, 183, "Input"],
Cell[134703, 3917, 2664, 84, 188, "Output"],
Cell[137370, 4003, 1695, 51, 174, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139102, 4059, 1542, 44, 260, "Input"],
Cell[140647, 4105, 1279, 35, 59, "Output"],
Cell[141929, 4142, 1124, 34, 59, "Output"],
Cell[143056, 4178, 536, 15, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[143629, 4198, 1687, 47, 260, "Input"],
Cell[145319, 4247, 1188, 35, 59, "Output"],
Cell[146510, 4284, 993, 32, 59, "Output"],
Cell[147506, 4318, 311, 8, 56, "Output"]
}, Open  ]],
Cell[147832, 4329, 121, 1, 37, "Text"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[148002, 4336, 103, 1, 62, "Section"],
Cell[CellGroupData[{
Cell[148130, 4341, 665, 18, 120, "Input"],
Cell[148798, 4361, 445, 10, 48, "Message"],
Cell[149246, 4373, 445, 10, 48, "Message"],
Cell[149694, 4385, 445, 10, 48, "Message"],
Cell[150142, 4397, 528, 11, 29, "Message"],
Cell[150673, 4410, 231, 5, 93, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150941, 4420, 718, 20, 99, "Input"],
Cell[151662, 4442, 336, 9, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[152035, 4456, 1402, 34, 183, "Input"],
Cell[153440, 4492, 6709, 224, 405, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160186, 4721, 1495, 46, 99, "Input"],
Cell[161684, 4769, 2013, 65, 126, "Output"],
Cell[163700, 4836, 4103, 132, 226, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167840, 4973, 1646, 52, 120, "Input"],
Cell[169489, 5027, 1042, 36, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[170568, 5068, 1163, 33, 120, "Input"],
Cell[171734, 5103, 9580, 242, 129, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[181351, 5350, 127, 2, 36, "Input"],
Cell[181481, 5354, 2583, 40, 108, "Print",
 CellTags->"Info-d56be4a2-929a-4d2e-9229-1f9c6727a7a3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[184101, 5399, 438, 10, 99, "Input"],
Cell[184542, 5411, 10015, 254, 165, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[194594, 5670, 535, 15, 57, "Input"],
Cell[195132, 5687, 148, 3, 36, "Output"],
Cell[195283, 5692, 219, 6, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[195539, 5703, 300, 8, 36, "Input"],
Cell[195842, 5713, 975, 34, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[196854, 5752, 1102, 32, 120, "Input"],
Cell[197959, 5786, 9680, 244, 129, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[207676, 6035, 627, 19, 78, "Input"],
Cell[208306, 6056, 162, 4, 60, "Output"],
Cell[208471, 6062, 94, 1, 35, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[208614, 6069, 121, 1, 62, "Section"],
Cell[208738, 6072, 1436, 43, 254, "Code"],
Cell[CellGroupData[{
Cell[210199, 6119, 190, 2, 54, "Subsection"],
Cell[210392, 6123, 4731, 134, 425, "Code"],
Cell[CellGroupData[{
Cell[215148, 6261, 363, 9, 36, "Input"],
Cell[215514, 6272, 7048, 217, 805, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[222611, 6495, 239, 3, 43, "Subsection"],
Cell[222853, 6500, 4043, 116, 330, "Code"],
Cell[CellGroupData[{
Cell[226921, 6620, 2713, 68, 288, "Input"],
Cell[229637, 6690, 1198, 31, 67, "Output"],
Cell[230838, 6723, 908, 22, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[231783, 6750, 3154, 77, 309, "Input"],
Cell[234940, 6829, 2363, 67, 113, "Output"],
Cell[237306, 6898, 1235, 32, 56, "Output"]
}, Open  ]],
Cell[238556, 6933, 156, 3, 37, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[238749, 6941, 170, 2, 54, "Subsection"],
Cell[238922, 6945, 789, 23, 78, "Input"],
Cell[CellGroupData[{
Cell[239736, 6972, 689, 14, 99, "Input"],
Cell[240428, 6988, 288, 8, 56, "Output"],
Cell[240719, 6998, 414, 12, 61, "Output"],
Cell[241136, 7012, 268, 7, 56, "Output"],
Cell[241407, 7021, 389, 11, 61, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[241833, 7037, 614, 21, 36, "Input"],
Cell[242450, 7060, 179, 6, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[242666, 7071, 701, 20, 57, "Input"],
Cell[243370, 7093, 1135, 37, 85, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[244542, 7135, 189, 3, 36, "Input"],
Cell[244734, 7140, 188, 6, 35, "Output"]
}, Open  ]],
Cell[244937, 7149, 930, 25, 57, "Input"],
Cell[CellGroupData[{
Cell[245892, 7178, 1625, 39, 309, "Input"],
Cell[247520, 7219, 7399, 240, 536, "Output"],
Cell[254922, 7461, 844, 26, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[255803, 7492, 502, 17, 36, "Input"],
Cell[256308, 7511, 201, 6, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[256546, 7522, 1638, 38, 246, "Input"],
Cell[258187, 7562, 809, 24, 59, "Output"],
Cell[258999, 7588, 956, 29, 107, "Output"]
}, Open  ]],
Cell[259970, 7620, 233, 4, 61, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[260240, 7629, 168, 2, 43, "Subsection"],
Cell[260411, 7633, 1130, 35, 157, "Code"],
Cell[261544, 7670, 988, 27, 119, "Code"],
Cell[CellGroupData[{
Cell[262557, 7701, 2303, 49, 414, "Input"],
Cell[264863, 7752, 3183, 94, 178, "Output"],
Cell[268049, 7848, 3039, 95, 183, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[271125, 7948, 2158, 60, 246, "Input"],
Cell[273286, 8010, 4924, 115, 195, "Output"],
Cell[278213, 8127, 715, 20, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[278965, 8152, 431, 14, 36, "Input"],
Cell[279399, 8168, 179, 6, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[279615, 8179, 2312, 51, 414, "Input"],
Cell[281930, 8232, 3363, 104, 206, "Output"],
Cell[285296, 8338, 1128, 34, 130, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[286461, 8377, 2159, 60, 246, "Input"],
Cell[288623, 8439, 4821, 113, 195, "Output"],
Cell[293447, 8554, 866, 27, 100, "Output"]
}, Open  ]],
Cell[294328, 8584, 223, 5, 61, "Text"],
Cell[294554, 8591, 2371, 56, 291, "Code"],
Cell[CellGroupData[{
Cell[296950, 8651, 32, 0, 35, "Input"],
Cell[296985, 8653, 449, 15, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[297471, 8673, 569, 13, 78, "Input"],
Cell[298043, 8688, 1834, 61, 88, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[299938, 8756, 123, 1, 80, "Section"],
Cell[300064, 8759, 142, 1, 37, "Text"],
Cell[300209, 8762, 1455, 42, 162, "Input"],
Cell[CellGroupData[{
Cell[301689, 8808, 1104, 30, 162, "Input"],
Cell[302796, 8840, 2900, 80, 125, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[305733, 8925, 786, 21, 99, "Input"],
Cell[306522, 8948, 11866, 369, 761, "Output"]
}, Open  ]],
Cell[318403, 9320, 1147, 28, 183, "Input"],
Cell[CellGroupData[{
Cell[319575, 9352, 165, 2, 54, "Subsection"],
Cell[319743, 9356, 3513, 95, 351, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[323293, 9456, 97, 1, 54, "Subsection"],
Cell[CellGroupData[{
Cell[323415, 9461, 261, 6, 36, "Input"],
Cell[323679, 9469, 120, 2, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[323836, 9476, 1237, 34, 267, "Input"],
Cell[325076, 9512, 230, 6, 39, "Output"],
Cell[325309, 9520, 675, 18, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[326021, 9543, 2706, 68, 477, "Input"],
Cell[328730, 9613, 2856, 89, 269, "Output"],
Cell[331589, 9704, 2823, 77, 122, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[334461, 9787, 96, 1, 54, "Subsection"],
Cell[CellGroupData[{
Cell[334582, 9792, 1687, 44, 309, "Input"],
Cell[336272, 9838, 1151, 35, 62, "Output"],
Cell[337426, 9875, 1451, 36, 39, "Output"]
}, Open  ]],
Cell[338892, 9914, 723, 21, 119, "Code"],
Cell[CellGroupData[{
Cell[339640, 9939, 2573, 64, 414, "Input"],
Cell[342216, 10005, 3634, 111, 260, "Output"],
Cell[345853, 10118, 3931, 97, 131, "Output"]
}, Open  ]],
Cell[349799, 10218, 654, 17, 141, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
